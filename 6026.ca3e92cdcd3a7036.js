"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6026],{6026:(ji,ze,u)=>{u.r(ze),u.d(ze,{DashboardPageModule:()=>Hi});var z=u(3555),we=u(789),f=u(6895),y=u(4006),c=u(9565),k=u(7296),_t=u(4859),ht=u(6709),mt=u(9602),ke=u(9549),e=u(4650),B=u(3238),T=u(1086),q=(u(1737),u(567),u(2868)),S=u(4850),ie=(u(7221),u(537),u(2474),u(529)),Ie=u(1481);let It=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[B.BQ,B.BQ]}),o})();var Qe=u(4144),Tt=u(1572),Me=u(5113);u(6783),u(445),u(1281),u(9521),u(3353),u(2654);let Bt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,B.BQ,B.BQ]}),o})();var Gt=u(9541),Yt=u(5128);let We=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez]}),o})();var _=u(9671),he=u(8929),me=u(13),se=u(5778),ge=u(7545),Ht=u(7625),je=u(7224),O=u(2557),Pe=u(2955),Ke=u(7773),X=u(6873);function Qt(o,s){if(1&o&&(e.TgZ(0,"ion-item",9)(1,"ion-row",10),e._UZ(2,"ion-col"),e.TgZ(3,"ion-col",11),e._uU(4),e.qZA(),e._UZ(5,"ion-col",12),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.hij(" ",null==t.deviceInfo||null==t.deviceInfo.deviceStatus||null==t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel]?null:t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel].gain," % ")}}function Rt(o,s){if(1&o&&(e.TgZ(0,"ion-item",9)(1,"ion-row",10),e._UZ(2,"ion-col"),e.TgZ(3,"ion-col",11),e._uU(4),e.qZA(),e._UZ(5,"ion-col",12),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.hij(" ",((null==t.deviceInfo||null==t.deviceInfo.deviceStatus||null==t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel]?null:t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel].white)/2.55).toFixed(0)," % ")}}function Vt(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-item",1),e.NdJ("touchstart",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!0))})("mousedown",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!0))})("touchend",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!1))})("mouseup",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!1))}),e._UZ(2,"input",2),e.qZA(),e.YNc(3,Qt,6,1,"ion-item",3),e.TgZ(4,"ion-item",4)(5,"ion-range",5),e.NdJ("touchstart",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!0))})("mousedown",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!0))})("touchend",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!1))})("mouseup",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!1))}),e._UZ(6,"ion-icon",6)(7,"ion-icon",7),e.qZA()(),e.YNc(8,Rt,6,1,"ion-item",3),e.TgZ(9,"ion-item",8)(10,"ion-range",5),e.NdJ("touchstart",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!0))})("mousedown",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!0))})("touchend",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.touch(!1))})("mouseup",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.mouse(!1))}),e._UZ(11,"ion-icon",6)(12,"ion-icon",7),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.showCurrent),e.xp6(1),e.Udp("margin-top",t.showCurrent?"-40px":"-20px"),e.xp6(1),e.Q6J("formControl",t.formControlGain),e.xp6(3),e.Q6J("ngIf",t.showCurrent),e.xp6(1),e.Udp("margin-top",t.showCurrent?"-40px":"-20px"),e.xp6(1),e.Q6J("formControl",t.formControlWhite)}}let Wt=(()=>{class o{constructor(t,n,i){this.elementRef=t,this.localService=n,this.deviceService=i,this.showCurrent=!0,this.formControlGain=new y.p4(null,null,this.onLightGainValidatorFn()),this.formControlWhite=new y.p4(null,null,this.onLightWhiteValidatorFn()),this.color=new he.xQ,this.unsubscribe=new he.xQ}ngOnChanges(){if(!this.dragging&&!this.mousedown&&this.deviceInfo?.deviceStatus?.lights){this.formControlGain.setValue(this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel]?.gain,{emitEvent:!1}),this.formControlWhite.setValue(this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel]?.white/2.55,{emitEvent:!1});const t=this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${t.red},${t.green},${t.blue})`)}}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngAfterViewInit(){if($("#colorpicker").wheelColorPicker({htmlOptions:!0}),this.deviceInfo?.deviceStatus?.lights&&this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel]){const t=this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${t.red},${t.green},${t.blue})`)}$("#colorpicker").on("slidermove",()=>{const t=$("#colorpicker").get(0).value.slice(4,-1).split(",");this.color.next({red:+t[0],green:+t[1],blue:+t[2]})}),this.color.pipe((0,me.b)(50),(0,se.x)(),(0,ge.w)(t=>(0,T.of)(this.onLightColor(t))),(0,Ht.R)(this.unsubscribe)).subscribe()}touch(t){this.elementRef.nativeElement.closest("ion-slides")?.lockSwipes(t),this.dragging=t}mouse(t){this.elementRef.nativeElement.closest("ion-slides")?.lockSwipes(t),this.mousedown=t}onLightGainValidatorFn(){return t=>t.valueChanges?t.valueChanges.pipe((0,me.b)(50),(0,se.x)(),(0,ge.w)(n=>(0,T.of)(this.onLightGain(n))),(0,je.P)()):(0,T.of)(null)}onLightWhiteValidatorFn(){return t=>t.valueChanges?t.valueChanges.pipe((0,me.b)(50),(0,se.x)(),(0,ge.w)(n=>(0,T.of)(this.onLightWhite(+(2.55*n).toFixed(0)))),(0,je.P)()):(0,T.of)(null)}onLightWhite(t){var n=this;return(0,_.Z)(function*(){n.deviceInfo?.deviceConStatus===O.L.local&&(yield n.localService.controlLightWhite(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t,n.deviceInfo.ip).toPromise().catch(()=>n.onErrorWhite())),n.deviceInfo?.deviceConStatus===O.L.cloud&&(yield n.deviceService.controlLightWhite(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t).toPromise().catch(()=>n.onErrorWhite()))})()}onLightGain(t){var n=this;return(0,_.Z)(function*(){n.deviceInfo?.deviceConStatus===O.L.local&&(yield n.localService.controlLightGain(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t,n.deviceInfo.ip).toPromise().catch(()=>n.onErrorGain())),n.deviceInfo?.deviceConStatus===O.L.cloud&&(yield n.deviceService.controlLightGain(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t).toPromise().catch(()=>n.onErrorGain()))})()}onLightColor(t){var n=this;return(0,_.Z)(function*(){n.deviceInfo?.deviceConStatus===O.L.local&&(yield n.localService.controlLightColor(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t.red,t.green,t.blue,n.deviceInfo.ip).toPromise().catch(()=>n.onErrorColor())),n.deviceInfo?.deviceConStatus===O.L.cloud&&(yield n.deviceService.controlLightColor(n.deviceInfo.device,n.deviceInfo.deviceStatus,n.deviceInfo.device.channel,t.red,t.green,t.blue).toPromise().catch(()=>n.onErrorColor()))})()}onErrorGain(){this.formControlGain.setValue(this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel]?.gain,{emitEvent:!1})}onErrorWhite(){this.formControlGain.setValue(this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel]?.white,{emitEvent:!1})}onErrorColor(){const t=this.deviceInfo?.deviceStatus?.lights[this.deviceInfo?.device?.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${t.red},${t.green},${t.blue})`)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(Pe.C),e.Y36(Ke.U))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-color-content"]],inputs:{deviceInfo:"deviceInfo",showCurrent:"showCurrent"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"touchstart","mousedown","touchend","mouseup"],["id","colorpicker","type","text","data-wheelcolorpicker","","data-wcp-sliders","hws","data-wcp-layout","block","data-wcp-format","rgb"],["mode","md","lines","none","style","z-index: 1;",4,"ngIf"],["mode","md",2,"margin-top","-40px","margin-bottom","-20px"],["id","range","mode","md","min","0","max","100","step","1","pin","true",3,"formControl","touchstart","mousedown","touchend","mouseup"],["size","small","slot","start","name","sunny","color","medium"],["slot","end","name","sunny","color","medium"],["mode","md",2,"margin-top","-40px","--background","none","margin-bottom","-20px"],["mode","md","lines","none",2,"z-index","1"],[2,"width","100%"],[2,"text-align","center"],[2,"text-align","right"]],template:function(t,n){1&t&&e.YNc(0,Vt,13,8,"ng-container",0),2&t&&e.Q6J("ngIf","light"===(null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.category)&&(null==n.deviceInfo||null==n.deviceInfo.deviceStatus?null:n.deviceInfo.deviceStatus.lights)&&"color"===(null==n.deviceInfo||null==n.deviceInfo.deviceStatus||null==n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel]?null:n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel].mode))},dependencies:[c.wI,c.gu,c.Ie,c.I_,c.Nd,c.QI,y.JJ,y.oH,f.O5,X.e],styles:[".control-light::part(content){width:321px!important;max-width:321px!important}  ion-item>.jQWCP-wWidget.jQWCP-block{width:270px!important;height:195px;border:none;background:none;box-shadow:none;left:50%;transform:translate(-50%);margin:8px}[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;padding-bottom:10px;--background: none}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{padding-bottom:0;--knob-size: 25px;--bar-height: 3px;--knob-handle-size: 45px}ion-item.ios[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-handle-size: 40px;padding-bottom:1px;padding-top:44px}  .jQWCP-wWidget{outline:none!important}ion-col[_ngcontent-%COMP%]{background-color:transparent!important}"],changeDetection:0}),o})();var jt=u(8343),qe=u(775);let Kt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.Pc,We,y.u5,y.UX,f.ez,k.aw,z._t,It,_t.ot,ke.lN,ht.p9,Qe.c,Bt,mt.FA,Tt.Cq,Yt.yI,Me.LD,z._t,we.Cl,Gt.vQ]}),o})();e.B6R(jt.M,[c.W2,Wt],[qe.B,f.Ov]);var Xe=u(2837),qt=u(5548),Xt=u(7321),M=u(65),et=u(7489),fe=u(591),tt=u(1715),nt=u(8003),De=u(5229),ee=u(5547),ve=u(217),Ae=u(1132),Le=u(2699);const en=function(o,s){return{graphSettings:o,loadSettings:s}};function tn(o,s){if(1&o&&(e.TgZ(0,"ion-item",11),e._UZ(1,"app-device",12,13),e.ALo(3,"async"),e.qZA()),2&o){const t=e.MAs(2),n=e.oxw().$implicit,i=e.oxw().ngIf,r=e.oxw();e.xp6(1),e.Q6J("inView","#customizeContainer")("ping",e.lcZ(3,7,t.isInView))("deviceInfo",i)("config",n.config)("dashboardSettings",e.WLB(9,en,r.graphSettings,r.loadSettings))("reorder",!1)("showDetails",!1)}}function nn(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-card",9),e.NdJ("click",function(){const r=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.selectedLayout=r)}),e.YNc(1,tn,4,12,"ion-item",10),e.qZA()}if(2&o){const t=s.$implicit,n=s.index,i=e.oxw(2);e.Udp("display",t.hidden?"none":null),e.ekj("selected",i.selectedLayout===n||0===n&&!i.selectedLayout),e.xp6(1),e.Q6J("ngIf",!t.hidden)}}function on(o,s){if(1&o&&(e.TgZ(0,"ion-list"),e.YNc(1,nn,2,5,"ion-card",8),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.layouts$))}}let rn=(()=>{class o{constructor(t,n){this.deviceInfoService=t,this.modalController=n,this.DEVICE_TYPES=ee.h}ngOnInit(){this.deviceInfo$=this.deviceInfoService.subDeviceInfoChange(this.deviceId).pipe((0,nt.j)((t,n)=>(0,tt.F)(0===n?150:0)),(0,q.b)(console.log)),this.layouts$=this.deviceInfo$.pipe((0,S.U)(t=>t.deviceStatus?((0,De.$U)(t?.device?.category)||(0,De.$U)("default")).map(i=>({config:i,hidden:!(0,De.v)(i,t)})):[]),(0,se.x)(this.compareConfig),(0,me.b)(100))}closeModal(){var t=this;return(0,_.Z)(function*(){yield t.modalController.dismiss()})()}save(){var t=this;return(0,_.Z)(function*(){yield t.modalController.dismiss({selectedLayout:t.selectedLayout})})()}addRow(){var t=this;return(0,_.Z)(function*(){const n=yield t.modalController.create({component:o,cssClass:"dashboardModal",componentProps:{deviceId:t.deviceId}});yield n.present(),yield n.onWillDismiss()})()}compareConfig(t,n){return JSON.stringify(t)===JSON.stringify(n)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ve.H),e.Y36(c.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-customize"]],decls:14,vars:6,consts:[["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["slot","icon-only","name","checkmark-done-sharp"],["id","customizeContainer","scroll-events","",1,"cards"],[4,"ngIf"],["class","card",3,"selected","display","click",4,"ngFor","ngForOf"],[1,"card",3,"click"],["mode","md","lines","none","button","",4,"ngIf"],["mode","md","lines","none","button",""],[3,"inView","ping","deviceInfo","config","dashboardSettings","reorder","showDetails"],["inView","inView"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return n.closeModal()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"ion-buttons",4)(9,"ion-button",1),e.NdJ("click",function(){return n.save()}),e._UZ(10,"ion-icon",5),e.qZA()()()(),e.TgZ(11,"ion-content",6),e.YNc(12,on,3,3,"ion-list",7),e.ALo(13,"async"),e.qZA()),2&t&&(e.xp6(6),e.hij(" ",e.lcZ(7,2,"app.component.customize.header.label")," "),e.xp6(6),e.Q6J("ngIf",e.lcZ(13,4,n.deviceInfo$)))},dependencies:[c.YG,c.Sm,c.PM,c.W2,c.Gu,c.gu,c.Ie,c.q_,c.wd,c.sr,f.sg,f.O5,Ae.v,Le.z,X.e,f.Ov,k.X$],styles:["[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}app-device[_ngcontent-%COMP%]{width:100%;z-index:-1}ion-card.selected[_ngcontent-%COMP%]{box-shadow:0 0 1px 3px var(--ion-color-primary-shade)!important}ion-card[_ngcontent-%COMP%]{transform:translateZ(0)}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}"],changeDetection:0}),o})();var sn=u(9968),an=u(9379),ln=u(9119),cn=u(5355),F=u(1204),be=u(5838),Y=u(7340),ae=u(2085),dn=u(2198),it=u(2986),ot=u(6227),xe=u(7220),Oe=u(2141),V=u(7025);const un=["matSelect"];function pn(o,s){1&o&&e._UZ(0,"ion-progress-bar",21)}function _n(o,s){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.TgZ(2,"div",23),e._uU(3),e.qZA()()),2&o){const t=s.$implicit,n=e.oxw(2);e.Q6J("value",t),e.xp6(1),e.hij(" ","Shelly "+n.deviceTypes[t].friendly_name," "),e.xp6(2),e.hij(" ",n.deviceTypes[t].name," ")}}function hn(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"img",24),e.NdJ("error",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onImageError(!0))}),e.qZA()}if(2&o){const t=e.oxw().ngIf;e.Q6J("src","https://home.shelly.cloud/images/device_images/"+t.selectedDevice+".png",e.LSH)}}function mn(o,s){1&o&&(e.TgZ(0,"h2",25),e._uU(1," No image available "),e.qZA())}function gn(o,s){1&o&&e._UZ(0,"ion-spinner")}function fn(o,s){1&o&&e._UZ(0,"ion-icon",30)}function vn(o,s){1&o&&e._UZ(0,"ion-icon",31)}function bn(o,s){1&o&&e._UZ(0,"ion-icon",32)}function xn(o,s){1&o&&e._UZ(0,"ion-spinner")}function yn(o,s){1&o&&e._UZ(0,"ion-icon",30)}function Cn(o,s){1&o&&e._UZ(0,"ion-icon",31)}function Sn(o,s){1&o&&e._UZ(0,"ion-spinner")}function wn(o,s){1&o&&e._UZ(0,"ion-icon",30)}function kn(o,s){1&o&&e._UZ(0,"ion-icon",31)}function In(o,s){1&o&&e._UZ(0,"ion-spinner")}function Tn(o,s){1&o&&e._UZ(0,"ion-icon",30)}function Mn(o,s){1&o&&e._UZ(0,"ion-icon",31)}function Zn(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.resetState())}),e.TgZ(1,"div")(2,"div"),e._uU(3),e.YNc(4,gn,1,0,"ion-spinner",0),e.YNc(5,fn,1,0,"ion-icon",27),e.YNc(6,vn,1,0,"ion-icon",28),e.YNc(7,bn,1,0,"ion-icon",29),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.YNc(10,xn,1,0,"ion-spinner",0),e.YNc(11,yn,1,0,"ion-icon",27),e.YNc(12,Cn,1,0,"ion-icon",28),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.YNc(15,Sn,1,0,"ion-spinner",0),e.YNc(16,wn,1,0,"ion-icon",27),e.YNc(17,kn,1,0,"ion-icon",28),e.qZA(),e.TgZ(18,"div"),e._uU(19),e.YNc(20,In,1,0,"ion-spinner",0),e.YNc(21,Tn,1,0,"ion-icon",27),e.YNc(22,Mn,1,0,"ion-icon",28),e.qZA()()()}if(2&o){const t=e.oxw().ngIf,n=e.oxw();e.Q6J("@showHide",void 0),e.xp6(3),e.hij(' 1. Verifying "',t.network,'" '),e.xp6(1),e.Q6J("ngIf",void 0===t.state.verifiedNetwork),e.xp6(1),e.Q6J("ngIf",!1===t.state.verifiedNetwork),e.xp6(1),e.Q6J("ngIf",!0===t.state.verifiedNetwork&&!t.state.warningNetwork),e.xp6(1),e.Q6J("ngIf",!0===t.state.verifiedNetwork&&t.state.warningNetwork),e.xp6(1),e.ekj("inactive",!t.state.verifiedNetwork),e.xp6(1),e.hij(' 2. Connecting to "',"Shelly "+n.deviceTypes[t.selectedDevice].friendly_name,'" '),e.xp6(1),e.Q6J("ngIf",t.state.verifiedNetwork&&void 0===t.state.connectedShelly),e.xp6(1),e.Q6J("ngIf",!1===t.state.connectedShelly),e.xp6(1),e.Q6J("ngIf",!0===t.state.connectedShelly),e.xp6(1),e.ekj("inactive",!t.state.connectedShelly),e.xp6(1),e.hij(' 3. Sending information to "',"Shelly "+n.deviceTypes[t.selectedDevice].friendly_name,'" '),e.xp6(1),e.Q6J("ngIf",t.state.connectedShelly&&void 0===t.state.sendShelly),e.xp6(1),e.Q6J("ngIf",!1===t.state.sendShelly),e.xp6(1),e.Q6J("ngIf",!0===t.state.sendShelly),e.xp6(1),e.ekj("inactive",!t.state.sendShelly),e.xp6(1),e.hij(' 4. Connecting to "',t.network,'" '),e.xp6(1),e.Q6J("ngIf",t.state.sendShelly&&void 0===t.state.connectedNetwork),e.xp6(1),e.Q6J("ngIf",!1===t.state.connectedNetwork),e.xp6(1),e.Q6J("ngIf",!0===t.state.connectedNetwork)}}function Pn(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",1)(4,"ion-button",2),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeModal())}),e._UZ(5,"ion-icon",3),e.qZA()(),e.TgZ(6,"ion-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.YNc(9,pn,1,0,"ion-progress-bar",5),e.qZA(),e.TgZ(10,"ion-content",6)(11,"h2"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"mat-form-field",7)(15,"mat-label"),e._uU(16),e.ALo(17,"translate"),e.TgZ(18,"div",8),e._uU(19),e.ALo(20,"translate"),e.qZA()(),e.TgZ(21,"mat-select",9,10),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).ngIf;return e.KtG(a.selectedDevice=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onImageError(!1))}),e.TgZ(23,"mat-select-trigger")(24,"div",11)(25,"div"),e._uU(26),e.qZA(),e.TgZ(27,"div"),e._uU(28),e.qZA()()(),e.YNc(29,_n,4,3,"mat-option",12),e.qZA()(),e.YNc(30,hn,1,1,"img",13),e.YNc(31,mn,2,0,"h2",14),e.TgZ(32,"h2"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"mat-form-field",15)(36,"mat-label"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"input",16),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).ngIf;return e.KtG(a.network=i)}),e.qZA()(),e.TgZ(40,"mat-form-field",17)(41,"mat-label"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",18),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).ngIf;return e.KtG(a.password=i)}),e.qZA()()(),e.TgZ(45,"ion-footer")(46,"ion-toolbar")(47,"ion-button",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addDevice())}),e._uU(48),e.ALo(49,"translate"),e.qZA()()(),e.YNc(50,Zn,23,24,"div",20),e.BQk()}if(2&o){const t=s.ngIf,n=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,22,"app.component.more.add-devices.label")," "),e.xp6(2),e.Q6J("ngIf",t.loading),e.xp6(3),e.Oqu(e.lcZ(13,24,"app.component.add.select-shelly.label")),e.xp6(4),e.hij(" ",e.lcZ(17,26,"app.component.add.select-type.label")," "),e.xp6(3),e.hij(" ",e.lcZ(20,28,"app.component.add.select-ssid.label")," "),e.xp6(2),e.Q6J("ngModel",t.selectedDevice)("disabled",t.loading),e.xp6(5),e.hij(" ","Shelly "+n.deviceTypes[t.selectedDevice].friendly_name," "),e.xp6(2),e.hij(" ",n.deviceTypes[t.selectedDevice].name," "),e.xp6(1),e.Q6J("ngForOf",t.devices),e.xp6(1),e.Q6J("ngIf",!t.imageError),e.xp6(1),e.Q6J("ngIf",t.imageError),e.xp6(2),e.Oqu(e.lcZ(34,30,"app.component.add.network.header.label")),e.xp6(4),e.Oqu(e.lcZ(38,32,"app.component.add.network.label")),e.xp6(2),e.Q6J("ngModel",t.network)("disabled",t.loading),e.xp6(3),e.Oqu(e.lcZ(43,34,"app.component.add.password.label")),e.xp6(2),e.Q6J("ngModel",t.password)("disabled",t.loading),e.xp6(3),e.Q6J("disabled",!t.network||!t.password||t.loading),e.xp6(1),e.hij(" ",e.lcZ(49,36,"app.component.add.confirm.label")," "),e.xp6(2),e.Q6J("ngIf",t.state)}}let Dn=(()=>{class o{constructor(t,n,i,r,a,l){this.notificationsService=t,this.localService=n,this.alertService=i,this.lookupService=r,this.modalController=a,this.deviceInfoService=l,this.state$=new fe.X({devices:[],selectedDevice:"SHSW-1"}),this.slideOpts={initialSlide:0,speed:400},this.deviceTypes=ee.h,this.ignoredDevices=["PLG1NB","SMK1NB","DS1NB","MS1NB","HT1NB","WS1NB","SHSW-1S","SHUNI-1","SHSPOT-1","undefined"]}ngOnInit(){var t=this;return(0,_.Z)(function*(){t.state$.value.devices=Object.keys(ee.h).filter(n=>-1===t.ignoredDevices.indexOf(n)).filter((n,i,r)=>r.findIndex(l=>t.deviceTypes[n].name===t.deviceTypes[l].name)===i).sort(),t.state$.value.network=yield ae.k.getSSID().then(n=>n.ssid).catch(()=>""),t.state$.next(t.state$.value)})()}ngAfterViewInit(){setTimeout(()=>this.matSelect.focus(),550)}ngOnDestroy(){}onImageError(t){this.state$.value.imageError=t,this.state$.next(this.state$.value)}closeModal(){var t=this;return(0,_.Z)(function*(){yield t.modalController.dismiss()})()}resetState(){(Object.keys(this.state$.value.state).some(n=>!1===this.state$.value.state[n])||this.state$.value.state.connectedNetwork)&&(this.state$.value.state=void 0,this.state$.next(this.state$.value))}addDevice(){var t=this;return(0,_.Z)(function*(){t.state$.value.loading=!0,t.state$.value.state={},t.state$.next(t.state$.value);const n=yield ae.k.getSSID().then(r=>r.ssid).catch(()=>null),i=yield ae.k.connect({ssid:t.state$.value.network,password:t.state$.value.password}).then(r=>r.ssid).catch(()=>null);if(t.state$.value.state={warningNetwork:n===t.state$.value.network,verifiedNetwork:!!i},t.state$.next(t.state$.value),t.state$.value.state.verifiedNetwork){t.deviceInfoService.foundOpen=!0;const r=yield ae.k.connectPrefix({ssid:ee.h[t.state$.value.selectedDevice].name+"-"}).then(a=>a.ssid).catch(()=>null);if(t.state$.value.state.connectedShelly=!!r,t.state$.next(t.state$.value),t.state$.value.state.connectedShelly){const a=yield t.deviceInfoService.pingShellyWifi("192.168.33.1").toPromise().catch(()=>null);let l=!1;if(a){const d=yield t.deviceInfoService.subDeviceInfoChange(a).pipe((0,dn.h)(h=>!!h&&h.deviceConStatus!==O.L.offline),(0,it.q)(1),(0,ot.V)(2e4)).toPromise();(yield t.checkLocked(d))&&(l=yield t.deviceInfoService.setWifi(d.device,t.state$.value.network,t.state$.value.password,"192.168.33.1").toPromise().catch(h=>null).then(h=>!!h))}if(t.state$.value.state.sendShelly=l,t.state$.next(t.state$.value),t.state$.value.state.sendShelly){yield(0,F.Vs)(2e3);const d=yield ae.k.connect({ssid:t.state$.value.network,password:t.state$.value.password}).then(p=>p.ssid).catch(()=>null);t.state$.value.state.connectedNetwork=!!d,t.state$.next(t.state$.value)}}}t.state$.value.state.connectedNetwork&&t.notificationsService.presentCustomToast("Successfully send network information to the shelly device. You can now search and add it",6e3),t.deviceInfoService.foundOpen=!1,t.state$.value.loading=!1,t.state$.next(t.state$.value)})()}checkLocked(t){var n=this;return(0,_.Z)(function*(){if(t.deviceConStatus===O.L.locked){const i=yield n.alertService.onClickUnlock(t?.device?.gen);if(i){const r={enabled:!0,unprotected:!1,password:(0,F.r3)(i.password),username:2!==t.device.gen?(0,F.r3)(i.username):"admin"},a=(0,et.cloneDeep)(t.device);a.login=r;const l=yield n.localService.deviceInfo(a,t.ip).toPromise().catch(()=>null);if(l)return a.category=n.deviceInfoService.getCategory(a.type,l.mode),a.template=ee.h[a.type].template||NaN+((l?l.mode:null)||ee.h[a.type].modes[0]),a.name=a.name||l?.name||void 0,n.lookupService.setDevice(a.id,a),yield n.deviceInfoService.checkStatus(a,t.ip,!0).pipe((0,it.q)(1)).toPromise(),!0}return!1}return!0})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(xe.T),e.Y36(Pe.C),e.Y36(Oe.c),e.Y36(V.W),e.Y36(c.IN),e.Y36(ve.H))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-search"]],viewQuery:function(t,n){if(1&t&&e.Gf(un,5),2&t){let i;e.iGM(i=e.CRH())&&(n.matSelect=i.first)}},decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["type","indeterminate",4,"ngIf"],["fullscreen","true","id","searchContainer","scroll-events",""],["appearance","fill",1,"select"],[2,"float","right","padding-right","25px"],[3,"ngModel","disabled","ngModelChange"],["matSelect",""],[1,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"src","error",4,"ngIf"],["style","height: 184px; vertical-align: center; line-height: 160px;",4,"ngIf"],["appearance","fill",1,"network"],["matInput","","type","ssid",3,"ngModel","disabled","ngModelChange"],["appearance","fill",1,"password"],["matInput","","type","password",3,"ngModel","disabled","ngModelChange"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["class","status addingWifiDevice",3,"click",4,"ngIf"],["type","indeterminate"],[3,"value"],[2,"float","right","filter","contrast(0.5)"],[3,"src","error"],[2,"height","184px","vertical-align","center","line-height","160px"],[1,"status","addingWifiDevice",3,"click"],["slot","icon-only","name","close","color","danger",4,"ngIf"],["slot","icon-only","name","checkmark-done-outline","color","success",4,"ngIf"],["slot","icon-only","name","warning-outline","color","warning",4,"ngIf"],["slot","icon-only","name","close","color","danger"],["slot","icon-only","name","checkmark-done-outline","color","success"],["slot","icon-only","name","warning-outline","color","warning"]],template:function(t,n){1&t&&(e.YNc(0,Pn,51,38,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.state$))},dependencies:[c.YG,c.Sm,c.W2,c.fr,c.Gu,c.gu,c.X7,c.PQ,c.wd,c.sr,y.Fj,y.JJ,y.On,f.sg,f.O5,ke.KE,ke.hX,Qe.Nt,Me.gD,Me.$L,B.ey,f.Ov,k.X$],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.select[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:0 50px;margin:0 auto;display:block}.label[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{overflow:hidden;text-overflow:ellipsis}.label[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{filter:contrast(.5)}  body.dark .select .mat-form-field-label{color:#9fa8da}  body:not(.dark) .select .mat-form-field-label{color:#3f51b5}img[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;margin:0 auto;display:block;height:200px}.network[_ngcontent-%COMP%], .password[_ngcontent-%COMP%]{width:100%;max-width:400px;padding-left:50px;padding-right:50px;margin:0 auto;display:block}h2[_ngcontent-%COMP%]{padding-top:20px;text-align:center}.status[_ngcontent-%COMP%]{position:fixed;width:100vw;height:100vh;background-color:#d3d3d33a;z-index:10}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:#000;color:var(--ion-text-color, #000);background:#fff;background:var(--ion-background-color, #fff);border-radius:10px;padding:10px;height:auto;width:-moz-fit-content;width:fit-content;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:7px;display:flex;justify-content:space-between;align-items:center;width:-moz-max-content;width:max-content;min-width:-webkit-fill-available;max-width:calc(100vw - 30px)}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-spinner[_ngcontent-%COMP%]{height:20px;min-width:20px;margin-left:5px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-left:5px;min-width:20px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   div.inactive[_ngcontent-%COMP%]{color:#a9a9a9;margin-right:40px}"],data:{animation:[(0,Y.X$)("showHide",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:"0"}),(0,Y.jt)("300ms ease-in",(0,Y.oB)({opacity:"1"}))]),(0,Y.eR)(":leave",[(0,Y.jt)("300ms ease-out",(0,Y.oB)({opacity:"0"}))])])]},changeDetection:0}),o})();var An=u(8650),rt=(u(4464),u(6053)),Ln=u(943),st=u(3075),Fe=u(7423),Z=u(6953);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var W=(()=>{return(o=W||(W={})).Unimplemented="UNIMPLEMENTED",o.Unavailable="UNAVAILABLE",W;var o})();class Ue extends Error{constructor(s,t){super(s),this.message=s,this.code=t}}const Nn=o=>{var s,t,n,i,r;const a=o.CapacitorCustomPlatform||null,l=o.Capacitor||{},d=l.Plugins=l.Plugins||{},p=o.CapacitorPlatforms,g=(null===(s=p?.currentPlatform)||void 0===s?void 0:s.getPlatform)||(()=>null!==a?a.name:(o=>{var s,t;return o?.androidBridge?"android":null!==(t=null===(s=o?.webkit)||void 0===s?void 0:s.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(o)),w=(null===(t=p?.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==g()),ce=(null===(n=p?.currentPlatform)||void 0===n?void 0:n.isPluginAvailable)||(v=>!(!P.get(v)?.platforms.has(g())&&!E(v))),E=(null===(i=p?.currentPlatform)||void 0===i?void 0:i.getPluginHeader)||(v=>{var b;return null===(b=l.PluginHeaders)||void 0===b?void 0:b.find(te=>te.name===v)}),P=new Map,Qi=(null===(r=p?.currentPlatform)||void 0===r?void 0:r.registerPlugin)||((v,b={})=>{const te=P.get(v);if(te)return console.warn(`Capacitor plugin "${v}" already registered. Cannot register plugins twice.`),te.proxy;const j=g(),ne=E(v);let J;const Ri=function(){var x=(0,_.Z)(function*(){return!J&&j in b?J=J="function"==typeof b[j]?yield b[j]():b[j]:null!==a&&!J&&"web"in b&&(J=J="function"==typeof b.web?yield b.web():b.web),J});return function(){return x.apply(this,arguments)}}(),$e=x=>{let C;const A=(...H)=>{const Q=Ri().then(D=>{const K=((x,C)=>{var A,H;if(!ne){if(x)return null===(H=x[C])||void 0===H?void 0:H.bind(x);throw new Ue(`"${v}" plugin is not implemented on ${j}`,W.Unimplemented)}{const Q=ne?.methods.find(D=>C===D.name);if(Q)return"promise"===Q.rtype?D=>l.nativePromise(v,C.toString(),D):(D,K)=>l.nativeCallback(v,C.toString(),D,K);if(x)return null===(A=x[C])||void 0===A?void 0:A.bind(x)}})(D,x);if(K){const Se=K(...H);return C=Se?.remove,Se}throw new Ue(`"${v}.${x}()" is not implemented on ${j}`,W.Unimplemented)});return"addListener"===x&&(Q.remove=(0,_.Z)(function*(){return C()})),Q};return A.toString=()=>`${x.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:x,writable:!1,configurable:!1}),A},ut=$e("addListener"),pt=$e("removeListener"),Wi=(x,C)=>{const A=ut({eventName:x},C),H=function(){var D=(0,_.Z)(function*(){const K=yield A;pt({eventName:x,callbackId:K},C)});return function(){return D.apply(this,arguments)}}(),Q=new Promise(D=>A.then(()=>D({remove:H})));return Q.remove=(0,_.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield H()}),Q},Je=new Proxy({},{get(x,C){switch(C){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return ne?Wi:ut;case"removeListener":return pt;default:return $e(C)}}});return d[v]=Je,P.set(v,{name:v,proxy:Je,platforms:new Set([...Object.keys(b),...ne?[j]:[]])}),Je});return l.convertFileSrc||(l.convertFileSrc=v=>v),l.getPlatform=g,l.handleError=v=>o.console.error(v),l.isNativePlatform=w,l.isPluginAvailable=ce,l.pluginMethodNoop=(v,b,te)=>Promise.reject(`${te} does not have an implementation of "${b}".`),l.registerPlugin=Qi,l.Exception=Ue,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},$n=(0,(o=>o.Capacitor=Nn(o))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}).registerPlugin)("Filesystem",{electron:()=>window.CapacitorCustomPlatform.plugins.Filesystem});let U=Z.fy,Jn=(()=>{class o{constructor(t,n){this.platform=t,this.domSanitizer=n,this.baseDirectory=Z.tP.Data,this.folder="ShellyHome",this.platform.is("electron")&&(U=$n)}initFolder(t){var n=this;return(0,_.Z)(function*(){return n.platform.is("electron")&&(n.baseDirectory=Z.tP.Documents),n.folder=t,yield U.mkdir({path:n.folder,directory:n.baseDirectory,recursive:!1}).catch(i=>(console.error(i),null)),n.directory=yield U.getUri({path:n.folder,directory:n.baseDirectory}).catch(i=>(console.error(i),null)),n.directory})()}fetchFileNames(t=this.folder){var n=this;return(0,_.Z)(function*(){const i=yield U.readdir({path:t,directory:n.baseDirectory}).catch(a=>(console.error(a),null)),r=i?i.files?.map(a=>a.name):[];return r.length>0?(yield Promise.all(r.map(d=>n.fetchFileNames(t+"/"+d)))).reduce((d,p)=>[...d,...p],[]):[t]})()}writeFile(t,n,i=3/64){var r=this;return(0,_.Z)(function*(){r.platform.is("capacitor")||r.platform.is("electron")?yield r.convertToBase64Chunks(n,i,function(){var a=(0,_.Z)(function*(l,d){d?yield U.writeFile({path:r.folder+"/"+t,directory:r.baseDirectory,data:l,recursive:!0}):yield U.appendFile({path:r.folder+"/"+t,directory:r.baseDirectory,data:l})});return function(l,d){return a.apply(this,arguments)}}()):yield U.writeFile({path:r.folder+"/"+t,directory:r.baseDirectory,data:n,encoding:Z.ez.UTF8,recursive:!0})})()}readFile(t){var n=this;return(0,_.Z)(function*(){if(n.platform.is("capacitor")||n.platform.is("electron")){const i=Fe.dV.convertFileSrc(n.directory.uri+"/"+t);return{success:n.domSanitizer.bypassSecurityTrustResourceUrl(i),revoke:()=>{}}}{const i=yield n.readFileAsBlob(t),r=URL.createObjectURL(i);return{success:n.domSanitizer.bypassSecurityTrustResourceUrl(r),revoke:()=>{URL.revokeObjectURL(r)}}}})()}readFileAsBlob(t){var n=this;return(0,_.Z)(function*(){if(n.platform.is("capacitor")||n.platform.is("electron")){const i=Fe.dV.convertFileSrc(n.directory.uri+"/"+t);return yield fetch(i).then(a=>a.blob())}return(yield U.readFile({path:n.folder+"/"+t,directory:n.baseDirectory})).data})()}deleteFile(t){var n=this;return(0,_.Z)(function*(){yield U.deleteFile({path:n.folder+"/"+t,directory:n.baseDirectory}).catch(i=>(console.error(i),null))})()}start(){var t=this;return(0,_.Z)(function*(){const n=t.directory.uri;return yield st.D.start({path:n,port:8080}).then(i=>"http://"+i.ip+":8080").catch(i=>null)})()}stop(){return(0,_.Z)(function*(){yield st.D.stop().catch(t=>console.log(t))})()}convertToBase64Chunks(t,n,i){var r=this;return(0,_.Z)(function*(){const a=1048576*n;if(a%6)throw{error:"Chunksize must be a multiple of 6!"};{const l=t.size;for(;t.size>a;){const p=yield r.convertToBase64(t.slice(0,a));yield i(l===t.size?p:p.split(",")[1],l===t.size),t=t.slice(a)}const d=yield r.convertToBase64(t.slice(0,t.size));yield i(d.split(",")[1],l===t.size),t=t.slice(t.size)}})()}convertToBase64(t){return new Promise((n,i)=>{let r=new FileReader;const a=r._realReader;a&&(r=a),r.onerror=l=>{console.log(l),i()},r.onload=()=>{n(r.result)},r.readAsDataURL(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(c.t4),e.LFG(Ie.H7))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),lt=(()=>{class o{constructor(t,n,i,r,a,l){this.httpClient=t,this.fileService=n,this.deviceService=i,this.translateService=r,this.loadingController=a,this.notificationsService=l}checkDevices(t,n,i="update",r){let a={};return{deviceInfos:n.filter(d=>{const p=d.deviceInfos[0],h=p.deviceStatus?.update?.old_version;if(p.deviceStatus&&h){let g=!1;const m=p.device.type;return"update"===i?(g=!!t[m]&&t[m].version?.split("/")[0]>h?.split("/")[0],g&&(a[m]={version:t[m].version,url:t[m].url}),g):"beta"===i?(g=!!t[m]&&t[m].beta_ver?.split("/")[0]>h?.split("/")[0],g&&(a[m]={beta_ver:t[m].beta_ver,beta_url:t[m].beta_url}),g):("revert"===i?(g=t[m]&&t[m].version&&(h?.indexOf("-rc")>-1||h?.indexOf("-beta")>-1||h?.indexOf("-dev")>-1||h?.indexOf("master")>-1),g&&(a[m]={version:t[m].version,url:t[m].url})):"select"===i&&r&&(g=r.startsWith(m)&&m+"_"+h?.split("/")[0]!==r?.split(".")[0],g&&(a[m]={version:r,url:r})),g)}return!1}),firmwareList:a}}checkFirmwares(){var t=this;return(0,_.Z)(function*(){yield t.fileService.initFolder("ShellyHome");let n=yield t.deviceService.getFirmwareList();if(!n){n={};const i=yield t.getFirmareEntries();for(const r of i){const a=r.split("/").slice(0,-1).join("/");n[r.split("_")[0]]={url:null,version:a}}}return n})()}startDeviceUpdateServer(){return this.fileService.start()}downloadFiles(t){var n=this;return new Promise(function(){var i=(0,_.Z)(function*(r){if(t){const a=yield n.getFirmareEntries(),l=Object.keys(t).filter(d=>-1===a.indexOf(n.getFilename(d,t[d].version||t[d].beta_ver,t[d].url||t[d].beta_url)));if(console.log(l),l.length>0){const d=yield n.loadingController.create({message:n.translateService.instant("app.component.update.download.label")+" (0/"+l.length+")",showBackdrop:!1});yield d.present();const p={},h={},g=[];for(const m of l){const w=t[m].url||t[m].beta_url,ce=n.getFilename(m,t[m].version||t[m].beta_ver,w);n.httpClient.get(w,{responseType:"blob",reportProgress:!0,observe:"events"}).subscribe(function(){var de=(0,_.Z)(function*(E){if(E.type===ie.dt.DownloadProgress){p[w]=E.total,h[w]=E.loaded;const ye=Object.keys(h).map(P=>h[P]).reduce((P,ue)=>P+ue,0),Ce=Object.keys(p).map(P=>p[P]).reduce((P,ue)=>P+ue,0);d.message=(ye/1e3).toFixed()+" / "+(Ce/1e3).toFixed()+" KB ("+(ye/Ce*100).toFixed()+"%)"}else E.type===ie.dt.Response&&(yield n.fileService.writeFile(ce,E.body),g.push(!0),d.message?.toString().startsWith(n.translateService.instant("app.component.update.download.label"))&&(d.message=n.translateService.instant("app.component.update.download.label")+" ("+g.length+"/"+l.length+")"),g.length===l.length&&(d.dismiss(),r()))});return function(E){return de.apply(this,arguments)}}(),de=>{console.log("downloaderror",de),g.push(!1),g.length===l.length&&(d.dismiss(),r())})}}else n.notificationsService.presentCustomToast("app.component.update.download-done.label"),r()}else r()});return function(r){return i.apply(this,arguments)}}())}getFirmareEntries(){var t=this;return(0,_.Z)(function*(){return(yield t.fileService.fetchFileNames()).map(i=>i.replace("ShellyHome/",""))})()}getFilename(t,n,i){return t+"/"+n+"/"+i.split("/").pop()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(ie.eN),e.LFG(Jn),e.LFG(Ke.U),e.LFG(k.sK),e.LFG(c.HT),e.LFG(xe.T))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function zn(o,s){1&o&&e._UZ(0,"ion-progress-bar",9)}let Bn=(()=>{class o{constructor(t,n){this.deviceUpdateService=t,this.modalController=n,this.state$=new he.xQ}ngOnInit(){var t=this;return(0,_.Z)(function*(){(yield t.deviceUpdateService.getFirmareEntries()).map(r=>({type:r.split("/")[0],firmware:r}))})()}dismiss(){this.modalController.dismiss()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(lt),e.Y36(c.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-update-firmware"]],decls:19,vars:7,consts:[["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["slot","icon-only","name","upload-outline"],["type","indeterminate",4,"ngIf"],["fullscreen","true","scroll-events",""],["expand","block","fill","outline",2,"height","48px","margin","5px"],["type","indeterminate"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return n.dismiss()}),e._UZ(4,"ion-icon",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"ion-buttons",4)(9,"ion-button",3),e._UZ(10,"ion-icon",5),e.qZA()()(),e.YNc(11,zn,1,0,"ion-progress-bar",6),e.qZA(),e.TgZ(12,"ion-content",7),e._UZ(13,"ion-list"),e.qZA(),e.TgZ(14,"ion-footer")(15,"ion-toolbar")(16,"ion-button",8),e._uU(17),e.ALo(18,"translate"),e.qZA()()()),2&t&&(e.xp6(6),e.hij(" ",e.lcZ(7,3,"Select firmware")," "),e.xp6(5),e.Q6J("ngIf",!1),e.xp6(6),e.hij(" ",e.lcZ(18,5,"app.component.update.confirm.label")," "))},dependencies:[c.YG,c.Sm,c.W2,c.fr,c.Gu,c.gu,c.q_,c.X7,c.wd,c.sr,f.O5,k.X$],styles:[".md.update-settings-popover::part(content){margin-top:-42px;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}  .ios.update-settings-popover::part(content){width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),o})(),Gn=(()=>{class o{constructor(t){this.popoverController=t,this.type="update"}confirm(){this.popoverController.dismiss({type:this.type})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(c.Dh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-update-settings"]],decls:13,vars:6,consts:[["mode","md","button","","lines","none",3,"detail","click"],["slot","start",2,"pointer-events","none","margin-left","5px","margin-right","20px",3,"ngModel"],["color","primary",2,"text-align","center","padding-right","25px"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content")(1,"ion-item",0),e.NdJ("click",function(){return n.type="update",n.confirm()}),e._UZ(2,"ion-checkbox",1),e.TgZ(3,"ion-label",2),e._uU(4," Latest "),e.qZA()(),e.TgZ(5,"ion-item",0),e.NdJ("click",function(){return n.type="beta",n.confirm()}),e._UZ(6,"ion-checkbox",1),e.TgZ(7,"ion-label",2),e._uU(8," Beta "),e.qZA()(),e.TgZ(9,"ion-item",0),e.NdJ("click",function(){return n.type="revert",n.confirm()}),e._UZ(10,"ion-checkbox",1),e.TgZ(11,"ion-label",2),e._uU(12," Revert Beta "),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("detail",!1),e.xp6(1),e.Q6J("ngModel","update"===n.type),e.xp6(3),e.Q6J("detail",!1),e.xp6(1),e.Q6J("ngModel","beta"===n.type),e.xp6(3),e.Q6J("detail",!1),e.xp6(1),e.Q6J("ngModel","revert"===n.type))},dependencies:[c.nz,c.W2,c.Ie,c.Q$,c.w,y.JJ,y.On,X.e],styles:[".md.update-settings-popover::part(content){margin-top:-42px;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}  .ios.update-settings-popover::part(content){width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),o})();var Ne=u(7443);let Yn=(()=>{class o{transform(t,n,i){return(t||[]).filter(r=>r[n]===i)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"filter",type:o,pure:!0}),o})();function Hn(o,s){1&o&&e._UZ(0,"ion-progress-bar",17)}function Qn(o,s){if(1&o&&(e.TgZ(0,"ion-row"),e._UZ(1,"app-device",25,26),e.ALo(3,"async"),e.qZA()),2&o){const t=s.$implicit,n=e.MAs(2);e.xp6(1),e.Q6J("inView","#updateContainer")("ping",e.lcZ(3,5,n.isInView))("deviceInfo",t)("showDetails",!1)("reorder",!1)}}function Rn(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-item",18),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.selectDevice(r))}),e.TgZ(2,"ion-grid",19)(3,"ion-list",20),e.YNc(4,Qn,4,7,"ion-row",13),e.qZA()(),e._UZ(5,"ion-checkbox",21,22),e.TgZ(7,"ion-button",23),e.NdJ("click",function(i){const a=e.CHM(t).$implicit,l=e.oxw().ngIf,d=e.oxw(2);return i.stopImmediatePropagation(),e.KtG(d.showInfo(a.deviceInfos[0],l.firmwareList))}),e._UZ(8,"ion-icon",24),e.qZA()(),e.BQk()}if(2&o){const t=s.$implicit,n=e.oxw(2).ngIf,i=e.oxw();e.xp6(1),e.Q6J("disabled",n.searching),e.xp6(3),e.Q6J("ngForOf",t.deviceInfos)("ngForTrackBy",i.identifyInfo),e.xp6(1),e.s9C("color",n.selectedDevices[t.id]&&"local"!==t.deviceInfos[0].deviceConStatus?"danger":null),e.Q6J("mode","initial")("ngModel",n.selectedDevices[t.id]&&"local"===t.deviceInfos[0].deviceConStatus)("indeterminate",n.selectedDevices[t.id]&&"local"!==t.deviceInfos[0].deviceConStatus)}}function Vn(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",1)(4,"ion-button",2),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.closeModal())}),e._UZ(5,"ion-icon",3),e.qZA()(),e.TgZ(6,"ion-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"ion-buttons",5)(10,"ion-button",6),e.NdJ("click",function(){const r=e.CHM(t).ngIf,a=e.oxw(2);return e.KtG(a.downloadFirmwares(r.firmwareList))}),e._UZ(11,"ion-icon",7),e.qZA(),e.TgZ(12,"ion-button",2),e.NdJ("click",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.presentPopover(i))}),e._UZ(13,"ion-icon",8),e.qZA()()(),e.YNc(14,Hn,1,0,"ion-progress-bar",9),e.qZA(),e.TgZ(15,"ion-content",10)(16,"ion-refresher",11),e.NdJ("ionRefresh",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.checkFirmware(i))}),e._UZ(17,"ion-refresher-content"),e.qZA(),e.TgZ(18,"ion-list",12),e.YNc(19,Rn,9,7,"ng-container",13),e.qZA()(),e.TgZ(20,"ion-footer")(21,"ion-toolbar")(22,"div",14),e.NdJ("click",function(){const r=e.CHM(t).ngIf,a=e.oxw(2);return e.KtG(a.selectAllDevices(r.deviceInfos))}),e._UZ(23,"ion-checkbox",15),e.ALo(24,"filter"),e.ALo(25,"keyvalue"),e.ALo(26,"filter"),e.ALo(27,"keyvalue"),e.ALo(28,"filter"),e.ALo(29,"keyvalue"),e.qZA(),e.TgZ(30,"ion-button",16),e.NdJ("click",function(){const r=e.CHM(t).ngIf,a=e.oxw(2);return e.KtG(a.updateDevices(r.deviceInfos,r.firmwareList))}),e._uU(31),e.ALo(32,"translate"),e.qZA()()(),e.BQk()}if(2&o){const t=s.ngIf,n=e.oxw().ngIf,i=e.oxw();e.xp6(7),e.hij(" ",e.lcZ(8,10,"app.component.more.update-devices.label")," "),e.xp6(3),e.Q6J("disabled",!t.firmwareList),e.xp6(4),e.Q6J("ngIf",n.searching),e.xp6(2),e.Q6J("disabled",n.searching),e.xp6(3),e.Q6J("ngForOf",t.deviceInfos)("ngForTrackBy",i.identify),e.xp6(4),e.Q6J("indeterminate",e.Dn7(24,12,e.lcZ(25,16,n.selectedDevices),"value",!0).length<(null==t.deviceInfos?null:t.deviceInfos.length)&&e.Dn7(26,18,e.lcZ(27,22,n.selectedDevices),"value",!0).length>0)("checked",e.Dn7(28,24,e.lcZ(29,28,n.selectedDevices),"value",!0).length===(null==t.deviceInfos?null:t.deviceInfos.length)),e.xp6(7),e.Q6J("disabled",n.searching||!t.firmwareList),e.xp6(1),e.hij(" ",e.lcZ(32,30,"app.component.update.confirm.label")," ")}}const Wn=function(){return{}};function jn(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Vn,33,32,"ng-container",0),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t.updateDevices$)||e.DdM(3,Wn))}}let Kn=(()=>{class o{constructor(t,n,i,r,a,l,d,p,h){this.localService=t,this.lookupService=n,this.modalController=i,this.alertController=r,this.popoverService=a,this.popoverController=l,this.deviceInfoService=d,this.deviceUpdateService=p,this.notificationsService=h,this.state$=new fe.X({selectedDevices:{}}),this.firmwares$=new fe.X({}),this.type="update"}ngOnInit(){var t=this;return(0,_.Z)(function*(){t.devices$=t.lookupService.subDeviceList().pipe((0,nt.j)((n,i)=>(0,tt.F)(0===i?100:0)),(0,S.U)(n=>[...Object.keys(n)]),(0,se.x)(t.compareKeys),(0,ge.w)(n=>t.mapToDeviceInfo(n)),(0,S.U)(n=>t.mapSameDevices(n))),t.checkFirmware(),t.updateDevices$=(0,rt.aj)([t.devices$,t.firmwares$]).pipe((0,S.U)(n=>t.deviceUpdateService.checkDevices(n[1],n[0],t.type,t.selectedFirmware)),(0,q.b)(n=>{for(const i of n.deviceInfos)void 0===t.state$.value.selectedDevices[i.id]&&(t.state$.value.selectedDevices[i.id]=!0);for(const i of Object.keys(t.state$.value.selectedDevices))n.deviceInfos.some(r=>r.id===i)||delete t.state$.value.selectedDevices[i];t.state$.value.selectedDevices={...t.state$.value.selectedDevices},t.state$.next(t.state$.value)}))})()}checkFirmware(t){var n=this;return(0,_.Z)(function*(){n.state$.value.searching=!0,n.state$.next(n.state$.value);const i=yield n.deviceUpdateService.checkFirmwares();n.firmwares$.next(i),t&&t.target.complete(),n.state$.value.searching=!1,n.state$.next(n.state$.value)})()}showInfo(t,n){const i=t.device.type;this.notificationsService.presentCustomToast(t?.deviceStatus?.update?.old_version+"<br/> - <br/>"+(n[i].version||n[i].beta_ver),5e3)}selectDevice(t){this.state$.value.selectedDevices[t.id]=!this.state$.value.selectedDevices[t.id],this.state$.value.selectedDevices={...this.state$.value.selectedDevices},this.state$.next(this.state$.value)}selectAllDevices(t){if(t.length===Object.keys(this.state$.value.selectedDevices).filter(n=>this.state$.value.selectedDevices[n]).length)for(const n of t)this.state$.value.selectedDevices[n.id]=!1;else for(const n of t)this.state$.value.selectedDevices[n.id]=!0;this.state$.value.selectedDevices={...this.state$.value.selectedDevices},this.state$.next(this.state$.value)}downloadFirmwares(t){var n=this;return(0,_.Z)(function*(){yield n.deviceUpdateService.downloadFiles(t)})()}closeModal(){var t=this;return(0,_.Z)(function*(){yield t.modalController.dismiss()})()}identify(t,n){return n.id}identifyInfo(t,n){return n.device?.id}updateDevices(t,n){var i=this;return(0,_.Z)(function*(){const r=t.filter(a=>a.deviceInfos[0]?.deviceConStatus===O.L.local&&i.state$.value.selectedDevices[a.id]);if(r.length>0){"select"!==i.type&&(yield i.downloadFirmwares(n)),i.state$.value.searching=!0,i.state$.next(i.state$.value);const a=yield i.deviceUpdateService.startDeviceUpdateServer(),l=r.map(d=>{const p=d.deviceInfos[0],h=p.device.type;let w;return w="select"===i.type?i.selectedFirmware:i.deviceUpdateService.getFilename(h,n[h].version||n[h].beta_ver,n[h].url||n[h].beta_url),i.localService.ota(p.device,a+"/"+w,p.ip).pipe((0,ot.V)(1e4)).toPromise().catch(ce=>(console.log(ce),null))});yield Promise.all(l),yield(0,T.of)().pipe((0,Ln.g)(5e3)).toPromise(),i.notificationsService.presentCustomToast("app.component.update.done.label",3e3),i.state$.value.searching=!1,i.state$.next(i.state$.value)}else i.notificationsService.presentCustomToast("app.component.update.no-devices.label",3e3)})()}presentPopover(t){var n=this;return(0,_.Z)(function*(){const i=yield n.popoverController.create({component:Gn,event:t,cssClass:"update-settings-popover",translucent:!1,showBackdrop:!0,componentProps:{type:n.type}});yield i.present();const r=yield i.onWillDismiss();n.type=r?.data?.type||n.type,"select"===n.type&&(n.selectedFirmware=(yield n.selectFirmware(n.selectedFirmware))||n.selectedFirmware,n.selectedFirmware||(n.type="update")),n.state$.value.selectedDevices={},n.state$.value.selectedDevices={...n.state$.value.selectedDevices},n.state$.next(n.state$.value),n.firmwares$.next(n.firmwares$.value)})()}selectFirmware(t){var n=this;return(0,_.Z)(function*(){yield n.popoverService.presentModal(Bn,!0,null,null,!0,void 0,document.querySelector("ion-modal"))})()}compareKeys(t,n){return JSON.stringify(t)===JSON.stringify(n)}mapToDeviceInfo(t){const n=t.map(i=>this.deviceInfoService.subDeviceInfoChange(i));return(0,rt.aj)(n)}mapSameDevices(t){const n={};for(const i of t){const r=i?.device?.id?.split("_")[0];n[r]||(n[r]=[]),n[r].push(i)}return Object.keys(n).map(i=>({id:i,deviceInfos:n[i]}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Pe.C),e.Y36(V.W),e.Y36(c.IN),e.Y36(c.Br),e.Y36(Ne.X),e.Y36(c.Dh),e.Y36(ve.H),e.Y36(lt),e.Y36(xe.T))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-update"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["color","primary",3,"disabled","click"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","settings-outline"],["type","indeterminate",4,"ngIf"],["fullscreen","true","scroll-events",""],["slot","fixed",3,"disabled","ionRefresh"],["id","updateContainer"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"left","5px","top","8px","position","absolute","width","42px","height","42px","padding","12px","z-index","2",3,"click"],["slot","start",3,"indeterminate","checked"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["type","indeterminate"],["mode","md","lines","inset","button","",3,"disabled","click"],[2,"z-index","-1"],[2,"padding","0"],["slot","start",2,"margin-left","5px","margin-right","15px","pointer-events","none",3,"mode","color","ngModel","indeterminate"],["checkbox",""],["color","primary","slot","end","shape","round",1,"infoButton",3,"click"],["slot","icon-only","name","information-outline"],[3,"inView","ping","deviceInfo","showDetails","reorder"],["inView","inView"]],template:function(t,n){1&t&&(e.YNc(0,jn,3,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.state$))},dependencies:[c.YG,c.Sm,c.nz,c.W2,c.fr,c.jY,c.Gu,c.gu,c.Ie,c.q_,c.X7,c.nJ,c.Wo,c.Nd,c.wd,c.sr,c.w,y.JJ,y.On,f.sg,f.O5,Ae.v,Le.z,X.e,Yn,f.Ov,f.Nd,k.X$],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.searchText[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%)}.searchText[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding-bottom:10px}ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%}ion-list[_ngcontent-%COMP%] > ion-row[_ngcontent-%COMP%]:not(:last-child)     ion-progress-bar{display:none}ion-list[_ngcontent-%COMP%] > ion-row[_ngcontent-%COMP%]:last-child     ion-progress-bar{bottom:-2px!important}[_nghost-%COMP%]     app-device{width:100%}[_nghost-%COMP%]     app-device>div>div{margin-bottom:-1px}[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}.infoButton[_ngcontent-%COMP%]{height:25px;width:25px;margin-left:5px;margin-right:12px}ion-item[_ngcontent-%COMP%]{--padding-start: 12px;--inner-padding-end: 0px}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:0}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding:0}ion-checkbox[_ngcontent-%COMP%]{pointer-events:none}.card[_ngcontent-%COMP%]{box-shadow:none!important;padding:0;margin:0;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden;border-radius:0!important}"],changeDetection:0}),o})();var qn=u(382);const Xn=(0,Fe.fo)("Share",{web:()=>u.e(7907).then(u.bind(u,7907)).then(o=>new o.ShareWeb)});var ct=u(6448);let ei=(()=>{class o{constructor(t,n,i,r,a){this.authService=t,this.alertService=n,this.lookupService=i,this.translateService=r,this.notificationsService=a}shareBackup(){var t=this;return(0,_.Z)(function*(){const n=yield t.alertService.addPin(!0);if(!n)return;const i=yield be.A.getInfo(),r=yield t.createBackup(),a=yield t.aesGcmEncrypt(JSON.stringify(r),n.pin);"web"===i.platform||"mac"===i.operatingSystem||"windows"===i.operatingSystem?yield t.downloadBackup({pin:"shellyhome"!==n.pin,data:a},"shelly-home-backup.txt"):yield t.saveBackup({pin:"shellyhome"!==n.pin,data:a},"ShellyHome/shelly-home-backup.txt")})()}saveBackup(t,n="ShellyHome/shelly-home-backup.txt"){var i=this;return(0,_.Z)(function*(){if(!t)return void i.notificationsService.presentCustomToast("app.component.more.backup-download-error.label");const r=yield be.A.getInfo();let a=Z.tP.External;("mac"===r.operatingSystem||"windows"===r.operatingSystem)&&(a=Z.tP.Documents);const l={path:n,data:JSON.stringify(t),directory:a,recursive:!0,encoding:Z.ez.UTF8},d=yield Z.fy.writeFile(l).catch(()=>(i.notificationsService.presentCustomToast("app.component.more.backup-download-error.label"),null));d&&(i.notificationsService.presentCustomToast("app.component.more.backup-download-success.label"),yield Xn.share({title:"Shelly Home Backup",text:"Shelly Home Backup",dialogTitle:"Shelly Home Backup",url:d.uri}))})()}createBackup(){return(0,_.Z)(function*(){const t=yield M.u.keys().then(i=>i.keys),n=yield Promise.all(t.map(i=>M.u.get({key:i}).then(r=>({key:i,value:r.value}))));try{return n.reduce((r,a)=>{let l;try{l=JSON.parse(a.value)}catch{l=a.value}return r[a.key]=l,r},{})}catch{return null}})()}exportBackup(){var t=this;return(0,_.Z)(function*(){const n=yield t.createBackup();t.downloadBackup(n,"shelly-home-backup.txt")})()}downloadBackup(t,n){if(!t)return void this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label");const i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))),i.setAttribute("download",n),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}loadBackup(){var t=this;return(0,_.Z)(function*(){const n=window.document.createElement("input");n.type="file",n.accept="txt",n.style.height="0px",n.style.width="0px",n.style.border="0px",n.style.position="fixed",n.style.top="50%",n.style.left="50%",document.body.appendChild(n),n.click(),n.addEventListener("change",()=>{const i=n.files[0];if(i.type.match(/text.*/)){let a=new FileReader;const l=a._realReader;l&&(a=l),a.onload=(0,_.Z)(function*(){try{let d=JSON.parse(a.result);if(!1===d.pin||!0===d.pin){const p=d.pin?yield t.alertService.addPin():{pin:"shellyhome"};if(!p)return;d=yield t.aesGcmDecrypt(d.data,p.pin).then(g=>JSON.parse(g))}if(void 0===d.welcome)yield M.u.set({key:"deviceList",value:JSON.stringify(d.deviceList)}),yield M.u.set({key:"deviceStatusList",value:JSON.stringify(d.deviceStatusList)}),yield M.u.set({key:"roomList",value:JSON.stringify(d.roomList)}),yield M.u.set({key:"groupList",value:JSON.stringify(d.groupList)}),yield t.lookupService.init();else{for(const p in d)"string"==typeof d[p]?yield M.u.set({key:p,value:d[p]}):yield M.u.set({key:p,value:JSON.stringify(d[p])});yield t.lookupService.init(),t.authService.login(),t.lookupService.setDarkMode()}t.notificationsService.presentCustomToast("app.component.more.backup-load-success.label")}catch(d){console.error(d),t.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")}document.body.removeChild(n)}),a.readAsText(i)}else document.body.removeChild(n),t.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")})})()}writeErrorLog(){var t=this;return(0,_.Z)(function*(){const n=localStorage.getItem("errorLog"),i={path:"shelly-home-error-log.txt",data:JSON.stringify(n),directory:Z.tP.Documents,encoding:Z.ez.UTF8},r=yield be.A.getInfo();t.notificationsService.presentCustomToast("app.component.more.report-error-prompt.label"),yield(0,F.Vs)(500);const a=t.translateService.instant("app.component.more.report-error.label"),l=("ios"===r.platform?"iOS":"android"===r.platform?"Android":"Electron")+" Version: "+r.osVersion+"\r\n\r\n"+t.translateService.instant("app.component.more.report-error-body.label")+"\r\n\r\n\r\n\r\n\r\n\r\n";let d="mailto:di.gausma@googlemail.com?subject=";d+=encodeURIComponent(a),d+="&body=",d+=encodeURIComponent(l),console.log(d),window.open(d,"_system"),Z.fy.writeFile(i).then((0,_.Z)(function*(){})).catch(()=>{})})()}aesGcmEncrypt(t,n){return(0,_.Z)(function*(){const i=(new TextEncoder).encode(n),r=yield crypto.subtle.digest("SHA-256",i),a=crypto.getRandomValues(new Uint8Array(12)),l=Array.from(a).map(N=>String.fromCharCode(N)).join(""),d={name:"AES-GCM",iv:a},p=yield crypto.subtle.importKey("raw",r,d,!1,["encrypt"]),h=(new TextEncoder).encode(t),g=yield crypto.subtle.encrypt(d,p,h),w=Array.from(new Uint8Array(g)).map(N=>String.fromCharCode(N)).join("");return btoa(l+w)})()}aesGcmDecrypt(t,n){return(0,_.Z)(function*(){const i=(new TextEncoder).encode(n),r=yield crypto.subtle.digest("SHA-256",i),a=atob(t).slice(0,12),d={name:"AES-GCM",iv:new Uint8Array(Array.from(a).map(m=>m.charCodeAt(0)))},p=yield crypto.subtle.importKey("raw",r,d,!1,["decrypt"]),h=atob(t).slice(12),g=new Uint8Array(Array.from(h).map(m=>m.charCodeAt(0)));try{const m=yield crypto.subtle.decrypt(d,p,g);return(new TextDecoder).decode(m)}catch{throw new Error("Decrypt failed")}})()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(ct.e),e.LFG(Oe.c),e.LFG(V.W),e.LFG(k.sK),e.LFG(xe.T))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function ti(o,s){if(1&o&&(e.TgZ(0,"ion-select-option",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,"app.commons.languages["+t+"].label")," ")}}function ni(o,s){if(1&o&&(e.TgZ(0,"ion-select-option",22),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.s9C("value",t.id),e.xp6(1),e.hij(" ",t.price," ")}}function ii(o,s){if(1&o&&(e.ynx(0),e.YNc(1,ni,2,2,"ion-select-option",23),e.BQk()),2&o){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf",t.price)}}function oi(o,s){if(1&o&&(e.TgZ(0,"ion-badge",24),e._uU(1),e.qZA()),2&o){const t=s.ngIf;e.xp6(1),e.Oqu(t)}}function ri(o,s){1&o&&(e.TgZ(0,"ion-label"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"app.component.more.dark-theme.label")," "))}function si(o,s){1&o&&(e.TgZ(0,"ion-label"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"app.component.more.light-theme.label")," "))}function ai(o,s){1&o&&(e.TgZ(0,"ion-label"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"app.component.more.system-theme.label")," "))}let li=(()=>{class o{constructor(t,n,i,r,a,l,d){this.donateService=t,this.backupService=n,this.lookupService=i,this.popoverService=r,this.translateService=a,this.popoverController=l,this.actionSheetController=d,this.products=[],this.unsubscribe=new he.xQ}ngOnInit(){this.languages=this.translateService.getLangs(),this.products=this.donateService.getProducts(),this.settings=this.lookupService.settings,this.devices$=this.lookupService.subDeviceList().pipe((0,S.U)(t=>Object.keys(t).filter(n=>!t[n].room_id&&!n.includes("_"))?.length))}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}applyZoom(){var t=this;return(0,_.Z)(function*(){yield t.dismiss(),t.lookupService.applyZoomFactor(),t.lookupService.setSettings(t.settings)})()}onClickAddDevices(){this.popoverService.presentModal(Dn,!0,null,null,!0,void 0,document.querySelector("app-dashboard")),this.dismiss()}onClickSearch(){this.popoverService.presentModal(An.g,!0,null,null,!0,void 0,document.querySelector("app-dashboard")),this.dismiss()}onClickUpdateDevices(){this.popoverService.presentModal(Kn,!0,null,null,!0,void 0,document.querySelector("app-dashboard")),this.dismiss()}onClickToggleTheme(){!0===this.settings.darkTheme?this.settings.darkTheme=!1:!1===this.settings.darkTheme?this.settings.darkTheme=void 0:null==this.settings.darkTheme&&(this.settings.darkTheme=!0),this.lookupService.setSettings(this.settings),this.lookupService.setDarkMode()}onLangChange(t){this.translateService.use(t),this.settings.language=t,this.lookupService.setSettings(this.settings)}onClickDonate(t){return(0,_.Z)(function*(){const n=yield be.A.getInfo();"android"===n.platform||"ios"===n.platform?t.open():window.open("https://github.com/digaus/shellyhome-i18n/blob/master/README.md","_system","location=yes")})()}onClickReportError(){var t=this;return(0,_.Z)(function*(){yield t.backupService.writeErrorLog()})()}onDonate(t){var n=this;return(0,_.Z)(function*(){t&&n.donateService.order(t),n.product=null})()}onClickBackup(){var t=this;return(0,_.Z)(function*(){var i;yield(yield t.actionSheetController.create({header:t.translateService.instant("app.component.more.backup.header.label"),buttons:[{text:t.translateService.instant("app.component.more.backup-do.label"),icon:"arrow-redo",handler:(i=(0,_.Z)(function*(){t.backupService.shareBackup()}),function(){return i.apply(this,arguments)})},{text:t.translateService.instant("app.component.more.backup-load.label"),icon:"arrow-undo",handler:function(){var i=(0,_.Z)(function*(){yield t.backupService.loadBackup()});return function(){return i.apply(this,arguments)}}()},{text:t.translateService.instant("app.component.more.cancel.label"),role:"cancel",icon:"close",handler:()=>{console.log("Cancel clicked")}}]})).present()})()}dismiss(){var t=this;return(0,_.Z)(function*(){yield t.popoverController.dismiss()})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(qn.x),e.Y36(ei),e.Y36(V.W),e.Y36(Ne.X),e.Y36(k.sK),e.Y36(c.Dh),e.Y36(c.BX))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-more"]],decls:67,vars:52,consts:[[2,"display","none"],["slot","end",3,"okText","cancelText","ngModel","ngModelChange"],["langSelect",""],[3,"value",4,"ngFor","ngForOf"],["donateSelect",""],[4,"ngFor","ngForOf"],["mode","md","lines","none","button","","detail","false",3,"click"],["color","primary","name","wifi","slot","start"],["color","primary","name","search","slot","start"],["slot","end",4,"ngIf"],["color","primary","name","sync","slot","start"],["color","primary","name","mail","slot","start",2,"height","20px"],["color","primary","name","repeat","slot","start"],["color","primary","name","contrast","slot","start"],[4,"ngIf"],["color","primary","name","heart","slot","start"],["color","primary","name","globe","slot","start"],["mode","md","lines","none","detail","false"],[1,"zoomDiv"],["min","100","max","150",2,"padding","28px 0 0 0",3,"pin","ngModel","ngModelChange","touchend","mouseup"],["color","primary","name","remove-circle-outline","slot","start"],["color","primary","name","add-circle-outline","slot","end"],[3,"value"],[3,"value",4,"ngIf"],["slot","end"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"ion-item",0)(1,"ion-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ion-select",1,2),e.NdJ("ngModelChange",function(a){return n.settings.language=a})("ngModelChange",function(a){return n.onLangChange(a)}),e.ALo(6,"translate"),e.ALo(7,"translate"),e.YNc(8,ti,3,4,"ion-select-option",3),e.qZA()(),e.TgZ(9,"ion-item",0)(10,"ion-label"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-select",1,4),e.NdJ("ngModelChange",function(a){return n.product=a})("ngModelChange",function(a){return n.onDonate(a)}),e.ALo(15,"translate"),e.ALo(16,"translate"),e.YNc(17,ii,2,1,"ng-container",5),e.qZA()(),e.TgZ(18,"ion-list")(19,"ion-item",6),e.NdJ("click",function(){return n.onClickAddDevices()}),e._UZ(20,"ion-icon",7),e.TgZ(21,"ion-label"),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.TgZ(24,"ion-item",6),e.NdJ("click",function(){return n.onClickSearch()}),e._UZ(25,"ion-icon",8),e.TgZ(26,"ion-label"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.YNc(29,oi,2,1,"ion-badge",9),e.ALo(30,"async"),e.qZA(),e.TgZ(31,"ion-item",6),e.NdJ("click",function(){return n.onClickUpdateDevices()}),e._UZ(32,"ion-icon",10),e.TgZ(33,"ion-label"),e._uU(34),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"ion-item",6),e.NdJ("click",function(){return n.onClickReportError()}),e._UZ(37,"ion-icon",11),e.TgZ(38,"ion-label"),e._uU(39),e.ALo(40,"translate"),e.qZA()(),e.TgZ(41,"ion-item",6),e.NdJ("click",function(){return n.onClickBackup()}),e._UZ(42,"ion-icon",12),e.TgZ(43,"ion-label"),e._uU(44),e.ALo(45,"translate"),e.qZA()(),e.TgZ(46,"ion-item",6),e.NdJ("click",function(){return n.onClickToggleTheme()}),e._UZ(47,"ion-icon",13),e.YNc(48,ri,3,3,"ion-label",14),e.YNc(49,si,3,3,"ion-label",14),e.YNc(50,ai,3,3,"ion-label",14),e.qZA(),e.TgZ(51,"ion-item",6),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(14);return e.KtG(n.onClickDonate(a))}),e._UZ(52,"ion-icon",15),e.TgZ(53,"ion-label"),e._uU(54),e.ALo(55,"translate"),e.qZA()(),e.TgZ(56,"ion-item",6),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(5);return e.KtG(a.open())}),e._UZ(57,"ion-icon",16),e.TgZ(58,"ion-label"),e._uU(59),e.ALo(60,"translate"),e.qZA()(),e.TgZ(61,"ion-item",17)(62,"div",18),e._uU(63),e.qZA(),e.TgZ(64,"ion-range",19),e.NdJ("ngModelChange",function(a){return n.settings.zoomFactor=a})("touchend",function(){return n.applyZoom()})("mouseup",function(){return n.applyZoom()}),e._UZ(65,"ion-icon",20)(66,"ion-icon",21),e.qZA()()()}2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,24,"app.component.more.language.label")),e.xp6(2),e.Q6J("okText",e.lcZ(6,26,"app.commons.confirm.label"))("cancelText",e.lcZ(7,28,"app.commons.cancel.label"))("ngModel",n.settings.language),e.xp6(4),e.Q6J("ngForOf",n.languages),e.xp6(3),e.Oqu(e.lcZ(12,30,"app.component.more.donate.label")),e.xp6(2),e.Q6J("okText",e.lcZ(15,32,"app.commons.confirm.label"))("cancelText",e.lcZ(16,34,"app.commons.cancel.label"))("ngModel",n.product),e.xp6(4),e.Q6J("ngForOf",n.products),e.xp6(5),e.hij(" ",e.lcZ(23,36,"app.component.more.add-devices.label")," "),e.xp6(5),e.hij(" ",e.lcZ(28,38,"app.component.more.search-devices.label")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(30,40,n.devices$)),e.xp6(5),e.hij(" ",e.lcZ(35,42,"app.component.more.update-devices.label")," "),e.xp6(5),e.hij(" ",e.lcZ(40,44,"app.component.more.report-error.label")," "),e.xp6(5),e.hij(" ",e.lcZ(45,46,"app.component.more.backup.label")," "),e.xp6(4),e.Q6J("ngIf",!0===(null==n.settings?null:n.settings.darkTheme)),e.xp6(1),e.Q6J("ngIf",!1===(null==n.settings?null:n.settings.darkTheme)),e.xp6(1),e.Q6J("ngIf",null==(null==n.settings?null:n.settings.darkTheme)),e.xp6(4),e.Oqu(e.lcZ(55,48,"app.component.more.donate.label")),e.xp6(5),e.hij("",e.lcZ(60,50,"app.commons.languages["+(null==n.settings?null:n.settings.language)+"].label")," "),e.xp6(4),e.hij("",n.settings.zoomFactor||"100","%"),e.xp6(1),e.Q6J("pin",!0)("ngModel",n.settings.zoomFactor))},dependencies:[c.yp,c.gu,c.Ie,c.Q$,c.q_,c.I_,c.t9,c.n0,c.QI,y.JJ,y.On,f.sg,f.O5,X.e,f.Ov,k.X$],styles:["ion-item[_ngcontent-%COMP%]:not(:last-child){height:38px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.md[_ngcontent-%COMP%]{margin-right:15px;margin-top:2px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.ios[_ngcontent-%COMP%]{margin-right:15px;margin-top:0}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-label.ios[_ngcontent-%COMP%]{margin-top:4px}ion-item[_ngcontent-%COMP%]:not(:last-child) > *[_ngcontent-%COMP%]{margin-top:-2px}ion-item[_ngcontent-%COMP%]:not(:last-child) > ion-badge[_ngcontent-%COMP%]{margin-top:-12px;border-radius:10px;padding-top:4px}ion-list.list-ios[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}  .md.more-popover::part(content){margin-top:-42px;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}  .ios.more-popover::part(content){width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content}  .ios .action-sheet-icon{position:absolute!important;left:10px}.zoomDiv[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(calc(-50% - 10px))}"],changeDetection:0}),o})();var Ee=u(5754),ci=u(6662),di=u(2411);let ui=(()=>{class o{constructor(t){this.lookupService=t}transform(t){return this.lookupService.subRoomList().pipe((0,S.U)(n=>n[t]))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(V.W,16))},o.\u0275pipe=e.Yjl({name:"room",type:o,pure:!0}),o})(),pi=(()=>{class o{constructor(t){this.lookupService=t}transform(t){return this.lookupService.subGroupList().pipe((0,S.U)(n=>n[t]))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(V.W,16))},o.\u0275pipe=e.Yjl({name:"group",type:o,pure:!0}),o})();var _i=u(3001);let hi=(()=>{class o{transform(t,n){return(0,_.Z)(function*(){return yield(0,F.Vs)(n),t})()}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"delay",type:o,pure:!0}),o})();const mi=["slides"];function gi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-fab-button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.removeDashboard())}),e._UZ(1,"ion-icon",25),e.qZA()}}function fi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-fab-button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editDashboard())}),e._UZ(1,"ion-icon",27),e.qZA()}}function vi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-fab-button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.slideLeft())}),e._UZ(1,"ion-icon",30),e.qZA()}}function bi(o,s){if(1&o&&(e.TgZ(0,"ion-fab",14),e.YNc(1,vi,2,0,"ion-fab-button",28),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.reorder)}}function xi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-fab-button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.slideRight())}),e._UZ(1,"ion-icon",31),e.qZA()}}function yi(o,s){if(1&o&&(e.TgZ(0,"ion-fab",16),e.YNc(1,xi,2,0,"ion-fab-button",28),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.reorder)}}function Ci(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-slide",32),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.addDashboard())}),e.TgZ(1,"ion-title",33),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"app.component.dashboard.empty-list.label")," "))}function Si(o,s){1&o&&(e.TgZ(0,"ion-title",33),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"app.component.dashboard.empty.label")," "))}function wi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-fab-button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,r=e.oxw().index,a=e.oxw(2).index,l=e.oxw(2);return e.KtG(l.removeElement(a,r,i))}),e._UZ(1,"ion-icon",44),e.qZA()}}function ki(o,s){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"ion-icon",52)(2,"div"),e.qZA())}function Ii(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",53)(1,"ion-fab-button",54),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3).index,l=e.oxw().index,d=e.oxw(2).index,p=e.oxw(2);return e.KtG(p.customizeElement(d,l,a,r))}),e._UZ(2,"ion-icon",55),e.qZA()()}}const Ti=function(){return["open","graph"]};function Mi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-device",47,48),e.NdJ("dashboardSettingsChange",function(i){const a=e.CHM(t).ngIf,l=e.oxw(2).$implicit;return e.KtG(l.devices[null==a||null==a.device?null:a.device.id]=i)})("dashboardSettingsChange",function(){e.CHM(t);const i=e.oxw(7);return e.KtG(i.saveSettings())}),e.ALo(2,"async"),e.YNc(3,ki,3,0,"div",49),e.YNc(4,Ii,3,0,"ng-template",null,50,e.W1O),e.qZA()}if(2&o){const t=s.ngIf,n=e.MAs(1),i=e.oxw(2).$implicit,r=e.oxw(5);e.Q6J("allow",e.DdM(9,Ti))("ping",e.lcZ(2,7,n.isInView))("deviceInfo",t)("dashboardSettings",i.devices[null==t||null==t.device?null:t.device.id])("showDetails",!1)("reorder",r.reorder),e.xp6(3),e.Q6J("ngIf",r.reorder)}}function Zi(o,s){if(1&o&&(e.TgZ(0,"ion-card",45),e.YNc(1,Mi,6,10,"app-device",46),e.ALo(2,"async"),e.ALo(3,"deviceInfo"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,e.lcZ(3,3,t.key)))}}function Pi(o,s){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"ion-icon",52)(2,"div"),e.qZA())}function Di(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",53)(1,"ion-fab-button",54),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3).index,l=e.oxw().index,d=e.oxw(2).index,p=e.oxw(2);return e.KtG(p.customizeElement(d,l,a,r))}),e._UZ(2,"ion-icon",55),e.qZA()()}}const dt=function(){return[]};function Ai(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-room",58,48),e.NdJ("dashboardSettingsChange",function(i){e.CHM(t);const r=e.oxw(2).$implicit;return e.KtG(r.devices=i)})("dashboardSettingsChange",function(){e.CHM(t);const i=e.oxw(7);return e.KtG(i.saveSettings())})("select",function(){e.CHM(t);const i=e.oxw(2).index,r=e.oxw().index,a=e.oxw(2).index,l=e.oxw(2);return e.KtG(l.collapsedChanged(a,r,i))})("controlButtonsChange",function(){e.CHM(t);const i=e.oxw(2).index,r=e.oxw().index,a=e.oxw(2).index,l=e.oxw(2);return e.KtG(l.controlButtonsChanged(a,r,i))}),e.ALo(2,"async"),e.YNc(3,Pi,3,0,"div",49),e.YNc(4,Di,3,0,"ng-template",null,59,e.W1O),e.qZA()}if(2&o){const t=s.ngIf,n=e.MAs(1),i=e.oxw(2).$implicit,r=e.oxw(5);e.ekj("collapsed",i.collapsed)("not-collapsed",!i.collapsed),e.Q6J("ping",e.lcZ(2,12,n.isInView))("room",t)("allow",e.DdM(14,dt))("reorder",r.reorder)("collapsed",i.collapsed)("dashboardSettings",i.devices)("controlButtons",i.controlButtons),e.xp6(3),e.Q6J("ngIf",r.reorder)}}function Li(o,s){if(1&o&&(e.TgZ(0,"div",56),e.YNc(1,Ai,6,15,"app-room",57),e.ALo(2,"async"),e.ALo(3,"room"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,e.lcZ(3,3,t.key)))}}function Oi(o,s){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"ion-icon",52)(2,"div"),e.qZA())}function Fi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",53)(1,"ion-fab-button",54),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3).index,l=e.oxw().index,d=e.oxw(2).index,p=e.oxw(2);return e.KtG(p.customizeElement(d,l,a,r))}),e._UZ(2,"ion-icon",55),e.qZA()()}}function Ui(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-group",61,48),e.NdJ("dashboardSettingsChange",function(i){e.CHM(t);const r=e.oxw(2).$implicit;return e.KtG(r.devices=i)})("dashboardSettingsChange",function(){e.CHM(t);const i=e.oxw(7);return e.KtG(i.saveSettings())})("select",function(){e.CHM(t);const i=e.oxw(2).index,r=e.oxw().index,a=e.oxw(2).index,l=e.oxw(2);return e.KtG(l.collapsedChanged(a,r,i))})("controlButtonsChange",function(){e.CHM(t);const i=e.oxw(2).index,r=e.oxw().index,a=e.oxw(2).index,l=e.oxw(2);return e.KtG(l.controlButtonsChanged(a,r,i))}),e.ALo(2,"async"),e.ALo(3,"delay"),e.ALo(4,"async"),e.YNc(5,Oi,3,0,"div",49),e.YNc(6,Fi,3,0,"ng-template",null,62,e.W1O),e.qZA()}if(2&o){const t=s.ngIf,n=e.MAs(1),i=e.oxw(2).$implicit,r=e.oxw(5);e.ekj("collapsedDisplay",e.lcZ(2,14,e.xi3(3,16,i.collapsed,i.collapsed?200:20)))("collapsed",i.collapsed)("not-collapsed",!i.collapsed),e.Q6J("ping",e.lcZ(4,19,n.isInView))("group",t)("allow",e.DdM(21,dt))("reorder",r.reorder)("collapsed",i.collapsed)("dashboardSettings",i.devices)("controlButtons",i.controlButtons),e.xp6(5),e.Q6J("ngIf",r.reorder)}}function Ni(o,s){if(1&o&&(e.TgZ(0,"div",56),e.YNc(1,Ui,8,22,"app-group",60),e.ALo(2,"async"),e.ALo(3,"group"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,e.lcZ(3,3,t.key)))}}function Ei(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",39),e.NdJ("cdkDragStarted",function(){e.CHM(t);const i=e.oxw(5);return e.KtG(i.onDragStart())}),e.YNc(1,wi,2,0,"ion-fab-button",40),e.YNc(2,Zi,4,5,"ion-card",41),e.YNc(3,Li,4,5,"div",42),e.YNc(4,Ni,4,5,"div",42),e.qZA()}if(2&o){const t=s.$implicit,n=e.oxw(5);e.Q6J("cdkDragData",t)("cdkDragDisabled",!n.reorder),e.xp6(1),e.Q6J("ngIf",n.reorder),e.xp6(1),e.Q6J("ngIf","device"===t.type),e.xp6(1),e.Q6J("ngIf","room"===t.type),e.xp6(1),e.Q6J("ngIf","group"===t.type)}}function $i(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-col",36),e.NdJ("cdkDropListDropped",function(i){e.CHM(t);const r=e.oxw(4);return e.KtG(r.drop(i))})("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(4);return e.KtG(null!=r&&r.length?null:a.onClickAdd())}),e.ALo(1,"dropListConnected"),e.ALo(2,"async"),e.ALo(3,"async"),e.YNc(4,Si,3,3,"ion-title",37),e.YNc(5,Ei,5,6,"div",38),e.qZA()}if(2&o){const t=s.$implicit,n=s.index,i=e.oxw(2).$implicit,r=e.oxw(2);e.Udp("width",100/i.cols.length+"%"),e.Q6J("cdkDropListData",t)("cdkDropListConnectedTo",e.xi3(1,8,i.cols,e.lcZ(2,11,r.currentSlide$)))("id","dashboard"+e.lcZ(3,13,r.currentSlide$)+"Col"+n),e.xp6(4),e.Q6J("ngIf",!(null!=t&&t.length)),e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",r.identify)}}function Ji(o,s){if(1&o&&(e.TgZ(0,"ion-row"),e.YNc(1,$i,6,15,"ion-col",35),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.cols)("ngForTrackBy",n.identifyIndex)}}function zi(o,s){if(1&o&&(e.TgZ(0,"ion-slide")(1,"ion-grid",34)(2,"ion-list"),e.YNc(3,Ji,2,2,"ion-row",0),e.ALo(4,"async"),e.qZA()()()),2&o){const t=s.index,n=e.oxw(2);e.xp6(3),e.Q6J("ngIf",e.lcZ(4,1,n.currentSlide$)===t)}}function Bi(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-menu-button",3),e._UZ(5,"ion-icon",4),e.qZA(),e.TgZ(6,"ion-button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.selectUser())}),e.ALo(7,"async"),e._UZ(8,"ion-icon",6),e.qZA()(),e.TgZ(9,"ion-title",7),e._uU(10,"Dashboard"),e.qZA(),e.TgZ(11,"ion-buttons",8)(12,"ion-button",9),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(28),r=e.oxw();return r.reorder=!r.reorder,e.KtG(null==i?null:i.lockSwipes(r.reorder))}),e._UZ(13,"ion-icon",10),e.qZA(),e.TgZ(14,"ion-button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickAdd())}),e._UZ(15,"ion-icon",11),e.qZA(),e.TgZ(16,"ion-button",5),e.NdJ("click",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.presentPopover(i))}),e._UZ(17,"ion-icon",12),e.qZA()()()(),e.TgZ(18,"ion-content",13)(19,"ion-fab",14),e.YNc(20,gi,2,0,"ion-fab-button",15),e.qZA(),e.TgZ(21,"ion-fab",16),e.YNc(22,fi,2,0,"ion-fab-button",17),e.qZA(),e.YNc(23,bi,2,1,"ion-fab",18),e.ALo(24,"async"),e.YNc(25,yi,2,1,"ion-fab",19),e.ALo(26,"async"),e.TgZ(27,"ion-slides",20,21),e.NdJ("ionSlideDidChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.slidesDidChange())}),e.YNc(29,Ci,4,3,"ion-slide",22),e.YNc(30,zi,5,3,"ion-slide",23),e.qZA()(),e.BQk()}if(2&o){const t=s.ngIf,n=e.oxw();e.xp6(4),e.Q6J("menu","first"),e.xp6(2),e.Q6J("disabled",n.reorder||"connecting"===e.lcZ(7,13,n.cloudStatus$)),e.xp6(7),e.Q6J("name",n.reorder?"checkmark-done-sharp":"create-outline"),e.xp6(1),e.Q6J("disabled",n.reorder),e.xp6(2),e.Q6J("disabled",n.reorder),e.xp6(2),e.Q6J("fullscreen",!0),e.xp6(2),e.Q6J("ngIf",n.reorder),e.xp6(2),e.Q6J("ngIf",n.reorder),e.xp6(1),e.Q6J("ngIf",e.lcZ(24,15,n.currentSlide$)>0),e.xp6(2),e.Q6J("ngIf",(null==t?null:t.length)-1>e.lcZ(26,17,n.currentSlide$)),e.xp6(2),e.Q6J("options",n.slideConfig),e.xp6(2),e.Q6J("ngIf",!(null!=t&&t.length)),e.xp6(1),e.Q6J("ngForOf",t)}}const Gi=[{path:"",component:(()=>{class o{constructor(t,n,i,r,a,l,d,p,h,g){this.renderer2=t,this.authService=n,this.alertService=i,this.lookupService=r,this.modalController=a,this.popoverService=l,this.translateService=d,this.deviceInfoService=p,this.popoverController=h,this.actionSheetController=g,this.slideConfig={slidesPerView:1,centeredSlides:!0},this.currentSlide$=new fe.X(0)}ngOnInit(){qt.g.addListener("appStateChange",t=>{t.isActive&&this.slides.update()}),Xt.c.hide(),M.u.set({key:Ee.Q.welcome,value:"done"}),this.deviceInfoService.init(),this.dashboardList$=this.lookupService.subDashboardList().pipe((0,S.U)(t=>(t.forEach(n=>n.cols.forEach(i=>i.forEach(r=>{r.devices=r.devices||{},r.collapsed=r.collapsed||!1,r.controlButtons=r.controlButtons||!1}))),t)),(0,q.b)(t=>{t[this.currentSlide$.value]||this.slides?.slideTo(0)})),this.cloudStatus$=this.authService.cloudStatus.asObservable()}selectUser(){var t=this;return(0,_.Z)(function*(){if(t.lookupService.userList?.users?.length>0){const n=yield t.alertService.selectUser(t.lookupService.userList);if(n){t.lookupService.selectUser(n);const i=[M.u.set({key:Ee.Q.email,value:n.email}),M.u.set({key:Ee.Q.password,value:n.password})];yield Promise.all(i),yield t.authService.login(null,null)}}else yield(yield t.modalController.create({component:cn.b,backdropDismiss:!0,canDismiss:!0,presentingElement:document.querySelector("app-dashboard")})).present()})()}removeElement(t,n,i){this.lookupService.dashboardList[t].cols[n].splice(i,1),this.lookupService.setDashboardList(this.lookupService.dashboardList)}customizeElement(t,n,i,r){var a=this;return(0,_.Z)(function*(){const l=yield a.modalController.create({component:rn,cssClass:"dashboardModal",backdropDismiss:!0,canDismiss:!0,presentingElement:document.querySelector("app-dashboard"),componentProps:{deviceId:r,selectedLayout:a.lookupService.dashboardList[t].cols[n][i]?.devices?.[r]?.layout,graphSettings:a.lookupService.dashboardList[t].cols[n][i]?.devices?.[r]?.graphSettings,loadSettings:a.lookupService.dashboardList[t].cols[n][i]?.devices?.[r]?.loadSettings}});yield l.present();const d=yield l.onWillDismiss();d.data&&(a.lookupService.dashboardList[t].cols[n][i].devices[r]={...a.lookupService.dashboardList[t].cols[n][i].devices[r],layout:d.data?.selectedLayout},a.lookupService.dashboardList[t].cols[n][i]=(0,et.cloneDeep)(a.lookupService.dashboardList[t].cols[n][i]),a.lookupService.setDashboardList(a.lookupService.dashboardList))})()}collapsedChanged(t,n,i){this.lookupService.dashboardList[t].cols[n][i].collapsed=!this.lookupService.dashboardList[t].cols[n][i].collapsed,this.lookupService.setDashboardList(this.lookupService.dashboardList)}controlButtonsChanged(t,n,i){var r=this;return(0,_.Z)(function*(){yield(0,F.Vs)(10),r.lookupService.dashboardList[t].cols[n][i].controlButtons=!r.lookupService.dashboardList[t].cols[n][i].controlButtons,r.lookupService.setDashboardList(r.lookupService.dashboardList)})()}saveSettings(){this.lookupService.setDashboardList(this.lookupService.dashboardList),this.lookupService.setSettings(this.lookupService.settings)}presentPopover(t){var n=this;return(0,_.Z)(function*(){const i=yield n.popoverController.create({component:li,event:t,cssClass:"more-popover",translucent:!1,showBackdrop:!0});yield i.present(),yield i.onDidDismiss(),yield(0,F.Vs)(200),n.slides?.update()})()}slideLeft(){this.slides.slidePrev()}slideRight(){this.slides.slideNext()}addDashboard(){var t=this;return(0,_.Z)(function*(){const n=yield t.alertService.addDashboard();if(n.cols){const i=Array.from({length:n.cols}).map(()=>[]);t.lookupService.dashboardList.push({cols:i}),t.lookupService.setDashboardList(t.lookupService.dashboardList),yield(0,F.Vs)(200),t.slides.slideTo(t.lookupService.dashboardList.length+1)}})()}editDashboard(){var t=this;return(0,_.Z)(function*(){const n=yield t.alertService.addDashboard(t.lookupService.dashboardList[t.currentSlide$.value].cols?.length);if(n.cols){const i=Array.from({length:n.cols}).map((r,a)=>t.lookupService.dashboardList[t.currentSlide$.value].cols[a]||[]);t.lookupService.dashboardList[t.currentSlide$.value].cols=i,t.lookupService.setDashboardList(t.lookupService.dashboardList)}})()}drop(t){t.previousContainer===t.container?(0,z.bA)(t.container.data,t.previousIndex,t.currentIndex):(0,z.EA)(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex),this.lookupService.setDashboardList(this.lookupService.dashboardList)}identifyIndex(t,n){return t}identify(t,n){const i=Object.keys(n.devices).map(r=>n.devices[r].layout).join(",");return n.key+n.type+i}onDragStart(){this.renderer2.setStyle(document.getElementsByClassName("cdk-drag-placeholder")[0],"height",document.getElementsByClassName("cdk-drag-preview")[0].clientHeight+"px")}slidesDidChange(){var t=this;return(0,_.Z)(function*(){const n=yield t.slides.getActiveIndex();yield(0,F.Vs)(100),t.currentSlide$.next(n)})()}removeDashboard(){var t=this;return(0,_.Z)(function*(){t.reorder=!1,yield t.slides.lockSwipes(!1),t.lookupService.dashboardList.splice(t.currentSlide$.value,1),t.lookupService.dashboardList=[...t.lookupService.dashboardList],t.lookupService.setDashboardList(t.lookupService.dashboardList),t.currentSlide$.value>=1?yield t.slides.slideTo(t.currentSlide$.value-1):t.lookupService.dashboardList.length>1&&(yield t.slides.slideTo(0))})()}onClickAdd(){var t=this;return(0,_.Z)(function*(){var i;yield(yield t.actionSheetController.create({mode:"ios",header:t.translateService.instant("app.component.dashboard.edit.header.label"),buttons:[{cssClass:t.lookupService?.dashboardList?.length?"":"disabledAction",text:t.translateService.instant("app.component.dashboard.add-device.header.label"),icon:"cog-outline",handler:(i=(0,_.Z)(function*(){t.openDevices()}),function(){return i.apply(this,arguments)})},{cssClass:t.lookupService?.dashboardList?.length?"":"disabledAction",text:t.translateService.instant("app.component.dashboard.add-room.header.label"),icon:"home-outline",handler:function(){var i=(0,_.Z)(function*(){t.openRooms()});return function(){return i.apply(this,arguments)}}()},{cssClass:t.lookupService?.dashboardList?.length?"":"disabledAction",text:t.translateService.instant("app.component.dashboard.add-group.header.label"),icon:"copy-outline",handler:function(){var i=(0,_.Z)(function*(){t.openGroups()});return function(){return i.apply(this,arguments)}}()},{text:t.translateService.instant("app.component.dashboard.add-dashboard.header.label"),icon:"duplicate-outline",handler:function(){var i=(0,_.Z)(function*(){t.addDashboard()});return function(){return i.apply(this,arguments)}}()},{text:t.translateService.instant("app.component.dashboard.cancel.header.label"),role:"cancel",icon:"close",handler:()=>{}}]})).present()})()}openRooms(){var t=this;return(0,_.Z)(function*(){t.popoverService.presentModal(ln.g,!0,{dashboard:t.lookupService.dashboardList[t.currentSlide$.value],currentSlide:t.currentSlide$.value},"dashboardModal",!0,void 0,document.querySelector("app-dashboard"))})()}openGroups(){var t=this;return(0,_.Z)(function*(){t.popoverService.presentModal(an.B,!0,{dashboard:t.lookupService.dashboardList[t.currentSlide$.value],currentSlide:t.currentSlide$.value},"dashboardModal",!0,void 0,document.querySelector("app-dashboard"))})()}openDevices(){var t=this;return(0,_.Z)(function*(){t.popoverService.presentModal(sn.Z,!0,{dashboard:t.lookupService.dashboardList[t.currentSlide$.value],currentSlide:t.currentSlide$.value},"dashboardModal",!0,void 0,document.querySelector("app-dashboard"))})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.Qsj),e.Y36(ct.e),e.Y36(Oe.c),e.Y36(V.W),e.Y36(c.IN),e.Y36(Ne.X),e.Y36(k.sK),e.Y36(ve.H),e.Y36(c.Dh),e.Y36(c.BX))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dashboard"]],viewQuery:function(t,n){if(1&t&&(e.Gf(mi,5),e.Gf(c.W2,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.slides=i.first),e.iGM(i=e.CRH())&&(n.ionContents=i)}},decls:2,vars:3,consts:[[4,"ngIf"],["translucent","true",1,"ion-no-border"],["slot","start"],["color","primary",3,"menu"],["slot","icon-only","name","menu-outline"],["color","primary",3,"disabled","click"],["slot","icon-only","name","people-outline",2,"transform","scaleX(-1)"],["color","primary"],["slot","end"],["color","primary",3,"click"],["slot","icon-only",3,"name"],["slot","icon-only","name","add"],["slot","icon-only","md","ellipsis-vertical-outline","ios","ellipsis-horizontal-outline"],[2,"--overflow","hidden",3,"fullscreen"],["mode","md","vertical","bottom","horizontal","start","slot","fixed"],["size","small","color","danger",3,"click",4,"ngIf"],["mode","md","vertical","bottom","horizontal","end","slot","fixed"],["size","small","color","success",3,"click",4,"ngIf"],["mode","md","vertical","bottom","horizontal","start","slot","fixed",4,"ngIf"],["mode","md","vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["pager","true",3,"options","ionSlideDidChange"],["slides",""],["style","height: calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top));",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["size","small","color","danger",3,"click"],["name","trash-outline"],["size","small","color","success",3,"click"],["name","create-outline"],["class","slideFab","size","small","color","transparent",3,"click",4,"ngIf"],["size","small","color","transparent",1,"slideFab",3,"click"],["name","chevron-back-outline"],["name","chevron-forward-outline"],[2,"height","calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top))",3,"click"],["mode","ios",1,"empty"],["cdkScrollable","","scroll-events","",1,"scrollContent"],["class","dashboardCol","cdkDropList","",3,"width","cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDropList","",1,"dashboardCol",3,"cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click"],["mode","ios","class","empty",4,"ngIf"],["class","dragElement","cdkDrag","",3,"cdkDragData","cdkDragDisabled","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dragElement",3,"cdkDragData","cdkDragDisabled","cdkDragStarted"],["class","remove","color","danger",3,"click",4,"ngIf"],["class","card",4,"ngIf"],["class","wrapper",4,"ngIf"],["color","danger",1,"remove",3,"click"],["name","close",1,"remove-icon"],[1,"card"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange",4,"ngIf"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange"],["inView","inView"],["cdkDragHandle","",4,"ngIf"],["customize",""],["cdkDragHandle",""],["name","move-outline"],[1,"controlButton"],["color","success","fill","clear","size","small",1,"smallFab",3,"click"],["name","settings-outline"],[1,"wrapper"],["inView","",3,"ping","room","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","room","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeRoom",""],["inView","",3,"ping","group","allow","reorder","collapsed","collapsedDisplay","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","group","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeGroup",""]],template:function(t,n){1&t&&(e.YNc(0,Bi,31,19,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.dashboardList$))},dependencies:[f.sg,f.O5,c.YG,c.Sm,c.PM,c.wI,c.W2,c.IJ,c.W4,c.jY,c.Gu,c.gu,c.q_,c.fG,c.Nd,c.A$,c.Hr,c.wd,c.sr,ci.m,di.Y,Ae.v,Le.z,X.e,we.PQ,z.Wj,z.Zt,z.Bh,f.Ov,ui,pi,qe.B,_i.j,hi,k.X$],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-background-color)}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center}ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{background:var(--ion-background-color)}[_nghost-%COMP%]{background:#fff;background:var(--ion-background-color, #fff)}[_nghost-%COMP%]     app-device   .reorderLabel   p{padding-right:40px}  .header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.add[_ngcontent-%COMP%]{height:3px;width:calc(50% - 75px);top:50%;position:absolute;max-width:200px}.add.right[_ngcontent-%COMP%]{left:calc(50% + 50px);background:linear-gradient(to left,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.add.left[_ngcontent-%COMP%]{right:calc(50% + 50px);background:linear-gradient(to right,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.addText[_ngcontent-%COMP%]{width:100%;color:var(--ion-color-primary);top:calc(50% - 75px);position:absolute;left:0;text-align:center}  .swiper-pagination{position:fixed!important;pointer-events:none}.scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 57px - var(--ion-safe-area-bottom));overflow-y:auto;width:100%}.ios[_ngcontent-%COMP%]   .scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 44px - var(--ion-safe-area-bottom))}.card[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item{border-radius:4px}.card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item::part(native){box-shadow:#0003 0 3px 1px -2px,#00000024 0 2px 2px,#0000001f 0 1px 5px;-webkit-font-smoothing:antialiased;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragElement[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{font-size:31px;position:absolute;right:11px;top:11px;z-index:1;background:var(--ion-color-base)}.cdk-drag-handle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;top:0;left:0}.dragElement[_ngcontent-%COMP%]{position:relative;margin:15px 5px}.dragElement[_ngcontent-%COMP%]:last-child{margin-bottom:calc(50px + var(--ion-safe-area-bottom))}.slideFab[_ngcontent-%COMP%]{--box-shadow: none;--ion-color-base: none !important;--ion-color-contrast: var(--ion-color-primary) !important}  .ios .action-sheet-icon{position:absolute!important;left:10px}ion-fab-button.remove[_ngcontent-%COMP%]{position:absolute;transform:scale(.6) translateZ(0);z-index:2;opacity:.8;bottom:-16px;left:calc(50% - 16px);width:35px;height:35px}  .disabledAction{pointer-events:none;opacity:.5}.ios[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 64px - var(--ion-safe-area-bottom))}.md[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 70px - var(--ion-safe-area-bottom))}ion-slide[_ngcontent-%COMP%], ion-grid[_ngcontent-%COMP%], ion-list[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%]{padding-top:0}.controlButton[_ngcontent-%COMP%]{margin-right:-5px;width:45px;display:block;height:40px;padding-top:.1px;position:absolute;right:46px;top:5px;z-index:10}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]::part(native){background:transparent;box-shadow:none}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]{margin:3px 3px 3px 5.5px;margin-right:0!important;height:34px;width:34px;opacity:.7;--ion-color-contrast: var(--ion-color-base) !important}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{transform:scale(.8)}  .resetTransform{transform:none!important;transform:initial!important;border-radius:0!important}"],changeDetection:0}),o})()}];let Yi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[Xe.Bz.forChild(Gi),Xe.Bz]}),o})(),Hi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,y.u5,c.Pc,We,Kt,z._t,we.Cl,k.aw,Yi]}),o})()}}]);