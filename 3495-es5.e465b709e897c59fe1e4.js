!function(){"use strict";function e(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==i.return||i.return()}finally{if(s)throw a}}}}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function r(e){var t="function"==typeof Map?new Map:void 0;return(r=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return a(e,arguments,l(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),s(i,e)})(e)}function a(e,t,n){return(a=c()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&s(o,n.prototype),o}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkShellyHome=self.webpackChunkShellyHome||[]).push([[3495],{83495:function(n,i,a){a.r(i),a.d(i,{DashboardPageModule:function(){return bn}});var u,v=a(77310),f=a(1275),h=a(38583),g=a(3679),m=a(92859),x=a(29790),b=a(51095),k=a(7539),w=a(43220),y=a(98295),Z=a(37716),C=a(72458),S=(a(39490),a(25917)),I=(a(40205),a(35758),a(75319),a(93342)),A=a(88002),_=(a(5304),a(68939),a(18819),a(15257)),M=a(91841),T=a(39075),O=((u=function e(){p(this,e)}).\u0275fac=function(e){return new(e||u)},u.\u0275mod=Z.oAB({type:u}),u.\u0275inj=Z.cJS({imports:[[C.BQ],C.BQ]}),u),P=a(49983),L=a(4885),D=a(67441);a(36461),a(46237),a(80521),a(4765),a(70946);var R=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[h.ez,C.BQ],C.BQ]}),e}(),J=a(75721),N=a(69129),q=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[h.ez]]}),e}(),U=a(64762),F=a(79765),Q=a(54395),G=a(87519),Y=a(43190),B=a(46782),E=a(28049),j=a(22557),H=a(59353),z=a(27773),V=a(16873);function W(e,t){if(1&e&&(Z.TgZ(0,"ion-item",9),Z.TgZ(1,"ion-row",10),Z._UZ(2,"ion-col"),Z.TgZ(3,"ion-col",11),Z._uU(4),Z.qZA(),Z._UZ(5,"ion-col",12),Z.qZA(),Z.qZA()),2&e){var n=Z.oxw(2);Z.xp6(4),Z.hij(" ",null==n.deviceInfo||null==n.deviceInfo.deviceStatus||null==n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel]?null:n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel].gain," % ")}}function X(e,t){if(1&e&&(Z.TgZ(0,"ion-item",9),Z.TgZ(1,"ion-row",10),Z._UZ(2,"ion-col"),Z.TgZ(3,"ion-col",11),Z._uU(4),Z.qZA(),Z._UZ(5,"ion-col",12),Z.qZA(),Z.qZA()),2&e){var n=Z.oxw(2);Z.xp6(4),Z.hij(" ",((null==n.deviceInfo||null==n.deviceInfo.deviceStatus||null==n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel]?null:n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel].white)/2.55).toFixed(0)," % ")}}function K(e,t){if(1&e){var n=Z.EpF();Z.ynx(0),Z.TgZ(1,"ion-item",1),Z.NdJ("touchstart",function(){return Z.CHM(n),Z.oxw().touch(!0)})("mousedown",function(){return Z.CHM(n),Z.oxw().mouse(!0)})("touchend",function(){return Z.CHM(n),Z.oxw().touch(!1)})("mouseup",function(){return Z.CHM(n),Z.oxw().mouse(!1)}),Z._UZ(2,"input",2),Z.qZA(),Z.YNc(3,W,6,1,"ion-item",3),Z.TgZ(4,"ion-item",4),Z.TgZ(5,"ion-range",5),Z.NdJ("touchstart",function(){return Z.CHM(n),Z.oxw().touch(!0)})("mousedown",function(){return Z.CHM(n),Z.oxw().mouse(!0)})("touchend",function(){return Z.CHM(n),Z.oxw().touch(!1)})("mouseup",function(){return Z.CHM(n),Z.oxw().mouse(!1)}),Z._UZ(6,"ion-icon",6),Z._UZ(7,"ion-icon",7),Z.qZA(),Z.qZA(),Z.YNc(8,X,6,1,"ion-item",3),Z.TgZ(9,"ion-item",8),Z.TgZ(10,"ion-range",5),Z.NdJ("touchstart",function(){return Z.CHM(n),Z.oxw().touch(!0)})("mousedown",function(){return Z.CHM(n),Z.oxw().mouse(!0)})("touchend",function(){return Z.CHM(n),Z.oxw().touch(!1)})("mouseup",function(){return Z.CHM(n),Z.oxw().mouse(!1)}),Z._UZ(11,"ion-icon",6),Z._UZ(12,"ion-icon",7),Z.qZA(),Z.qZA(),Z.BQk()}if(2&e){var i=Z.oxw();Z.xp6(3),Z.Q6J("ngIf",i.showCurrent),Z.xp6(1),Z.Udp("margin-top",i.showCurrent?"-40px":"-20px"),Z.xp6(1),Z.Q6J("formControl",i.formControlGain),Z.xp6(3),Z.Q6J("ngIf",i.showCurrent),Z.xp6(1),Z.Udp("margin-top",i.showCurrent?"-40px":"-20px"),Z.xp6(1),Z.Q6J("formControl",i.formControlWhite)}}var ee=function(){var e=function(){function e(t,n,i){p(this,e),this.elementRef=t,this.localService=n,this.deviceService=i,this.showCurrent=!0,this.formControlGain=new g.NI(null,null,this.onLightGainValidatorFn()),this.formControlWhite=new g.NI(null,null,this.onLightWhiteValidatorFn()),this.color=new F.xQ,this.unsubscribe=new F.xQ}return d(e,[{key:"ngOnChanges",value:function(){var e,t,n,i,o,r,a,c,s,l,u,d,p,v,f,h;if(!this.dragging&&!this.mousedown&&(null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights)){this.formControlGain.setValue(null===(a=null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceStatus)||void 0===i?void 0:i.lights[null===(r=null===(o=this.deviceInfo)||void 0===o?void 0:o.device)||void 0===r?void 0:r.channel])||void 0===a?void 0:a.gain,{emitEvent:!1}),this.formControlWhite.setValue((null===(d=null===(s=null===(c=this.deviceInfo)||void 0===c?void 0:c.deviceStatus)||void 0===s?void 0:s.lights[null===(u=null===(l=this.deviceInfo)||void 0===l?void 0:l.device)||void 0===u?void 0:u.channel])||void 0===d?void 0:d.white)/2.55,{emitEvent:!1});var g=null===(v=null===(p=this.deviceInfo)||void 0===p?void 0:p.deviceStatus)||void 0===v?void 0:v.lights[null===(h=null===(f=this.deviceInfo)||void 0===f?void 0:f.device)||void 0===h?void 0:h.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(g.red,",").concat(g.green,",").concat(g.blue,")"))}}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){var e,t,n,i,o,r,a,c,s,l,u=this;if($("#colorpicker").wheelColorPicker({htmlOptions:!0}),(null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights)&&(null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceStatus)||void 0===i?void 0:i.lights[null===(r=null===(o=this.deviceInfo)||void 0===o?void 0:o.device)||void 0===r?void 0:r.channel])){var d=null===(c=null===(a=this.deviceInfo)||void 0===a?void 0:a.deviceStatus)||void 0===c?void 0:c.lights[null===(l=null===(s=this.deviceInfo)||void 0===s?void 0:s.device)||void 0===l?void 0:l.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(d.red,",").concat(d.green,",").concat(d.blue,")"))}$("#colorpicker").on("slidermove",function(){var e=$("#colorpicker").get(0).value.slice(4,-1).split(",");u.color.next({red:+e[0],green:+e[1],blue:+e[2]})}),this.color.pipe((0,Q.b)(50),(0,G.x)(),(0,Y.w)(function(e){return(0,S.of)(u.onLightColor(e))}),(0,B.R)(this.unsubscribe)).subscribe()}},{key:"touch",value:function(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.dragging=e}},{key:"mouse",value:function(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.mousedown=e}},{key:"onLightGainValidatorFn",value:function(){var e=this;return function(t){return t.valueChanges?t.valueChanges.pipe((0,Q.b)(50),(0,G.x)(),(0,Y.w)(function(t){return(0,S.of)(e.onLightGain(t))}),(0,E.P)()):(0,S.of)(null)}}},{key:"onLightWhiteValidatorFn",value:function(){var e=this;return function(t){return t.valueChanges?t.valueChanges.pipe((0,Q.b)(50),(0,G.x)(),(0,Y.w)(function(t){return(0,S.of)(e.onLightWhite(+(2.55*t).toFixed(0)))}),(0,E.P)()):(0,S.of)(null)}}},{key:"onLightWhite",value:function(e){var t,n;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===j.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(function(){return o.onErrorWhite()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===j.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(function(){return o.onErrorWhite()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onLightGain",value:function(e){var t,n;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===j.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(function(){return o.onErrorGain()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===j.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(function(){return o.onErrorGain()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onLightColor",value:function(e){var t,n;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===j.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue,this.deviceInfo.ip).toPromise().catch(function(){return o.onErrorColor()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===j.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue).toPromise().catch(function(){return o.onErrorColor()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onErrorGain",value:function(){var e,t,n,i,o;this.formControlGain.setValue(null===(o=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.device)||void 0===i?void 0:i.channel])||void 0===o?void 0:o.gain,{emitEvent:!1})}},{key:"onErrorWhite",value:function(){var e,t,n,i,o;this.formControlGain.setValue(null===(o=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.device)||void 0===i?void 0:i.channel])||void 0===o?void 0:o.white,{emitEvent:!1})}},{key:"onErrorColor",value:function(){var e,t,n,i,o=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.device)||void 0===i?void 0:i.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(o.red,",").concat(o.green,",").concat(o.blue,")"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Z.SBq),Z.Y36(H.C),Z.Y36(z.U))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-color-content"]],inputs:{deviceInfo:"deviceInfo",showCurrent:"showCurrent"},features:[Z.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"touchstart","mousedown","touchend","mouseup"],["id","colorpicker","type","text","data-wheelcolorpicker","","data-wcp-sliders","hws","data-wcp-layout","block","data-wcp-format","rgb"],["mode","md","lines","none","style","z-index: 1;",4,"ngIf"],["mode","md",2,"margin-top","-40px","margin-bottom","-20px"],["id","range","mode","md","min","0","max","100","step","1","pin","true",3,"formControl","touchstart","mousedown","touchend","mouseup"],["size","small","slot","start","name","sunny","color","medium"],["slot","end","name","sunny","color","medium"],["mode","md",2,"margin-top","-40px","--background","none","margin-bottom","-20px"],["mode","md","lines","none",2,"z-index","1"],[2,"width","100%"],[2,"text-align","center"],[2,"text-align","right"]],template:function(e,t){1&e&&Z.YNc(0,K,13,8,"ng-container",0),2&e&&Z.Q6J("ngIf","light"===(null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.category)&&(null==t.deviceInfo||null==t.deviceInfo.deviceStatus?null:t.deviceInfo.deviceStatus.lights)&&"color"===(null==t.deviceInfo||null==t.deviceInfo.deviceStatus||null==t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel]?null:t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel].mode))},directives:[h.O5,m.Ie,V.e,m.I_,m.QI,g.JJ,g.oH,m.gu,m.Nd,m.wI],styles:[".control-light .popover-content{width:321px!important;max-width:321px!important}  ion-item>.jQWCP-wWidget.jQWCP-block{width:270px!important;height:195px;border:none;background:none;box-shadow:none;left:50%;transform:translate(-50%);margin:8px}[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;padding-bottom:10px;--background: none}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{padding-bottom:0;--knob-size: 25px;--bar-height: 3px;--knob-handle-size: 45px}ion-item.ios[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-handle-size: 40px;padding-bottom:1px;padding-top:44px}  .jQWCP-wWidget{outline:none!important}ion-col[_ngcontent-%COMP%]{background-color:transparent!important}"],changeDetection:0}),e}(),te=a(18343),ne=a(70775),ie=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[m.Pc,q,g.u5,g.UX,h.ez,x.aw,v._t,O,b.ot,y.lN,k.p9,P.c,R,w.FA,L.Cq,N.yI,D.LD,v._t,f.Cl,J.vQ]]}),e}();Z.B6R(te.M,[m.W2,ee],[h.Ov,ne.B]);var oe=a(12630),re=a(42138),ae=a(88592),ce=a(96628),se=a(23815),le=a(26215),ue=a(64010),de=a(20945),pe=a(11627),ve=a(55229),fe=a(5547),he=a(28243),ge=a(58579),me=a(2699);function xe(e,t){if(1&e&&(Z.TgZ(0,"ion-item",11),Z._UZ(1,"app-device",12,13),Z.ALo(3,"async"),Z.qZA()),2&e){var n=Z.MAs(2),i=Z.oxw().$implicit,o=Z.oxw().ngIf;Z.xp6(1),Z.Q6J("inView","#customizeContainer")("ping",Z.lcZ(3,6,n.isInView))("deviceInfo",o)("config",i.config)("reorder",!1)("showDetails",!1)}}function be(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-card",9),Z.NdJ("click",function(){var e=Z.CHM(n).index;return Z.oxw(2).selectedLayout=e}),Z.YNc(1,xe,4,8,"ion-item",10),Z.qZA()}if(2&e){var i=t.$implicit,o=t.index,r=Z.oxw(2);Z.Udp("display",i.hidden?"none":null),Z.ekj("selected",r.selectedLayout===o||0===o&&!r.selectedLayout),Z.xp6(1),Z.Q6J("ngIf",!i.hidden)}}function ke(e,t){if(1&e&&(Z.TgZ(0,"ion-list"),Z.YNc(1,be,2,5,"ion-card",8),Z.ALo(2,"async"),Z.qZA()),2&e){var n=Z.oxw();Z.xp6(1),Z.Q6J("ngForOf",Z.lcZ(2,1,n.layouts$))}}var we=function(){var e=function(){function e(t,n){p(this,e),this.deviceInfoService=t,this.modalController=n,this.DEVICE_TYPES=fe.h}return d(e,[{key:"ngOnInit",value:function(){this.deviceInfo$=this.deviceInfoService.subDeviceInfoChange(this.deviceId).pipe((0,pe.j)(function(e,t){return(0,de.F)(0===t?150:0)})),this.layouts$=this.deviceInfo$.pipe((0,A.U)(function(e){var t;return e.deviceStatus?((0,ve.$U)(null===(t=null==e?void 0:e.device)||void 0===t?void 0:t.category)||(0,ve.$U)("default")).map(function(t){return{config:t,hidden:!(0,ve.v)(t,e)}}):[]}),(0,G.x)(this.compareConfig))}},{key:"closeModal",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}},{key:"save",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss({selectedLayout:this.selectedLayout});case 2:case"end":return e.stop()}},e,this)}))}},{key:"addRow",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:e,cssClass:"dashboardModal",componentProps:{deviceId:this.deviceId}});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onWillDismiss();case 7:case"end":return t.stop()}},t,this)}))}},{key:"compareConfig",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(he.H),Z.Y36(m.IN))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-customize"]],decls:14,vars:6,consts:[["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["slot","icon-only","name","checkmark-done-sharp"],["id","customizeContainer","scroll-events","",1,"cards"],[4,"ngIf"],["class","card",3,"selected","display","click",4,"ngFor","ngForOf"],[1,"card",3,"click"],["mode","md","lines","none","button","",4,"ngIf"],["mode","md","lines","none","button",""],[3,"inView","ping","deviceInfo","config","reorder","showDetails"],["inView","inView"]],template:function(e,t){1&e&&(Z.TgZ(0,"ion-header"),Z.TgZ(1,"ion-toolbar"),Z.TgZ(2,"ion-buttons",0),Z.TgZ(3,"ion-button",1),Z.NdJ("click",function(){return t.closeModal()}),Z._UZ(4,"ion-icon",2),Z.qZA(),Z.qZA(),Z.TgZ(5,"ion-title",3),Z._uU(6),Z.ALo(7,"translate"),Z.qZA(),Z.TgZ(8,"ion-buttons",4),Z.TgZ(9,"ion-button",1),Z.NdJ("click",function(){return t.save()}),Z._UZ(10,"ion-icon",5),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(11,"ion-content",6),Z.YNc(12,ke,3,3,"ion-list",7),Z.ALo(13,"async"),Z.qZA()),2&e&&(Z.xp6(6),Z.hij(" ",Z.lcZ(7,2,"app.component.customize.header.label")," "),Z.xp6(6),Z.Q6J("ngIf",Z.lcZ(13,4,t.deviceInfo$)))},directives:[m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.W2,h.O5,m.q_,h.sg,m.PM,m.Ie,V.e,ge.v,me.z],pipes:[x.X$,h.Ov],styles:["[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}app-device[_ngcontent-%COMP%]{width:100%;z-index:-1}ion-card.selected[_ngcontent-%COMP%]{box-shadow:0 0 1px 3px var(--ion-color-primary-shade)!important}ion-card[_ngcontent-%COMP%]{transform:translateZ(0)}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}"],changeDetection:0}),e}(),ye=a(89968),Ze=a(29379),Ce=a(99119),Se=a(25355),Ie=a(42810),Ae=a(17238),_e=a(52580),Me=a(45435),Te=a(97722),Oe=a(77220),Pe=a(52141),Le=a(56149),De=["matSelect"];function Re(e,t){1&e&&Z._UZ(0,"ion-progress-bar",21)}function Je(e,t){if(1&e&&(Z.TgZ(0,"mat-option",22),Z._uU(1),Z.TgZ(2,"div",23),Z._uU(3),Z.qZA(),Z.qZA()),2&e){var n=t.$implicit,i=Z.oxw(2);Z.Q6J("value",n),Z.xp6(1),Z.hij(" ","Shelly "+i.deviceTypes[n].friendly_name," "),Z.xp6(2),Z.hij(" ",i.deviceTypes[n].name," ")}}function Ne(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"img",24),Z.NdJ("error",function(){return Z.CHM(n),Z.oxw(2).onImageError(!0)}),Z.qZA()}if(2&e){var i=Z.oxw().ngIf;Z.Q6J("src","https://home.shelly.cloud/images/device_images/"+i.selectedDevice+".png",Z.LSH)}}function qe(e,t){1&e&&(Z.TgZ(0,"h2",25),Z._uU(1," No image available "),Z.qZA())}function Ue(e,t){1&e&&Z._UZ(0,"ion-spinner")}function $e(e,t){1&e&&Z._UZ(0,"ion-icon",30)}function Fe(e,t){1&e&&Z._UZ(0,"ion-icon",31)}function Qe(e,t){1&e&&Z._UZ(0,"ion-icon",32)}function Ge(e,t){1&e&&Z._UZ(0,"ion-spinner")}function Ye(e,t){1&e&&Z._UZ(0,"ion-icon",30)}function Be(e,t){1&e&&Z._UZ(0,"ion-icon",31)}function Ee(e,t){1&e&&Z._UZ(0,"ion-spinner")}function je(e,t){1&e&&Z._UZ(0,"ion-icon",30)}function He(e,t){1&e&&Z._UZ(0,"ion-icon",31)}function ze(e,t){1&e&&Z._UZ(0,"ion-spinner")}function Ve(e,t){1&e&&Z._UZ(0,"ion-icon",30)}function We(e,t){1&e&&Z._UZ(0,"ion-icon",31)}function Xe(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"div",26),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(2).resetState()}),Z.TgZ(1,"div"),Z.TgZ(2,"div"),Z._uU(3),Z.YNc(4,Ue,1,0,"ion-spinner",0),Z.YNc(5,$e,1,0,"ion-icon",27),Z.YNc(6,Fe,1,0,"ion-icon",28),Z.YNc(7,Qe,1,0,"ion-icon",29),Z.qZA(),Z.TgZ(8,"div"),Z._uU(9),Z.YNc(10,Ge,1,0,"ion-spinner",0),Z.YNc(11,Ye,1,0,"ion-icon",27),Z.YNc(12,Be,1,0,"ion-icon",28),Z.qZA(),Z.TgZ(13,"div"),Z._uU(14),Z.YNc(15,Ee,1,0,"ion-spinner",0),Z.YNc(16,je,1,0,"ion-icon",27),Z.YNc(17,He,1,0,"ion-icon",28),Z.qZA(),Z.TgZ(18,"div"),Z._uU(19),Z.YNc(20,ze,1,0,"ion-spinner",0),Z.YNc(21,Ve,1,0,"ion-icon",27),Z.YNc(22,We,1,0,"ion-icon",28),Z.qZA(),Z.qZA(),Z.qZA()}if(2&e){var i=Z.oxw().ngIf,o=Z.oxw();Z.Q6J("@showHide",void 0),Z.xp6(3),Z.hij(' 1. Verifying "',i.network,'" '),Z.xp6(1),Z.Q6J("ngIf",void 0===i.state.verifiedNetwork),Z.xp6(1),Z.Q6J("ngIf",!1===i.state.verifiedNetwork),Z.xp6(1),Z.Q6J("ngIf",!0===i.state.verifiedNetwork&&!i.state.warningNetwork),Z.xp6(1),Z.Q6J("ngIf",!0===i.state.verifiedNetwork&&i.state.warningNetwork),Z.xp6(1),Z.ekj("inactive",!i.state.verifiedNetwork),Z.xp6(1),Z.hij(' 2. Connecting to "',"Shelly "+o.deviceTypes[i.selectedDevice].friendly_name,'" '),Z.xp6(1),Z.Q6J("ngIf",i.state.verifiedNetwork&&void 0===i.state.connectedShelly),Z.xp6(1),Z.Q6J("ngIf",!1===i.state.connectedShelly),Z.xp6(1),Z.Q6J("ngIf",!0===i.state.connectedShelly),Z.xp6(1),Z.ekj("inactive",!i.state.connectedShelly),Z.xp6(1),Z.hij(' 3. Sending information to "',"Shelly "+o.deviceTypes[i.selectedDevice].friendly_name,'" '),Z.xp6(1),Z.Q6J("ngIf",i.state.connectedShelly&&void 0===i.state.sendShelly),Z.xp6(1),Z.Q6J("ngIf",!1===i.state.sendShelly),Z.xp6(1),Z.Q6J("ngIf",!0===i.state.sendShelly),Z.xp6(1),Z.ekj("inactive",!i.state.sendShelly),Z.xp6(1),Z.hij(' 4. Connecting to "',i.network,'" '),Z.xp6(1),Z.Q6J("ngIf",i.state.sendShelly&&void 0===i.state.connectedNetwork),Z.xp6(1),Z.Q6J("ngIf",!1===i.state.connectedNetwork),Z.xp6(1),Z.Q6J("ngIf",!0===i.state.connectedNetwork)}}function Ke(e,t){if(1&e){var n=Z.EpF();Z.ynx(0),Z.TgZ(1,"ion-header"),Z.TgZ(2,"ion-toolbar"),Z.TgZ(3,"ion-buttons",1),Z.TgZ(4,"ion-button",2),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw().closeModal()}),Z._UZ(5,"ion-icon",3),Z.qZA(),Z.qZA(),Z.TgZ(6,"ion-title",4),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.YNc(9,Re,1,0,"ion-progress-bar",5),Z.qZA(),Z.qZA(),Z.TgZ(10,"ion-content",6),Z.TgZ(11,"h2"),Z._uU(12),Z.ALo(13,"translate"),Z.qZA(),Z.TgZ(14,"mat-form-field",7),Z.TgZ(15,"mat-label"),Z._uU(16),Z.ALo(17,"translate"),Z.TgZ(18,"div",8),Z._uU(19),Z.ALo(20,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(21,"mat-select",9,10),Z.NdJ("ngModelChange",function(e){return Z.CHM(n).ngIf.selectedDevice=e})("ngModelChange",function(){return Z.CHM(n),Z.oxw().onImageError(!1)}),Z.TgZ(23,"mat-select-trigger"),Z._uU(24),Z.TgZ(25,"div",11),Z._uU(26),Z.qZA(),Z.qZA(),Z.YNc(27,Je,4,3,"mat-option",12),Z.qZA(),Z.qZA(),Z.YNc(28,Ne,1,1,"img",13),Z.YNc(29,qe,2,0,"h2",14),Z.TgZ(30,"h2"),Z._uU(31),Z.ALo(32,"translate"),Z.qZA(),Z.TgZ(33,"mat-form-field",15),Z.TgZ(34,"mat-label"),Z._uU(35),Z.ALo(36,"translate"),Z.qZA(),Z.TgZ(37,"input",16),Z.NdJ("ngModelChange",function(e){return Z.CHM(n).ngIf.network=e}),Z.qZA(),Z.qZA(),Z.TgZ(38,"mat-form-field",17),Z.TgZ(39,"mat-label"),Z._uU(40),Z.ALo(41,"translate"),Z.qZA(),Z.TgZ(42,"input",18),Z.NdJ("ngModelChange",function(e){return Z.CHM(n).ngIf.password=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(43,"ion-footer"),Z.TgZ(44,"ion-toolbar"),Z.TgZ(45,"ion-button",19),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw().addDevice()}),Z._uU(46),Z.ALo(47,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(48,Xe,23,24,"div",20),Z.BQk()}if(2&e){var i=t.ngIf,o=Z.oxw();Z.xp6(7),Z.hij(" ",Z.lcZ(8,22,"app.component.more.add-devices.label")," "),Z.xp6(2),Z.Q6J("ngIf",i.loading),Z.xp6(3),Z.Oqu(Z.lcZ(13,24,"app.component.add.select-shelly.label")),Z.xp6(4),Z.hij(" ",Z.lcZ(17,26,"app.component.add.select-type.label")," "),Z.xp6(3),Z.hij(" ",Z.lcZ(20,28,"app.component.add.select-ssid.label")," "),Z.xp6(2),Z.Q6J("ngModel",i.selectedDevice)("disabled",i.loading),Z.xp6(3),Z.hij(" ","Shelly "+o.deviceTypes[i.selectedDevice].friendly_name," "),Z.xp6(2),Z.hij(" ",o.deviceTypes[i.selectedDevice].name," "),Z.xp6(1),Z.Q6J("ngForOf",i.devices),Z.xp6(1),Z.Q6J("ngIf",!i.imageError),Z.xp6(1),Z.Q6J("ngIf",i.imageError),Z.xp6(2),Z.Oqu(Z.lcZ(32,30,"app.component.add.network.header.label")),Z.xp6(4),Z.Oqu(Z.lcZ(36,32,"app.component.add.network.label")),Z.xp6(2),Z.Q6J("ngModel",i.network)("disabled",i.loading),Z.xp6(3),Z.Oqu(Z.lcZ(41,34,"app.component.add.password.label")),Z.xp6(2),Z.Q6J("ngModel",i.password)("disabled",i.loading),Z.xp6(3),Z.Q6J("disabled",!i.network||!i.password||i.loading),Z.xp6(1),Z.hij(" ",Z.lcZ(47,36,"app.component.add.confirm.label")," "),Z.xp6(2),Z.Q6J("ngIf",i.state)}}var et=function(){var e=function(){function e(t,n,i,o,r,a){p(this,e),this.notificationsService=t,this.localService=n,this.alertService=i,this.lookupService=o,this.modalController=r,this.deviceInfoService=a,this.state$=new le.X({devices:[],selectedDevice:"SHSW-1"}),this.slideOpts={initialSlide:0,speed:400},this.deviceTypes=fe.h,this.ignoredDevices=["PLG1NB","SMK1NB","DS1NB","MS1NB","HT1NB","WS1NB","SHSW-1S","SHUNI-1","SHSPOT-1"]}return d(e,[{key:"ngOnInit",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state$.value.devices=Object.keys(fe.h).filter(function(e){return-1===t.ignoredDevices.indexOf(e)}).sort(),e.next=3,_e.k.getSSID().then(function(e){return e.ssid}).catch(function(){return""});case 3:this.state$.value.network=e.sent,this.state$.next(this.state$.value);case 5:case"end":return e.stop()}},e,this)}))}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){return e.matSelect.focus()},550)}},{key:"ngOnDestroy",value:function(){}},{key:"onImageError",value:function(e){this.state$.value.imageError=e,this.state$.next(this.state$.value)}},{key:"closeModal",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}},{key:"resetState",value:function(){var e=this;(Object.keys(this.state$.value.state).some(function(t){return!1===e.state$.value.state[t]})||this.state$.value.state.connectedNetwork)&&(this.state$.value.state=void 0,this.state$.next(this.state$.value))}},{key:"addDevice",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,o,r,a,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state$.value.loading=!0,this.state$.value.state={},this.state$.next(this.state$.value),e.next=3,_e.k.getSSID().then(function(e){return e.ssid}).catch(function(){return null});case 3:return t=e.sent,e.next=6,_e.k.connect({ssid:this.state$.value.network,password:this.state$.value.password}).then(function(e){return e.ssid}).catch(function(){return null});case 6:if(n=e.sent,this.state$.value.state={warningNetwork:t===this.state$.value.network,verifiedNetwork:!!n},this.state$.next(this.state$.value),!this.state$.value.state.verifiedNetwork){e.next=35;break}return e.next=10,_e.k.connectPrefix({ssid:fe.h[this.state$.value.selectedDevice].name+"-"}).then(function(e){return e.ssid}).catch(function(){return null});case 10:if(i=e.sent,this.state$.value.state.connectedShelly=!!i,this.state$.next(this.state$.value),!this.state$.value.state.connectedShelly){e.next=35;break}return e.next=14,this.deviceInfoService.pingShellyWifi("192.168.33.1").toPromise().catch(function(){return null});case 14:if(o=e.sent,console.log(o),r=!1,!o){e.next=28;break}return e.next=20,this.deviceInfoService.subDeviceInfo(o).pipe((0,Me.h)(function(e){return!!e&&e.deviceConStatus!==j.L.offline}),(0,_.q)(1),(0,ue.V)(2e4)).toPromise();case 20:return a=e.sent,e.next=23,this.checkLocked(a);case 23:if(e.t0=e.sent,!e.t0){e.next=28;break}return e.next=27,this.deviceInfoService.setWifi(a.device,this.state$.value.network,this.state$.value.password,"192.168.33.1").toPromise().catch(function(e){return null}).then(function(e){return!!e});case 27:r=e.sent;case 28:if(this.state$.value.state.sendShelly=r,this.state$.next(this.state$.value),!this.state$.value.state.sendShelly){e.next=35;break}return e.next=31,(0,Te.Vs)(2e3);case 31:return e.next=33,_e.k.connect({ssid:this.state$.value.network,password:this.state$.value.password}).then(function(e){return e.ssid}).catch(function(){return null});case 33:c=e.sent,this.state$.value.state.connectedNetwork=!!c,this.state$.next(this.state$.value);case 35:this.state$.value.state.connectedNetwork&&this.notificationsService.presentCustomToast("Successfully send network information to the shelly device. You can now search and add it",6e3),this.state$.value.loading=!1,this.state$.next(this.state$.value);case 36:case"end":return e.stop()}},e,this)}))}},{key:"checkLocked",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.deviceConStatus!==j.L.locked){t.next=17;break}return t.next=3,this.alertService.onClickUnlock();case 3:if(!(n=t.sent)){t.next=16;break}return i={enabled:!0,unprotected:!1,password:(0,Te.r3)(n.password),username:2!==e.device.gen?(0,Te.r3)(n.username):"admin"},(o=(0,se.cloneDeep)(e.device)).login=i,t.next=9,this.localService.deviceInfo(o,e.ip).toPromise().catch(function(){return null});case 9:if(!(r=t.sent)){t.next=16;break}return o.category=this.deviceInfoService.getCategory(o.type,r.mode),this.lookupService.setDevice(o.id,o),t.next=15,this.deviceInfoService.checkStatus(o,e.ip,!0).pipe((0,_.q)(1)).toPromise();case 15:return t.abrupt("return",!0);case 16:return t.abrupt("return",!1);case 17:return t.abrupt("return",!0);case 18:case"end":return t.stop()}},t,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Oe.T),Z.Y36(H.C),Z.Y36(Pe.c),Z.Y36(Le.W),Z.Y36(m.IN),Z.Y36(he.H))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-search"]],viewQuery:function(e,t){var n;(1&e&&Z.Gf(De,5),2&e)&&(Z.iGM(n=Z.CRH())&&(t.matSelect=n.first))},decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["type","indeterminate",4,"ngIf"],["fullscreen","true","id","searchContainer","scroll-events",""],["appearance","fill",1,"select"],[2,"float","right","padding-right","25px"],[3,"ngModel","disabled","ngModelChange"],["matSelect",""],[1,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"src","error",4,"ngIf"],["style","height: 184px; vertical-align: center; line-height: 160px;",4,"ngIf"],["appearance","fill",1,"network"],["matInput","","type","ssid",3,"ngModel","disabled","ngModelChange"],["appearance","fill",1,"password"],["matInput","","type","password",3,"ngModel","disabled","ngModelChange"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["class","status",3,"click",4,"ngIf"],["type","indeterminate"],[3,"value"],[2,"float","right","filter","contrast(0.5)"],[3,"src","error"],[2,"height","184px","vertical-align","center","line-height","160px"],[1,"status",3,"click"],["slot","icon-only","name","close","color","danger",4,"ngIf"],["slot","icon-only","name","checkmark-done-outline","color","success",4,"ngIf"],["slot","icon-only","name","warning-outline","color","warning",4,"ngIf"],["slot","icon-only","name","close","color","danger"],["slot","icon-only","name","checkmark-done-outline","color","success"],["slot","icon-only","name","warning-outline","color","warning"]],template:function(e,t){1&e&&(Z.YNc(0,Ke,49,38,"ng-container",0),Z.ALo(1,"async")),2&e&&Z.Q6J("ngIf",Z.lcZ(1,1,t.state$))},directives:[h.O5,m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.W2,y.KE,y.hX,D.gD,g.JJ,g.On,D.$L,h.sg,P.Nt,g.Fj,m.fr,m.X7,C.ey,m.PQ],pipes:[h.Ov,x.X$],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.select[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:0 50px;margin:0 auto;display:block}.label[_ngcontent-%COMP%]{filter:contrast(.5);position:absolute;top:0;right:18px;max-width:100px;overflow-x:auto}  body.dark .select .mat-form-field-label{color:#9fa8da}  body:not(.dark) .select .mat-form-field-label{color:#3f51b5}img[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;margin:0 auto;display:block;height:200px}.network[_ngcontent-%COMP%], .password[_ngcontent-%COMP%]{width:100%;max-width:400px;padding-left:50px;padding-right:50px;margin:0 auto;display:block}h2[_ngcontent-%COMP%]{padding-top:20px;text-align:center}.status[_ngcontent-%COMP%]{position:fixed;width:100vw;height:100vh;background-color:#d3d3d33a;z-index:10}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--ion-text-color);background:var(--ion-background-color);border-radius:10px;padding:10px;height:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:7px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-spinner[_ngcontent-%COMP%]{height:20px;width:20px;float:right;margin-left:20px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{font-size:20px;float:right;margin-left:20px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   div.inactive[_ngcontent-%COMP%]{color:#a9a9a9;margin-right:40px}"],data:{animation:[(0,Ae.X$)("showHide",[(0,Ae.eR)(":enter",[(0,Ae.oB)({opacity:"0"}),(0,Ae.jt)("300ms ease-in",(0,Ae.oB)({opacity:"1"}))]),(0,Ae.eR)(":leave",[(0,Ae.jt)("300ms ease-out",(0,Ae.oB)({opacity:"0"}))])])]},changeDetection:0}),e}(),tt=a(72353),nt=a(9112),it=a(65792),ot=function(){var e=function(){function e(t){p(this,e),this.popoverController=t,this.type="update"}return d(e,[{key:"confirm",value:function(){this.popoverController.dismiss({type:this.type})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(m.Dh))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-update-settings"]],decls:17,vars:8,consts:[["mode","md","button","","lines","none",3,"detail","click"],["slot","start",2,"pointer-events","none","margin-left","5px","margin-right","20px",3,"ngModel"],["color","primary",2,"text-align","center","padding-right","25px"]],template:function(e,t){1&e&&(Z.TgZ(0,"div"),Z.TgZ(1,"ion-item",0),Z.NdJ("click",function(){return t.type="update",t.confirm()}),Z._UZ(2,"ion-checkbox",1),Z.TgZ(3,"ion-label",2),Z._uU(4," Latest "),Z.qZA(),Z.qZA(),Z.TgZ(5,"ion-item",0),Z.NdJ("click",function(){return t.type="beta",t.confirm()}),Z._UZ(6,"ion-checkbox",1),Z.TgZ(7,"ion-label",2),Z._uU(8," Beta "),Z.qZA(),Z.qZA(),Z.TgZ(9,"ion-item",0),Z.NdJ("click",function(){return t.type="revert",t.confirm()}),Z._UZ(10,"ion-checkbox",1),Z.TgZ(11,"ion-label",2),Z._uU(12," Revert Beta "),Z.qZA(),Z.qZA(),Z.TgZ(13,"ion-item",0),Z.NdJ("click",function(){return t.type="select",t.confirm()}),Z._UZ(14,"ion-checkbox",1),Z.TgZ(15,"ion-label",2),Z._uU(16," Select firmware "),Z.qZA(),Z.qZA(),Z.qZA()),2&e&&(Z.xp6(1),Z.Q6J("detail",!1),Z.xp6(1),Z.Q6J("ngModel","update"===t.type),Z.xp6(3),Z.Q6J("detail",!1),Z.xp6(1),Z.Q6J("ngModel","beta"===t.type),Z.xp6(3),Z.Q6J("detail",!1),Z.xp6(1),Z.Q6J("ngModel","revert"===t.type),Z.xp6(3),Z.Q6J("detail",!1),Z.xp6(1),Z.Q6J("ngModel","select"===t.type))},directives:[m.Ie,V.e,m.nz,m.w,g.JJ,g.On,m.Q$],styles:[".md.update-settings-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.update-settings-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),e}(),rt=a(9074),at=a(68384),ct=a(72773),st=a(8239);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var lt=function(){return(e=lt||(lt={})).Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE",lt;var e}(),ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(r,e);var t,n,i=(t=r,n=c(),function(){var e,i=l(t);if(n){var r=l(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return o(this,e)});function r(e,t){var n;return p(this,r),(n=i.call(this,e)).message=e,n.code=t,n}return r}(r(Error)),dt=(0,function(e){return e.Capacitor=function(e){var n,i,o,r,a,c=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},l=s.Plugins=s.Plugins||{},u=e.CapacitorPlatforms,d=(null===(n=null==u?void 0:u.currentPlatform)||void 0===n?void 0:n.getPlatform)||function(){return null!==c?c.name:function(e){var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"}(e)},p=(null===(i=null==u?void 0:u.currentPlatform)||void 0===i?void 0:i.isNativePlatform)||function(){return"web"!==d()},v=(null===(o=null==u?void 0:u.currentPlatform)||void 0===o?void 0:o.isPluginAvailable)||function(e){var t=h.get(e);return!(!(null==t?void 0:t.platforms.has(d()))&&!f(e))},f=(null===(r=null==u?void 0:u.currentPlatform)||void 0===r?void 0:r.getPluginHeader)||function(e){var t;return null===(t=s.PluginHeaders)||void 0===t?void 0:t.find(function(t){return t.name===e})},h=new Map,g=(null===(a=null==u?void 0:u.currentPlatform)||void 0===a?void 0:a.registerPlugin)||function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=h.get(e);if(i)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),i.proxy;var o,r,a=d(),u=f(e),p=(r=(0,st.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o||!(a in n)){e.next=11;break}if("function"!=typeof n[a]){e.next=7;break}return e.next=4,n[a]();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=n[a];case 8:o=o=e.t0,e.next=21;break;case 11:if(e.t1=null!==c&&!o&&"web"in n,!e.t1){e.next=21;break}if("function"!=typeof n.web){e.next=19;break}return e.next=16,n.web();case 16:e.t2=e.sent,e.next=20;break;case 19:e.t2=n.web;case 20:o=o=e.t2;case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)}),v=function(t){var n,i=function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];var c=p().then(function(i){var r=function(t,n){var i,o;if(!u){if(t)return null===(o=t[n])||void 0===o?void 0:o.bind(t);throw new ut('"'.concat(e,'" plugin is not implemented on ').concat(a),lt.Unimplemented)}var r=null==u?void 0:u.methods.find(function(e){return n===e.name});return r?"promise"===r.rtype?function(t){return s.nativePromise(e,n.toString(),t)}:function(t,i){return s.nativeCallback(e,n.toString(),t,i)}:t?null===(i=t[n])||void 0===i?void 0:i.bind(t):void 0}(i,t);if(r){var c=r.apply(void 0,o);return n=null==c?void 0:c.remove,c}throw new ut('"'.concat(e,".").concat(t,'()" is not implemented on ').concat(a),lt.Unimplemented)});return"addListener"===t&&(c.remove=(0,st.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n());case 1:case"end":return e.stop()}},e)}))),c};return i.toString=function(){return"".concat(t.toString(),"() { [capacitor code] }")},Object.defineProperty(i,"name",{value:t,writable:!1,configurable:!1}),i},g=v("addListener"),m=v("removeListener"),x=function(e,t){var n,i=g({eventName:e},t),o=(n=(0,st.Z)(regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i;case 2:o=n.sent,m({eventName:e,callbackId:o},t);case 4:case"end":return n.stop()}},n)})),function(){return n.apply(this,arguments)}),r=new Promise(function(e){return i.then(function(){return e({remove:o})})});return r.remove=(0,st.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("Using addListener() without 'await' is deprecated."),e.next=3,o();case 3:case"end":return e.stop()}},e)})),r},b=new Proxy({},{get:function(e,t){switch(t){case"$$typeof":return;case"toJSON":return function(){return{}};case"addListener":return u?x:g;case"removeListener":return m;default:return v(t)}}});return l[e]=b,h.set(e,{name:e,proxy:b,platforms:new Set([].concat(t(Object.keys(n)),t(u?[a]:[])))}),b};return s.convertFileSrc||(s.convertFileSrc=function(e){return e}),s.getPlatform=d,s.handleError=function(t){return e.console.error(t)},s.isNativePlatform=p,s.isPluginAvailable=v,s.pluginMethodNoop=function(e,t,n){return Promise.reject("".concat(n,' does not have an implementation of "').concat(t,'".'))},s.registerPlugin=g,s.Exception=ut,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s}(e)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).registerPlugin)("Filesystem",{electron:function(){return window.CapacitorCustomPlatform.plugins.Filesystem}}),pt=ct.fy,vt=function(){var e=function(){function e(t,n){p(this,e),this.platform=t,this.domSanitizer=n,this.baseDirectory=ct.tP.Data,this.folder="ShellyHome",this.platform.is("electron")&&(pt=dt)}return d(e,[{key:"initFolder",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.platform.is("electron")&&(this.baseDirectory=ct.tP.Documents),this.folder=e,t.next=4,pt.mkdir({path:this.folder,directory:this.baseDirectory,recursive:!1}).catch(function(e){return console.error(e),null});case 4:return t.next=6,pt.getUri({path:this.folder,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 6:return this.directory=t.sent,t.abrupt("return",this.directory);case 8:case"end":return t.stop()}},t,this)}))}},{key:"fetchFileNames",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.folder;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,pt.readdir({path:e,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 2:if(i=n.sent,!((o=i?i.files:[]).length>0)){n.next=10;break}return n.next=7,Promise.all(o.map(function(t){return r.fetchFileNames(e+"/"+t)}));case 7:n.t0=n.sent.reduce(function(e,n){return[].concat(t(e),t(n))},[]),n.next=11;break;case 10:n.t0=[e];case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n,this)}))}},{key:"writeFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3/64;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){i.next=5;break}return i.next=3,this.convertToBase64Chunks(t,n,function(t,n){return(0,U.mG)(o,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=5;break}return i.next=3,pt.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,recursive:!0});case 3:i.next=7;break;case 5:return i.next=7,pt.appendFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t});case 7:case"end":return i.stop()}},i,this)}))});case 3:i.next=7;break;case 5:return i.next=7,pt.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,encoding:ct.ez.UTF8,recursive:!0});case 7:case"end":return i.stop()}},i,this)}))}},{key:"readFile",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){t.next=3;break}return n=at.dV.convertFileSrc(this.directory.uri+"/"+e),t.abrupt("return",{success:this.domSanitizer.bypassSecurityTrustResourceUrl(n),revoke:function(){}});case 3:return t.next=5,this.readFileAsBlob(e);case 5:return i=t.sent,o=URL.createObjectURL(i),t.abrupt("return",{success:this.domSanitizer.bypassSecurityTrustResourceUrl(o),revoke:function(){URL.revokeObjectURL(o)}});case 8:case"end":return t.stop()}},t,this)}))}},{key:"readFileAsBlob",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){t.next=5;break}return n=at.dV.convertFileSrc(this.directory.uri+"/"+e),t.next=4,fetch(n).then(function(e){return e.blob()});case 4:return t.abrupt("return",t.sent);case 5:return t.next=7,pt.readFile({path:this.folder+"/"+e,directory:this.baseDirectory});case 7:return t.abrupt("return",t.sent.data);case 8:case"end":return t.stop()}},t,this)}))}},{key:"deleteFile",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pt.deleteFile({path:this.folder+"/"+e,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 2:case"end":return t.stop()}},t,this)}))}},{key:"start",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.directory.uri,e.next=3,rt.D.start({path:t,port:8080}).then(function(e){return"http://"+e.ip+":8080"}).catch(function(e){return null});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}))}},{key:"stop",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.D.stop().catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)}))}},{key:"convertToBase64Chunks",value:function(e,t,n){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,r,a,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!((o=1048576*t)%6)){i.next=3;break}throw{error:"Chunksize must be a multiple of 6!"};case 3:r=e.size;case 4:if(!(e.size>o)){i.next=13;break}return i.next=7,this.convertToBase64(e.slice(0,o));case 7:return a=i.sent,i.next=10,n(r===e.size?a:a.split(",")[1],r===e.size);case 10:e=e.slice(o);case 11:i.next=4;break;case 13:return i.next=15,this.convertToBase64(e.slice(0,e.size));case 15:return c=i.sent,i.next=18,n(c.split(",")[1],r===e.size);case 18:e=e.slice(e.size);case 19:case"end":return i.stop()}},i,this)}))}},{key:"convertToBase64",value:function(e){return new Promise(function(t,n){var i=new FileReader,o=i._realReader;o&&(i=o),i.onerror=function(e){console.log(e),n()},i.onload=function(){t(i.result)},i.readAsDataURL(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.LFG(m.t4),Z.LFG(T.H7))},e.\u0275prov=Z.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ft=function(){var t=function(){function t(e,n,i,o,r,a){p(this,t),this.httpClient=e,this.fileService=n,this.deviceService=i,this.translateService=o,this.loadingController=r,this.notificationsService=a}return d(t,[{key:"checkDevices",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"update",i=arguments.length>3?arguments[3]:void 0,o={};return{deviceInfos:t.filter(function(t){var r,a,c,s,l=t.deviceInfos[0],u=null===(a=null===(r=l.deviceStatus)||void 0===r?void 0:r.update)||void 0===a?void 0:a.old_version;if(l.deviceStatus&&u){var d=!1;return"update"===n?((d=!!e[l.device.type]&&(null===(c=e[l.device.type].version)||void 0===c?void 0:c.split("/")[0])>(null==u?void 0:u.split("/")[0]))&&(o[l.device.type]={version:e[l.device.type].version,url:e[l.device.type].url}),d):"beta"===n?((d=e[l.device.type]&&(null===(s=e[l.device.type].beta_ver)||void 0===s?void 0:s.split("/")[0])>(null==u?void 0:u.split("/")[0]))&&(o[l.device.type]={beta_ver:e[l.device.type].beta_ver,beta_url:e[l.device.type].beta_url}),d):("revert"===n?(d=e[l.device.type]&&e[l.device.type].version&&(null==u?void 0:u.indexOf("-rc"))>-1)&&(o[l.device.type]={version:e[l.device.type].version,url:e[l.device.type].url}):"select"===n&&i&&((d=i.startsWith(l.device.type)&&l.device.type+"_"+(null==u?void 0:u.split("/")[0])!==(null==i?void 0:i.split(".")[0]))&&(o[l.device.type]={version:i,url:i})),d)}return!1}),firmwareList:o}}},{key:"checkFirmwares",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o,r,a,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fileService.initFolder("ShellyHome");case 2:return t.next=4,this.deviceService.getFirmwareList();case 4:if(n=t.sent){t.next=12;break}return n={},t.next=9,this.getFirmareEntries();case 9:i=t.sent,o=e(i);try{for(o.s();!(r=o.n()).done;)a=r.value,c=a.split("/").slice(0,-1).join("/"),n[a.split("_")[0]]={url:null,version:c}}catch(s){o.e(s)}finally{o.f()}case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}},t,this)}))}},{key:"startDeviceUpdateServer",value:function(){return this.fileService.start()}},{key:"downloadFiles",value:function(t){var n=this;return new Promise(function(i){return(0,U.mG)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=4;break}return n.delegateYield(regeneratorRuntime.mark(function n(){var r,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.getFirmareEntries();case 2:if(r=n.sent,!((a=Object.keys(t).filter(function(e){return-1===r.indexOf(o.getFilename(e,t[e].version||t[e].beta_ver,t[e].url||t[e].beta_url))})).length>0)){n.next=8;break}return n.delegateYield(regeneratorRuntime.mark(function n(){var r,c,s,l,u,d,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.loadingController.create({message:o.translateService.instant("app.component.update.download.label")+" (0/"+a.length+")",showBackdrop:!1});case 2:return r=n.sent,n.next=5,r.present();case 5:c={},s={},l=[],u=e(a);try{for(p=function(){var e=d.value,n=t[e].url||t[e].beta_url,u=o.getFilename(e,t[e].version||t[e].beta_ver,n);o.httpClient.get(n,{responseType:"blob",reportProgress:!0,observe:"events"}).subscribe(function(e){return(0,U.mG)(o,void 0,void 0,regeneratorRuntime.mark(function t(){var o,d,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.type!==M.dt.DownloadProgress){t.next=6;break}c[n]=e.total,s[n]=e.loaded,d=Object.keys(s).map(function(e){return s[e]}).reduce(function(e,t){return e+t},0),p=Object.keys(c).map(function(e){return c[e]}).reduce(function(e,t){return e+t},0),r.message=(d/1e3).toFixed()+" / "+(p/1e3).toFixed()+" KB ("+(d/p*100).toFixed()+"%)",t.next=13;break;case 6:if(t.t0=e.type===M.dt.Response,!t.t0){t.next=13;break}return t.next=10,this.fileService.writeFile(u,e.body);case 10:l.push(!0),(null===(o=r.message)||void 0===o?void 0:o.toString().startsWith(this.translateService.instant("app.component.update.download.label")))&&(r.message=this.translateService.instant("app.component.update.download.label")+" ("+l.length+"/"+a.length+")"),l.length===a.length&&(r.dismiss(),i());case 13:case"end":return t.stop()}},t,this)}))},function(){l.push(!1),l.length===a.length&&(r.dismiss(),i())})},u.s();!(d=u.n()).done;)p()}catch(v){u.e(v)}finally{u.f()}case 8:case"end":return n.stop()}},n)})(),"t0",6);case 6:n.next=9;break;case 8:o.notificationsService.presentCustomToast("app.component.update.download-done.label"),i();case 9:case"end":return n.stop()}},n)})(),"t0",2);case 2:n.next=5;break;case 4:i();case 5:case"end":return n.stop()}},n)}))})}},{key:"getFirmareEntries",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fileService.fetchFileNames();case 2:return e.abrupt("return",e.sent.map(function(e){return e.replace("ShellyHome/","")}));case 3:case"end":return e.stop()}},e,this)}))}},{key:"getFilename",value:function(e,t,n){return e+"/"+t+"/"+n.split("/").pop()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(Z.LFG(M.eN),Z.LFG(vt),Z.LFG(z.U),Z.LFG(x.sK),Z.LFG(m.HT),Z.LFG(Oe.T))},t.\u0275prov=Z.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),ht=function(){var e=function(){function e(){p(this,e)}return d(e,[{key:"transform",value:function(e,t,n){return(e||[]).filter(function(e){return e[t]===n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Z.Yjl({name:"filter",type:e,pure:!0}),e}();function gt(e,t){1&e&&Z._UZ(0,"ion-progress-bar",17)}function mt(e,t){if(1&e&&(Z.TgZ(0,"ion-row"),Z._UZ(1,"app-device",25,26),Z.ALo(3,"async"),Z.qZA()),2&e){var n=t.$implicit,i=Z.MAs(2);Z.xp6(1),Z.Q6J("inView","#updateContainer")("ping",Z.lcZ(3,5,i.isInView))("deviceInfo",n)("showDetails",!1)("reorder",!1)}}function xt(e,t){if(1&e){var n=Z.EpF();Z.ynx(0),Z.TgZ(1,"ion-item",18),Z.NdJ("click",function(){var e=Z.CHM(n).$implicit;return Z.oxw(3).selectDevice(e)}),Z.TgZ(2,"ion-grid",19),Z.TgZ(3,"ion-list",20),Z.YNc(4,mt,4,7,"ion-row",13),Z.qZA(),Z.qZA(),Z._UZ(5,"ion-checkbox",21,22),Z.TgZ(7,"ion-button",23),Z.NdJ("click",function(e){var t=Z.CHM(n).$implicit,i=Z.oxw().ngIf,o=Z.oxw(2);return e.stopPropagation(),o.showInfo(t.deviceInfos[0],i.firmwareList)}),Z._UZ(8,"ion-icon",24),Z.qZA(),Z.qZA(),Z.BQk()}if(2&e){var i=t.$implicit,o=Z.oxw(2).ngIf,r=Z.oxw();Z.xp6(1),Z.Q6J("disabled",o.searching),Z.xp6(3),Z.Q6J("ngForOf",i.deviceInfos)("ngForTrackBy",r.identifyInfo),Z.xp6(1),Z.s9C("color",o.selectedDevices[i.id]&&"local"!==i.deviceInfos[0].deviceConStatus?"danger":null),Z.Q6J("mode","initial")("ngModel",o.selectedDevices[i.id]&&"local"===i.deviceInfos[0].deviceConStatus)("indeterminate",o.selectedDevices[i.id]&&"local"!==i.deviceInfos[0].deviceConStatus)}}function bt(e,t){if(1&e){var n=Z.EpF();Z.ynx(0),Z.TgZ(1,"ion-header"),Z.TgZ(2,"ion-toolbar"),Z.TgZ(3,"ion-buttons",1),Z.TgZ(4,"ion-button",2),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(2).closeModal()}),Z._UZ(5,"ion-icon",3),Z.qZA(),Z.qZA(),Z.TgZ(6,"ion-title",4),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.TgZ(9,"ion-buttons",5),Z.TgZ(10,"ion-button",6),Z.NdJ("click",function(){var e=Z.CHM(n).ngIf;return Z.oxw(2).downloadFirmwares(e.firmwareList)}),Z._UZ(11,"ion-icon",7),Z.qZA(),Z.TgZ(12,"ion-button",2),Z.NdJ("click",function(e){return Z.CHM(n),Z.oxw(2).presentPopover(e)}),Z._UZ(13,"ion-icon",8),Z.qZA(),Z.qZA(),Z.YNc(14,gt,1,0,"ion-progress-bar",9),Z.qZA(),Z.qZA(),Z.TgZ(15,"ion-content",10),Z.TgZ(16,"ion-refresher",11),Z.NdJ("ionRefresh",function(e){return Z.CHM(n),Z.oxw(2).checkFirmware(e)}),Z._UZ(17,"ion-refresher-content"),Z.qZA(),Z.TgZ(18,"ion-list",12),Z.YNc(19,xt,9,7,"ng-container",13),Z.qZA(),Z.qZA(),Z.TgZ(20,"ion-footer"),Z.TgZ(21,"ion-toolbar"),Z.TgZ(22,"div",14),Z.NdJ("click",function(){var e=Z.CHM(n).ngIf;return Z.oxw(2).selectAllDevices(e.deviceInfos)}),Z._UZ(23,"ion-checkbox",15),Z.ALo(24,"filter"),Z.ALo(25,"keyvalue"),Z.ALo(26,"filter"),Z.ALo(27,"keyvalue"),Z.ALo(28,"filter"),Z.ALo(29,"keyvalue"),Z.qZA(),Z.TgZ(30,"ion-button",16),Z.NdJ("click",function(){var e=Z.CHM(n).ngIf;return Z.oxw(2).updateDevices(e.deviceInfos,e.firmwareList)}),Z._uU(31),Z.ALo(32,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&e){var i=t.ngIf,o=Z.oxw().ngIf,r=Z.oxw();Z.xp6(7),Z.hij(" ",Z.lcZ(8,10,"app.component.more.update-devices.label")," "),Z.xp6(3),Z.Q6J("disabled",!i.firmwareList),Z.xp6(4),Z.Q6J("ngIf",o.searching),Z.xp6(2),Z.Q6J("disabled",o.searching),Z.xp6(3),Z.Q6J("ngForOf",i.deviceInfos)("ngForTrackBy",r.identify),Z.xp6(4),Z.Q6J("indeterminate",Z.Dn7(24,12,Z.lcZ(25,16,o.selectedDevices),"value",!0).length<(null==i.deviceInfos?null:i.deviceInfos.length)&&Z.Dn7(26,18,Z.lcZ(27,22,o.selectedDevices),"value",!0).length>0)("checked",Z.Dn7(28,24,Z.lcZ(29,28,o.selectedDevices),"value",!0).length===(null==i.deviceInfos?null:i.deviceInfos.length)),Z.xp6(7),Z.Q6J("disabled",o.searching||!i.firmwareList),Z.xp6(1),Z.hij(" ",Z.lcZ(32,30,"app.component.update.confirm.label")," ")}}var kt=function(){return{}};function wt(e,t){if(1&e&&(Z.ynx(0),Z.YNc(1,bt,33,32,"ng-container",0),Z.ALo(2,"async"),Z.BQk()),2&e){var n=Z.oxw();Z.xp6(1),Z.Q6J("ngIf",Z.lcZ(2,1,n.updateDevices$)||Z.DdM(3,kt))}}var yt=function(){var n=function(){function n(e,t,i,o,r,a,c,s){p(this,n),this.localService=e,this.lookupService=t,this.modalController=i,this.alertController=o,this.popoverController=r,this.deviceInfoService=a,this.deviceUpdateService=c,this.notificationsService=s,this.state$=new le.X({selectedDevices:{}}),this.firmwares$=new le.X({}),this.type="update"}return d(n,[{key:"ngOnInit",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.devices$=this.lookupService.subDeviceList().pipe((0,pe.j)(function(e,t){return(0,de.F)(0===t?100:0)}),(0,A.U)(function(e){return t(Object.keys(e))}),(0,G.x)(this.compareKeys),(0,Y.w)(function(e){return i.mapToDeviceInfo(e)}),(0,A.U)(function(e){return i.mapSameDevices(e)})),this.checkFirmware(),this.updateDevices$=(0,nt.aj)([this.devices$,this.firmwares$]).pipe((0,A.U)(function(e){return i.deviceUpdateService.checkDevices(e[1],e[0],i.type,i.selectedFirmware)}),(0,I.b)(function(t){var n,o=e(t.deviceInfos);try{for(o.s();!(n=o.n()).done;){var r=n.value;void 0===i.state$.value.selectedDevices[r.id]&&(i.state$.value.selectedDevices[r.id]=!0)}}catch(l){o.e(l)}finally{o.f()}for(var a=function(){var e=s[c];t.deviceInfos.some(function(t){return t.id===e})||delete i.state$.value.selectedDevices[e]},c=0,s=Object.keys(i.state$.value.selectedDevices);c<s.length;c++)a();i.state$.value.selectedDevices=Object.assign({},i.state$.value.selectedDevices),i.state$.next(i.state$.value)}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"checkFirmware",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.state$.value.searching=!0,this.state$.next(this.state$.value),t.next=3,this.deviceUpdateService.checkFirmwares();case 3:n=t.sent,this.firmwares$.next(n),e&&e.target.complete(),this.state$.value.searching=!1,this.state$.next(this.state$.value);case 5:case"end":return t.stop()}},t,this)}))}},{key:"showInfo",value:function(e,t){this.notificationsService.presentCustomToast(e.deviceStatus.update.old_version+"<br/> - <br/>"+(t[e.device.type].version||t[e.device.type].beta_ver),5e3)}},{key:"selectDevice",value:function(e){this.state$.value.selectedDevices[e.id]=!this.state$.value.selectedDevices[e.id],this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}},{key:"selectAllDevices",value:function(t){var n=this;if(t.length===Object.keys(this.state$.value.selectedDevices).filter(function(e){return n.state$.value.selectedDevices[e]}).length){var i,o=e(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;this.state$.value.selectedDevices[r.id]=!1}}catch(l){o.e(l)}finally{o.f()}}else{var a,c=e(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;this.state$.value.selectedDevices[s.id]=!0}}catch(l){c.e(l)}finally{c.f()}}this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}},{key:"downloadFirmwares",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deviceUpdateService.downloadFiles(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"closeModal",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}},{key:"identify",value:function(e,t){return t.id}},{key:"identifyInfo",value:function(e,t){var n;return null===(n=t.device)||void 0===n?void 0:n.id}},{key:"updateDevices",value:function(e,t){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!((i=e.filter(function(e){var t;return(null===(t=e.deviceInfos[0])||void 0===t?void 0:t.deviceConStatus)===j.L.local&&a.state$.value.selectedDevices[e.id]})).length>0)){n.next=21;break}if(n.t0="select"!==this.type,!n.t0){n.next=6;break}return n.next=6,this.downloadFirmwares(t);case 6:return this.state$.value.searching=!0,this.state$.next(this.state$.value),n.next=10,this.deviceUpdateService.startDeviceUpdateServer();case 10:return o=n.sent,r=i.map(function(e){var n,i=e.deviceInfos[0],r=i.device.type;return n="select"===a.type?a.selectedFirmware:a.deviceUpdateService.getFilename(r,t[r].version||t[r].beta_ver,t[r].url||t[r].beta_url),a.localService.ota(i.device,o+"/"+n,i.ip).pipe((0,ue.V)(1e4)).toPromise().catch(function(e){return console.log(e),null})}),n.next=14,Promise.all(r);case 14:return n.next=16,(0,S.of)().pipe((0,it.g)(5e3)).toPromise();case 16:this.notificationsService.presentCustomToast("app.component.update.done.label",3e3),this.state$.value.searching=!1,this.state$.next(this.state$.value),n.next=22;break;case 21:this.notificationsService.presentCustomToast("app.component.update.no-devices.label",3e3);case 22:case"end":return n.stop()}},n,this)}))}},{key:"presentPopover",value:function(e){var t;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.popoverController.create({component:ot,event:e,cssClass:"update-settings-popover",translucent:!1,showBackdrop:!0,componentProps:{type:this.type}});case 2:return i=n.sent,n.next=5,i.present();case 5:return n.next=7,i.onWillDismiss();case 7:if(o=n.sent,this.type=(null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.type)||this.type,n.t0="select"===this.type,!n.t0){n.next=18;break}return n.next=13,this.selectFirmware(this.selectedFirmware);case 13:if(n.t1=n.sent,n.t1){n.next=16;break}n.t1=this.selectedFirmware;case 16:this.selectedFirmware=n.t1,this.selectedFirmware||(this.type="update");case 18:this.state$.value.selectedDevices={},this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value),this.firmwares$.next(this.firmwares$.value);case 22:case"end":return n.stop()}},n,this)}))}},{key:"selectFirmware",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deviceUpdateService.getFirmareEntries();case 2:return o=t.sent.map(function(t){return{name:t,type:"radio",label:t,value:t,checked:e===t,handler:function(){n=t,i.dismiss()}}}),t.next=5,this.alertController.create({header:"Select firmware",inputs:o,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){}}]});case 5:return i=t.sent,t.next=8,i.present();case 8:return t.next=10,i.onWillDismiss();case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}},t,this)}))}},{key:"compareKeys",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"mapToDeviceInfo",value:function(e){var t=this,n=e.map(function(e){return t.deviceInfoService.subDeviceInfoChange(e)});return(0,nt.aj)(n)}},{key:"mapSameDevices",value:function(t){var n,i,o,r={},a=e(t);try{for(a.s();!(o=a.n()).done;){var c=o.value,s=null===(i=null===(n=null==c?void 0:c.device)||void 0===n?void 0:n.id)||void 0===i?void 0:i.split("_")[0];r[s]||(r[s]=[]),r[s].push(c)}}catch(l){a.e(l)}finally{a.f()}return Object.keys(r).map(function(e){return{id:e,deviceInfos:r[e]}})}}]),n}();return n.\u0275fac=function(e){return new(e||n)(Z.Y36(H.C),Z.Y36(Le.W),Z.Y36(m.IN),Z.Y36(m.Br),Z.Y36(m.Dh),Z.Y36(he.H),Z.Y36(ft),Z.Y36(Oe.T))},n.\u0275cmp=Z.Xpm({type:n,selectors:[["app-update"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["color","primary",3,"disabled","click"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","settings-outline"],["type","indeterminate",4,"ngIf"],["fullscreen","true","scroll-events",""],["slot","fixed",3,"disabled","ionRefresh"],["id","updateContainer"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"left","5px","top","8px","position","absolute","width","42px","height","42px","padding","12px","z-index","2",3,"click"],["slot","start",3,"indeterminate","checked"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["type","indeterminate"],["mode","md","lines","inset","button","",3,"disabled","click"],[2,"z-index","-1"],[2,"padding","0"],["slot","start",2,"margin-left","5px","margin-right","15px","pointer-events","none",3,"mode","color","ngModel","indeterminate"],["checkbox",""],["color","primary","slot","end","shape","round",1,"infoButton",3,"click"],["slot","icon-only","name","information-outline"],[3,"inView","ping","deviceInfo","showDetails","reorder"],["inView","inView"]],template:function(e,t){1&e&&(Z.YNc(0,wt,3,4,"ng-container",0),Z.ALo(1,"async")),2&e&&Z.Q6J("ngIf",Z.lcZ(1,1,t.state$))},directives:[h.O5,m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.W2,m.nJ,m.Wo,m.q_,h.sg,m.fr,m.nz,m.w,m.X7,m.Ie,V.e,m.jY,g.JJ,g.On,m.Nd,ge.v,me.z],pipes:[h.Ov,x.X$,ht,h.Nd],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.searchText[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%)}.searchText[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding-bottom:10px}ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%}[_nghost-%COMP%]     app-device{width:100%}[_nghost-%COMP%]     app-device>div>div{margin-bottom:-1px}[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}.infoButton[_ngcontent-%COMP%]{height:25px;width:25px;margin-left:5px;margin-right:12px}ion-item[_ngcontent-%COMP%]{--padding-start: 12px;--inner-padding-end: 0px}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:0}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding:0}ion-checkbox[_ngcontent-%COMP%]{pointer-events:none}.card[_ngcontent-%COMP%]{box-shadow:none!important;padding:0;margin:0;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden;border-radius:0!important}"],changeDetection:0}),n}(),Zt=a(90382),Ct=(0,at.fo)("Share",{web:function(){return a.e(4648).then(a.bind(a,54648)).then(function(e){return new e.ShareWeb})}}),St=a(56448),It=function(){var e=function(){function e(t,n,i,o,r){p(this,e),this.authService=t,this.alertService=n,this.lookupService=i,this.translateService=o,this.notificationsService=r}return d(e,[{key:"shareBackup",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertService.addPin(!0);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Ie.A.getInfo();case 7:return n=e.sent,e.next=10,this.createBackup();case 10:return i=e.sent,e.next=13,this.aesGcmEncrypt(JSON.stringify(i),t.pin);case 13:if(o=e.sent,"web"!==n.platform&&"mac"!==n.operatingSystem&&"windows"!==n.operatingSystem){e.next=19;break}return e.next=17,this.downloadBackup({pin:"shellyhome"!==t.pin,data:o},"shelly-home-backup.txt");case 17:e.next=21;break;case 19:return e.next=21,this.saveBackup({pin:"shellyhome"!==t.pin,data:o},"ShellyHome/shelly-home-backup.txt");case 21:case"end":return e.stop()}},e,this)}))}},{key:"saveBackup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ShellyHome/shelly-home-backup.txt";return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r,a,c=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",void this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label"));case 2:return n.next=4,Ie.A.getInfo();case 4:return i=n.sent,o=ct.tP.External,("mac"===i.operatingSystem||"windows"===i.operatingSystem)&&(o=ct.tP.Documents),r={path:t,data:JSON.stringify(e),directory:o,recursive:!0,encoding:ct.ez.UTF8},n.next=10,ct.fy.writeFile(r).catch(function(){return c.notificationsService.presentCustomToast("app.component.more.backup-download-error.label"),null});case 10:if(a=n.sent,n.t0=a,!n.t0){n.next=16;break}return this.notificationsService.presentCustomToast("app.component.more.backup-download-success.label"),n.next=16,Ct.share({title:"Shelly Home Backup",text:"Shelly Home Backup",dialogTitle:"Shelly Home Backup",url:a.uri});case 16:case"end":return n.stop()}},n,this)}))}},{key:"createBackup",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce.K.keys().then(function(e){return e.keys});case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(e){return ce.K.get({key:e}).then(function(t){return{key:e,value:t.value}})}));case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.reduce(function(e,t){var n;try{n=JSON.parse(t.value)}catch(i){n=t.value}return e[t.key]=n,e},{}));case 10:return e.prev=10,e.t0=e.catch(6),e.abrupt("return",null);case 13:case"end":return e.stop()}},e,null,[[6,10]])}))}},{key:"exportBackup",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createBackup();case 2:t=e.sent,this.downloadBackup(t,"shelly-home-backup.txt");case 4:case"end":return e.stop()}},e,this)}))}},{key:"downloadBackup",value:function(e,t){if(e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}else this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label")}},{key:"loadBackup",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=window.document.createElement("input")).type="file",t.accept="txt",t.style.height="0px",t.style.width="0px",t.style.border="0px",t.style.position="fixed",t.style.top="50%",t.style.left="50%",document.body.appendChild(t),t.click(),t.addEventListener("change",function(){var e=t.files[0];if(e.type.match(/text.*/)){var i=new FileReader,o=i._realReader;o&&(i=o),i.onload=function(){return(0,U.mG)(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,o,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!1!==(n=JSON.parse(i.result)).pin&&!0!==n.pin){e.next=16;break}if(!n.pin){e.next=9;break}return e.next=6,this.alertService.addPin();case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={pin:"shellyhome"};case 10:if(o=e.t0){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.aesGcmDecrypt(n.data,o.pin).then(function(e){return JSON.parse(e)});case 15:n=e.sent;case 16:if(void 0!==n.welcome){e.next=29;break}return e.next=19,ce.K.set({key:"deviceList",value:JSON.stringify(n.deviceList)});case 19:return e.next=21,ce.K.set({key:"deviceStatusList",value:JSON.stringify(n.deviceStatusList)});case 21:return e.next=23,ce.K.set({key:"roomList",value:JSON.stringify(n.roomList)});case 23:return e.next=25,ce.K.set({key:"groupList",value:JSON.stringify(n.groupList)});case 25:return e.next=27,this.lookupService.init();case 27:e.next=45;break;case 29:e.t1=regeneratorRuntime.keys(n);case 30:if((e.t2=e.t1()).done){e.next=41;break}if(r=e.t2.value,"string"!=typeof n[r]){e.next=37;break}return e.next=35,ce.K.set({key:r,value:n[r]});case 35:e.next=39;break;case 37:return e.next=39,ce.K.set({key:r,value:JSON.stringify(n[r])});case 39:e.next=30;break;case 41:return e.next=43,this.lookupService.init();case 43:this.authService.login(),this.lookupService.setDarkMode();case 45:this.notificationsService.presentCustomToast("app.component.more.backup-load-success.label"),e.next=51;break;case 48:e.prev=48,e.t3=e.catch(0),console.error(e.t3),this.notificationsService.presentCustomToast("app.component.more.backup-load-error.label");case 51:document.body.removeChild(t);case 52:case"end":return e.stop()}},e,this,[[0,48]])}))},i.readAsText(e)}else document.body.removeChild(t),n.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")});case 2:case"end":return e.stop()}},e)}))}},{key:"writeErrorLog",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=localStorage.getItem("errorLog"),n={path:"shelly-home-error-log.txt",data:JSON.stringify(t),directory:ct.tP.Documents,encoding:ct.ez.UTF8},ct.fy.writeFile(n).then(function(){return(0,U.mG)(i,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie.A.getInfo();case 2:return t=e.sent,this.notificationsService.presentCustomToast("app.component.more.report-error-prompt.label"),e.next=6,(0,Te.Vs)(2e3);case 6:n=this.translateService.instant("app.component.more.report-error.label"),i=("ios"===t.platform?"iOS":"android"===t.platform?"Android":"Electron")+" Version: "+t.osVersion+"\r\n\r\n"+this.translateService.instant("app.component.more.report-error-body.label")+"\r\n\r\n\r\n\r\n\r\n\r\n",o="mailto:di.gausma@googlemail.com?subject=",o+=encodeURIComponent(n),o+="&body=",o+=encodeURIComponent(i),window.open(o,"_system");case 9:case"end":return e.stop()}},e,this)}))}).catch(function(){});case 2:case"end":return e.stop()}},e)}))}},{key:"aesGcmEncrypt",value:function(e,t){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r,a,c,s,l,u,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=(new TextEncoder).encode(t),n.next=3,crypto.subtle.digest("SHA-256",i);case 3:return o=n.sent,r=crypto.getRandomValues(new Uint8Array(12)),a=Array.from(r).map(function(e){return String.fromCharCode(e)}).join(""),c={name:"AES-GCM",iv:r},n.next=9,crypto.subtle.importKey("raw",o,c,!1,["encrypt"]);case 9:return s=n.sent,l=(new TextEncoder).encode(e),n.next=13,crypto.subtle.encrypt(c,s,l);case 13:return u=n.sent,d=Array.from(new Uint8Array(u)).map(function(e){return String.fromCharCode(e)}).join(""),n.abrupt("return",btoa(a+d));case 16:case"end":return n.stop()}},n)}))}},{key:"aesGcmDecrypt",value:function(e,t){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r,a,c,s,l,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=(new TextEncoder).encode(t),n.next=3,crypto.subtle.digest("SHA-256",i);case 3:return o=n.sent,r=atob(e).slice(0,12),a={name:"AES-GCM",iv:new Uint8Array(Array.from(r).map(function(e){return e.charCodeAt(0)}))},n.next=8,crypto.subtle.importKey("raw",o,a,!1,["decrypt"]);case 8:return c=n.sent,s=atob(e).slice(12),l=new Uint8Array(Array.from(s).map(function(e){return e.charCodeAt(0)})),n.prev=11,n.next=14,crypto.subtle.decrypt(a,c,l);case 14:return u=n.sent,n.abrupt("return",(new TextDecoder).decode(u));case 18:throw n.prev=18,n.t0=n.catch(11),new Error("Decrypt failed");case 21:case"end":return n.stop()}},n,null,[[11,18]])}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.LFG(St.e),Z.LFG(Pe.c),Z.LFG(Le.W),Z.LFG(x.sK),Z.LFG(Oe.T))},e.\u0275prov=Z.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),At=a(37443);function _t(e,t){if(1&e&&(Z.TgZ(0,"ion-select-option",21),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e){var n=t.$implicit;Z.s9C("value",n),Z.xp6(1),Z.hij(" ",Z.lcZ(2,2,"app.commons.languages["+n+"].label")," ")}}function Mt(e,t){if(1&e&&(Z.TgZ(0,"ion-select-option",21),Z._uU(1),Z.qZA()),2&e){var n=t.$implicit;Z.s9C("value",n.id),Z.xp6(1),Z.hij(" ",n.price," ")}}function Tt(e,t){if(1&e&&(Z.TgZ(0,"ion-badge",22),Z._uU(1),Z.qZA()),2&e){var n=t.ngIf;Z.xp6(1),Z.Oqu(n)}}function Ot(e,t){1&e&&(Z.TgZ(0,"ion-label"),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.hij(" ",Z.lcZ(2,1,"app.component.more.dark-theme.label")," "))}function Pt(e,t){1&e&&(Z.TgZ(0,"ion-label"),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.hij(" ",Z.lcZ(2,1,"app.component.more.light-theme.label")," "))}function Lt(e,t){1&e&&(Z.TgZ(0,"ion-label"),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.hij(" ",Z.lcZ(2,1,"app.component.more.system-theme.label")," "))}var Dt=function(){var e=function(){function e(t,n,i,o,r,a,c){p(this,e),this.donateService=t,this.backupService=n,this.lookupService=i,this.popoverService=o,this.translateService=r,this.popoverController=a,this.actionSheetController=c,this.products=[],this.unsubscribe=new F.xQ}return d(e,[{key:"ngOnInit",value:function(){this.languages=this.translateService.getLangs(),this.products=this.donateService.getProducts(),this.settings=this.lookupService.settings,this.devices$=this.lookupService.subDeviceList().pipe((0,A.U)(function(e){var t;return null===(t=Object.keys(e).filter(function(t){return!e[t].room_id&&!t.includes("_")}))||void 0===t?void 0:t.length}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"applyZoom",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dismiss();case 2:this.lookupService.applyZoomFactor(),this.lookupService.setSettings(this.settings);case 4:case"end":return e.stop()}},e,this)}))}},{key:"onClickAddDevices",value:function(){this.popoverService.presentModal(et,!0),this.dismiss()}},{key:"onClickSearch",value:function(){this.popoverService.presentModal(tt.g,!0),this.dismiss()}},{key:"onClickUpdateDevices",value:function(){this.popoverService.presentModal(yt,!0),this.dismiss()}},{key:"onClickToggleTheme",value:function(){!0===this.settings.darkTheme?this.settings.darkTheme=!1:!1===this.settings.darkTheme?this.settings.darkTheme=void 0:null==this.settings.darkTheme&&(this.settings.darkTheme=!0),this.lookupService.setSettings(this.settings),this.lookupService.setDarkMode()}},{key:"onLangChange",value:function(e){this.translateService.use(e),this.settings.language=e,this.lookupService.setSettings(this.settings)}},{key:"onClickDonate",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ie.A.getInfo();case 2:if(t.t0=t.sent.platform,"android"!==t.t0){t.next=7;break}e.open(),t.next=8;break;case 7:window.open("https://github.com/digaus/shellyhome-i18n/blob/master/README.md","_system","location=yes");case 8:case"end":return t.stop()}},t)}))}},{key:"onClickReportError",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.writeErrorLog();case 2:case"end":return e.stop()}},e,this)}))}},{key:"onDonate",value:function(e){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e&&this.donateService.order(e),this.product=null;case 1:case"end":return t.stop()}},t,this)}))}},{key:"onClickBackup",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:this.translateService.instant("app.component.more.backup.header.label"),buttons:[{text:this.translateService.instant("app.component.more.backup-do.label"),icon:"arrow-redo",handler:function(){return(0,U.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.backupService.shareBackup();case 1:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.more.backup-load.label"),icon:"arrow-undo",handler:function(){return(0,U.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.loadBackup();case 2:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.more.cancel.label"),role:"cancel",icon:"close",handler:function(){console.log("Cancel clicked")}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"dismiss",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.popoverController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Zt.x),Z.Y36(It),Z.Y36(Le.W),Z.Y36(At.X),Z.Y36(x.sK),Z.Y36(m.Dh),Z.Y36(m.BX))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-more"]],decls:67,vars:52,consts:[[2,"display","none"],["slot","end",3,"okText","cancelText","ngModel","ngModelChange"],["langSelect",""],[3,"value",4,"ngFor","ngForOf"],["donateSelect",""],["mode","md","lines","none","button","","detail","false",3,"click"],["color","primary","name","wifi","slot","start"],["color","primary","name","search","slot","start"],["slot","end",4,"ngIf"],["color","primary","name","sync","slot","start"],["color","primary","name","mail","slot","start",2,"height","20px"],["color","primary","name","repeat","slot","start"],["color","primary","name","contrast","slot","start"],[4,"ngIf"],["color","primary","name","heart","slot","start"],["color","primary","name","globe","slot","start"],["mode","md","lines","none","detail","false"],[1,"zoomDiv"],["min","100","max","150",2,"padding","28px 0 0 0",3,"pin","ngModel","ngModelChange","touchend","mouseup"],["color","primary","name","remove-circle-outline","slot","start"],["color","primary","name","add-circle-outline","slot","end"],[3,"value"],["slot","end"]],template:function(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-item",0),Z.TgZ(1,"ion-label"),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.TgZ(4,"ion-select",1,2),Z.NdJ("ngModelChange",function(e){return t.settings.language=e})("ngModelChange",function(e){return t.onLangChange(e)}),Z.ALo(6,"translate"),Z.ALo(7,"translate"),Z.YNc(8,_t,3,4,"ion-select-option",3),Z.qZA(),Z.qZA(),Z.TgZ(9,"ion-item",0),Z.TgZ(10,"ion-label"),Z._uU(11),Z.ALo(12,"translate"),Z.qZA(),Z.TgZ(13,"ion-select",1,4),Z.NdJ("ngModelChange",function(e){return t.product=e})("ngModelChange",function(e){return t.onDonate(e)}),Z.ALo(15,"translate"),Z.ALo(16,"translate"),Z.YNc(17,Mt,2,2,"ion-select-option",3),Z.qZA(),Z.qZA(),Z.TgZ(18,"ion-list"),Z.TgZ(19,"ion-item",5),Z.NdJ("click",function(){return t.onClickAddDevices()}),Z._UZ(20,"ion-icon",6),Z.TgZ(21,"ion-label"),Z._uU(22),Z.ALo(23,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(24,"ion-item",5),Z.NdJ("click",function(){return t.onClickSearch()}),Z._UZ(25,"ion-icon",7),Z.TgZ(26,"ion-label"),Z._uU(27),Z.ALo(28,"translate"),Z.qZA(),Z.YNc(29,Tt,2,1,"ion-badge",8),Z.ALo(30,"async"),Z.qZA(),Z.TgZ(31,"ion-item",5),Z.NdJ("click",function(){return t.onClickUpdateDevices()}),Z._UZ(32,"ion-icon",9),Z.TgZ(33,"ion-label"),Z._uU(34),Z.ALo(35,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(36,"ion-item",5),Z.NdJ("click",function(){return t.onClickReportError()}),Z._UZ(37,"ion-icon",10),Z.TgZ(38,"ion-label"),Z._uU(39),Z.ALo(40,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(41,"ion-item",5),Z.NdJ("click",function(){return t.onClickBackup()}),Z._UZ(42,"ion-icon",11),Z.TgZ(43,"ion-label"),Z._uU(44),Z.ALo(45,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(46,"ion-item",5),Z.NdJ("click",function(){return t.onClickToggleTheme()}),Z._UZ(47,"ion-icon",12),Z.YNc(48,Ot,3,3,"ion-label",13),Z.YNc(49,Pt,3,3,"ion-label",13),Z.YNc(50,Lt,3,3,"ion-label",13),Z.qZA(),Z.TgZ(51,"ion-item",5),Z.NdJ("click",function(){Z.CHM(n);var e=Z.MAs(14);return t.onClickDonate(e)}),Z._UZ(52,"ion-icon",14),Z.TgZ(53,"ion-label"),Z._uU(54),Z.ALo(55,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(56,"ion-item",5),Z.NdJ("click",function(){return Z.CHM(n),Z.MAs(5).open()}),Z._UZ(57,"ion-icon",15),Z.TgZ(58,"ion-label"),Z._uU(59),Z.ALo(60,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(61,"ion-item",16),Z.TgZ(62,"div",17),Z._uU(63),Z.qZA(),Z.TgZ(64,"ion-range",18),Z.NdJ("ngModelChange",function(e){return t.settings.zoomFactor=e})("touchend",function(){return t.applyZoom()})("mouseup",function(){return t.applyZoom()}),Z._UZ(65,"ion-icon",19),Z._UZ(66,"ion-icon",20),Z.qZA(),Z.qZA(),Z.qZA()}2&e&&(Z.xp6(2),Z.Oqu(Z.lcZ(3,24,"app.component.more.language.label")),Z.xp6(2),Z.Q6J("okText",Z.lcZ(6,26,"app.commons.confirm.label"))("cancelText",Z.lcZ(7,28,"app.commons.cancel.label"))("ngModel",t.settings.language),Z.xp6(4),Z.Q6J("ngForOf",t.languages),Z.xp6(3),Z.Oqu(Z.lcZ(12,30,"app.component.more.donate.label")),Z.xp6(2),Z.Q6J("okText",Z.lcZ(15,32,"app.commons.confirm.label"))("cancelText",Z.lcZ(16,34,"app.commons.cancel.label"))("ngModel",t.product),Z.xp6(4),Z.Q6J("ngForOf",t.products),Z.xp6(5),Z.hij(" ",Z.lcZ(23,36,"app.component.more.add-devices.label")," "),Z.xp6(5),Z.hij(" ",Z.lcZ(28,38,"app.component.more.search-devices.label")," "),Z.xp6(2),Z.Q6J("ngIf",Z.lcZ(30,40,t.devices$)),Z.xp6(5),Z.hij(" ",Z.lcZ(35,42,"app.component.more.update-devices.label")," "),Z.xp6(5),Z.hij(" ",Z.lcZ(40,44,"app.component.more.report-error.label")," "),Z.xp6(5),Z.hij(" ",Z.lcZ(45,46,"app.component.more.backup.label")," "),Z.xp6(4),Z.Q6J("ngIf",!0===(null==t.settings?null:t.settings.darkTheme)),Z.xp6(1),Z.Q6J("ngIf",!1===(null==t.settings?null:t.settings.darkTheme)),Z.xp6(1),Z.Q6J("ngIf",null==(null==t.settings?null:t.settings.darkTheme)),Z.xp6(4),Z.Oqu(Z.lcZ(55,48,"app.component.more.donate.label")),Z.xp6(5),Z.hij("",Z.lcZ(60,50,"app.commons.languages["+(null==t.settings?null:t.settings.language)+"].label")," "),Z.xp6(4),Z.hij("",t.settings.zoomFactor||"100","%"),Z.xp6(1),Z.Q6J("pin",!0)("ngModel",t.settings.zoomFactor))},directives:[m.Ie,m.Q$,m.t9,m.QI,g.JJ,g.On,h.sg,m.q_,V.e,m.gu,h.O5,m.I_,m.n0,m.yp],pipes:[x.X$,h.Ov],styles:["ion-item[_ngcontent-%COMP%]:not(:last-child){height:38px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.md[_ngcontent-%COMP%]{margin-right:15px;margin-top:2px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.ios[_ngcontent-%COMP%]{margin-right:15px;margin-top:0}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-label.ios[_ngcontent-%COMP%]{margin-top:4px}ion-item[_ngcontent-%COMP%]:not(:last-child) > *[_ngcontent-%COMP%]{margin-top:-2px}ion-item[_ngcontent-%COMP%]:not(:last-child) > ion-badge[_ngcontent-%COMP%]{margin-top:-12px;border-radius:10px;padding-top:4px}ion-list.list-ios[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}  .md.more-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.more-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios .action-sheet-icon{position:absolute!important;left:10px}.zoomDiv[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(calc(-50% - 10px))}"],changeDetection:0}),e}(),Rt=a(65754),Jt=a(62411),Nt=a(46662),qt=a(3001),Ut=function(){var e=function(){function e(t){p(this,e),this.lookupService=t}return d(e,[{key:"transform",value:function(e){return this.lookupService.subRoomList().pipe((0,A.U)(function(t){return t[e]}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Le.W,16))},e.\u0275pipe=Z.Yjl({name:"room",type:e,pure:!0}),e}(),$t=function(){var e=function(){function e(t){p(this,e),this.lookupService=t}return d(e,[{key:"transform",value:function(e){return this.lookupService.subGroupList().pipe((0,A.U)(function(t){return t[e]}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Le.W,16))},e.\u0275pipe=Z.Yjl({name:"group",type:e,pure:!0}),e}(),Ft=["slides"];function Qt(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-fab-button",24),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(2).removeDashboard()}),Z._UZ(1,"ion-icon",25),Z.qZA()}}function Gt(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-fab-button",26),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(2).editDashboard()}),Z._UZ(1,"ion-icon",27),Z.qZA()}}function Yt(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-fab-button",29),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(3).slideLeft()}),Z._UZ(1,"ion-icon",30),Z.qZA()}}function Bt(e,t){if(1&e&&(Z.TgZ(0,"ion-fab",14),Z.YNc(1,Yt,2,0,"ion-fab-button",28),Z.qZA()),2&e){var n=Z.oxw(2);Z.xp6(1),Z.Q6J("ngIf",!n.reorder)}}function Et(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-fab-button",29),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(3).slideRight()}),Z._UZ(1,"ion-icon",31),Z.qZA()}}function jt(e,t){if(1&e&&(Z.TgZ(0,"ion-fab",16),Z.YNc(1,Et,2,0,"ion-fab-button",28),Z.qZA()),2&e){var n=Z.oxw(2);Z.xp6(1),Z.Q6J("ngIf",!n.reorder)}}function Ht(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-slide",32),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw(2).addDashboard()}),Z.TgZ(1,"ion-title",33),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.qZA()}2&e&&(Z.xp6(2),Z.hij(" ",Z.lcZ(3,1,"app.component.dashboard.empty-list.label")," "))}function zt(e,t){1&e&&(Z.TgZ(0,"ion-title",33),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()),2&e&&(Z.xp6(1),Z.hij(" ",Z.lcZ(2,1,"app.component.dashboard.empty.label")," "))}function Vt(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-fab-button",43),Z.NdJ("click",function(){Z.CHM(n);var e=Z.oxw().index,t=Z.oxw().index,i=Z.oxw(2).index;return Z.oxw(2).removeElement(i,t,e)}),Z._UZ(1,"ion-icon",44),Z.qZA()}}function Wt(e,t){1&e&&(Z.TgZ(0,"div",51),Z._UZ(1,"ion-icon",52),Z._UZ(2,"div"),Z.qZA())}function Xt(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"div",53),Z.TgZ(1,"ion-fab-button",54),Z.NdJ("click",function(){var e=Z.CHM(n).$implicit,t=Z.oxw(3).index,i=Z.oxw().index,o=Z.oxw(2).index;return Z.oxw(2).customizeElement(o,i,t,e)}),Z._UZ(2,"ion-icon",55),Z.qZA(),Z.qZA()}}var Kt=function(){return["open","graph"]};function en(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"app-device",47,48),Z.NdJ("dashboardSettingsChange",function(e){var t=Z.CHM(n).ngIf;return Z.oxw(2).$implicit.devices[null==t||null==t.device?null:t.device.id]=e})("dashboardSettingsChange",function(){return Z.CHM(n),Z.oxw(7).saveSettings()}),Z.ALo(2,"async"),Z.YNc(3,Wt,3,0,"div",49),Z.YNc(4,Xt,3,0,"ng-template",null,50,Z.W1O),Z.qZA()}if(2&e){var i=t.ngIf,o=Z.MAs(1),r=Z.oxw(2).$implicit,a=Z.oxw(5);Z.Q6J("allow",Z.DdM(9,Kt))("ping",Z.lcZ(2,7,o.isInView))("deviceInfo",i)("dashboardSettings",r.devices[null==i||null==i.device?null:i.device.id])("showDetails",!1)("reorder",a.reorder),Z.xp6(3),Z.Q6J("ngIf",a.reorder)}}function tn(e,t){if(1&e&&(Z.TgZ(0,"ion-card",45),Z.YNc(1,en,6,10,"app-device",46),Z.ALo(2,"async"),Z.ALo(3,"deviceInfo"),Z.qZA()),2&e){var n=Z.oxw().$implicit;Z.xp6(1),Z.Q6J("ngIf",Z.lcZ(2,1,Z.lcZ(3,3,n.key)))}}function nn(e,t){1&e&&(Z.TgZ(0,"div",51),Z._UZ(1,"ion-icon",52),Z._UZ(2,"div"),Z.qZA())}function on(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"div",53),Z.TgZ(1,"ion-fab-button",54),Z.NdJ("click",function(){var e=Z.CHM(n).$implicit,t=Z.oxw(3).index,i=Z.oxw().index,o=Z.oxw(2).index;return Z.oxw(2).customizeElement(o,i,t,e)}),Z._UZ(2,"ion-icon",55),Z.qZA(),Z.qZA()}}var rn=function(){return[]};function an(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"app-room",58,48),Z.NdJ("dashboardSettingsChange",function(e){return Z.CHM(n),Z.oxw(2).$implicit.devices=e})("dashboardSettingsChange",function(){return Z.CHM(n),Z.oxw(7).saveSettings()})("select",function(){Z.CHM(n);var e=Z.oxw(2).index,t=Z.oxw().index,i=Z.oxw(2).index;return Z.oxw(2).collapsedChanged(i,t,e)})("controlButtonsChange",function(){Z.CHM(n);var e=Z.oxw(2).index,t=Z.oxw().index,i=Z.oxw(2).index;return Z.oxw(2).controlButtonsChanged(i,t,e)}),Z.ALo(2,"async"),Z.YNc(3,nn,3,0,"div",49),Z.YNc(4,on,3,0,"ng-template",null,59,Z.W1O),Z.qZA()}if(2&e){var i=t.ngIf,o=Z.MAs(1),r=Z.oxw(2).$implicit,a=Z.oxw(5);Z.ekj("collapsed",r.collapsed)("not-collapsed",!r.collapsed),Z.Q6J("ping",Z.lcZ(2,12,o.isInView))("room",i)("allow",Z.DdM(14,rn))("reorder",a.reorder)("collapsed",r.collapsed)("dashboardSettings",r.devices)("controlButtons",r.controlButtons),Z.xp6(3),Z.Q6J("ngIf",a.reorder)}}function cn(e,t){if(1&e&&(Z.TgZ(0,"div",56),Z.YNc(1,an,6,15,"app-room",57),Z.ALo(2,"async"),Z.ALo(3,"room"),Z.qZA()),2&e){var n=Z.oxw().$implicit;Z.xp6(1),Z.Q6J("ngIf",Z.lcZ(2,1,Z.lcZ(3,3,n.key)))}}function sn(e,t){1&e&&(Z.TgZ(0,"div",51),Z._UZ(1,"ion-icon",52),Z._UZ(2,"div"),Z.qZA())}function ln(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"div",53),Z.TgZ(1,"ion-fab-button",54),Z.NdJ("click",function(){var e=Z.CHM(n).$implicit,t=Z.oxw(3).index,i=Z.oxw().index,o=Z.oxw(2).index;return Z.oxw(2).customizeElement(o,i,t,e)}),Z._UZ(2,"ion-icon",55),Z.qZA(),Z.qZA()}}function un(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"app-group",61,48),Z.NdJ("dashboardSettingsChange",function(e){return Z.CHM(n),Z.oxw(2).$implicit.devices=e})("dashboardSettingsChange",function(){return Z.CHM(n),Z.oxw(7).saveSettings()})("select",function(){Z.CHM(n);var e=Z.oxw(2).index,t=Z.oxw().index,i=Z.oxw(2).index;return Z.oxw(2).collapsedChanged(i,t,e)})("controlButtonsChange",function(){Z.CHM(n);var e=Z.oxw(2).index,t=Z.oxw().index,i=Z.oxw(2).index;return Z.oxw(2).controlButtonsChanged(i,t,e)}),Z.ALo(2,"async"),Z.YNc(3,sn,3,0,"div",49),Z.YNc(4,ln,3,0,"ng-template",null,62,Z.W1O),Z.qZA()}if(2&e){var i=t.ngIf,o=Z.MAs(1),r=Z.oxw(2).$implicit,a=Z.oxw(5);Z.ekj("collapsed",r.collapsed)("not-collapsed",!r.collapsed),Z.Q6J("ping",Z.lcZ(2,12,o.isInView))("group",i)("allow",Z.DdM(14,rn))("reorder",a.reorder)("collapsed",r.collapsed)("dashboardSettings",r.devices)("controlButtons",r.controlButtons),Z.xp6(3),Z.Q6J("ngIf",a.reorder)}}function dn(e,t){if(1&e&&(Z.TgZ(0,"div",56),Z.YNc(1,un,6,15,"app-group",60),Z.ALo(2,"async"),Z.ALo(3,"group"),Z.qZA()),2&e){var n=Z.oxw().$implicit;Z.xp6(1),Z.Q6J("ngIf",Z.lcZ(2,1,Z.lcZ(3,3,n.key)))}}function pn(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"div",39),Z.NdJ("cdkDragStarted",function(){return Z.CHM(n),Z.oxw(5).onDragStart()}),Z.YNc(1,Vt,2,0,"ion-fab-button",40),Z.YNc(2,tn,4,5,"ion-card",41),Z.YNc(3,cn,4,5,"div",42),Z.YNc(4,dn,4,5,"div",42),Z.qZA()}if(2&e){var i=t.$implicit,o=Z.oxw(5);Z.Q6J("cdkDragData",i)("cdkDragDisabled",!o.reorder),Z.xp6(1),Z.Q6J("ngIf",o.reorder),Z.xp6(1),Z.Q6J("ngIf","device"===i.type),Z.xp6(1),Z.Q6J("ngIf","room"===i.type),Z.xp6(1),Z.Q6J("ngIf","group"===i.type)}}function vn(e,t){if(1&e){var n=Z.EpF();Z.TgZ(0,"ion-col",36),Z.NdJ("cdkDropListDropped",function(e){return Z.CHM(n),Z.oxw(4).drop(e)})("click",function(){var e=Z.CHM(n).$implicit,t=Z.oxw(4);return null!=e&&e.length?null:t.onClickAdd()}),Z.ALo(1,"dropListConnected"),Z.ALo(2,"async"),Z.ALo(3,"async"),Z.YNc(4,zt,3,3,"ion-title",37),Z.YNc(5,pn,5,6,"div",38),Z.qZA()}if(2&e){var i=t.$implicit,o=t.index,r=Z.oxw(2).$implicit,a=Z.oxw(2);Z.Udp("width",100/r.cols.length+"%"),Z.Q6J("cdkDropListData",i)("cdkDropListConnectedTo",Z.xi3(1,8,r.cols,Z.lcZ(2,11,a.currentSlide$)))("id","dashboard"+Z.lcZ(3,13,a.currentSlide$)+"Col"+o),Z.xp6(4),Z.Q6J("ngIf",!(null!=i&&i.length)),Z.xp6(1),Z.Q6J("ngForOf",i)("ngForTrackBy",a.identify)}}function fn(e,t){if(1&e&&(Z.TgZ(0,"ion-row"),Z.YNc(1,vn,6,15,"ion-col",35),Z.qZA()),2&e){var n=Z.oxw().$implicit,i=Z.oxw(2);Z.xp6(1),Z.Q6J("ngForOf",n.cols)("ngForTrackBy",i.identifyIndex)}}function hn(e,t){if(1&e&&(Z.TgZ(0,"ion-slide"),Z.TgZ(1,"ion-grid",34),Z.TgZ(2,"ion-list"),Z.YNc(3,fn,2,2,"ion-row",0),Z.ALo(4,"async"),Z.qZA(),Z.qZA(),Z.qZA()),2&e){var n=t.index,i=Z.oxw(2);Z.xp6(3),Z.Q6J("ngIf",Z.lcZ(4,1,i.currentSlide$)===n)}}function gn(e,t){if(1&e){var n=Z.EpF();Z.ynx(0),Z.TgZ(1,"ion-header",1),Z.TgZ(2,"ion-toolbar"),Z.TgZ(3,"ion-buttons",2),Z.TgZ(4,"ion-menu-button",3),Z._UZ(5,"ion-icon",4),Z.qZA(),Z.TgZ(6,"ion-button",5),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw().selectUser()}),Z.ALo(7,"async"),Z._UZ(8,"ion-icon",6),Z.qZA(),Z.qZA(),Z.TgZ(9,"ion-title",7),Z._uU(10,"Dashboard"),Z.qZA(),Z.TgZ(11,"ion-buttons",8),Z.TgZ(12,"ion-button",9),Z.NdJ("click",function(){Z.CHM(n);var e=Z.MAs(28),t=Z.oxw();return t.reorder=!t.reorder,null==e?null:e.lockSwipes(t.reorder)}),Z._UZ(13,"ion-icon",10),Z.qZA(),Z.TgZ(14,"ion-button",5),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw().onClickAdd()}),Z._UZ(15,"ion-icon",11),Z.qZA(),Z.TgZ(16,"ion-button",5),Z.NdJ("click",function(e){return Z.CHM(n),Z.oxw().presentPopover(e)}),Z._UZ(17,"ion-icon",12),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(18,"ion-content",13),Z.TgZ(19,"ion-fab",14),Z.YNc(20,Qt,2,0,"ion-fab-button",15),Z.qZA(),Z.TgZ(21,"ion-fab",16),Z.YNc(22,Gt,2,0,"ion-fab-button",17),Z.qZA(),Z.YNc(23,Bt,2,1,"ion-fab",18),Z.ALo(24,"async"),Z.YNc(25,jt,2,1,"ion-fab",19),Z.ALo(26,"async"),Z.TgZ(27,"ion-slides",20,21),Z.NdJ("ionSlideDidChange",function(){return Z.CHM(n),Z.oxw().slidesDidChange()}),Z.YNc(29,Ht,4,3,"ion-slide",22),Z.YNc(30,hn,5,3,"ion-slide",23),Z.qZA(),Z.qZA(),Z.BQk()}if(2&e){var i=t.ngIf,o=Z.oxw();Z.xp6(4),Z.Q6J("menu","first"),Z.xp6(2),Z.Q6J("disabled",o.reorder||"connecting"===Z.lcZ(7,12,o.cloudStatus$)),Z.xp6(7),Z.Q6J("name",o.reorder?"checkmark-done-sharp":"create-outline"),Z.xp6(1),Z.Q6J("disabled",o.reorder),Z.xp6(2),Z.Q6J("disabled",o.reorder),Z.xp6(4),Z.Q6J("ngIf",o.reorder),Z.xp6(2),Z.Q6J("ngIf",o.reorder),Z.xp6(1),Z.Q6J("ngIf",Z.lcZ(24,14,o.currentSlide$)>0),Z.xp6(2),Z.Q6J("ngIf",(null==i?null:i.length)-1>Z.lcZ(26,16,o.currentSlide$)),Z.xp6(2),Z.Q6J("options",o.slideConfig),Z.xp6(2),Z.Q6J("ngIf",!(null!=i&&i.length)),Z.xp6(1),Z.Q6J("ngForOf",i)}}var mn=[{path:"",component:function(){var e=function(){function e(t,n,i,o,r,a,c,s,l){p(this,e),this.renderer2=t,this.authService=n,this.alertService=i,this.lookupService=o,this.modalController=r,this.translateService=a,this.deviceInfoService=c,this.popoverController=s,this.actionSheetController=l,this.slideConfig={slidesPerView:1,centeredSlides:!0},this.currentSlide$=new le.X(0)}return d(e,[{key:"ngOnInit",value:function(){var e=this;re.g.addListener("appStateChange",function(t){t.isActive&&e.slides.update()}),ae.c.hide(),ce.K.set({key:Rt.Q.welcome,value:"done"}),this.deviceInfoService.init(),this.dashboardList$=this.lookupService.subDashboardList().pipe((0,A.U)(function(e){return e.forEach(function(e){return e.cols.forEach(function(e){return e.forEach(function(e){e.devices=e.devices||{},e.collapsed=e.collapsed||!1,e.controlButtons=e.controlButtons||!1})})}),e}),(0,I.b)(function(t){var n;t[e.currentSlide$.value]||null===(n=e.slides)||void 0===n||n.slideTo(0)})),this.cloudStatus$=this.authService.cloudStatus.asObservable()}},{key:"selectUser",value:function(){var e,t;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!((null===(t=null===(e=this.lookupService.userList)||void 0===e?void 0:e.users)||void 0===t?void 0:t.length)>0)){n.next=13;break}return n.next=3,this.alertService.selectUser(this.lookupService.userList);case 3:if(!(i=n.sent)){n.next=11;break}return this.lookupService.selectUser(i),o=[ce.K.set({key:Rt.Q.email,value:i.email}),ce.K.set({key:Rt.Q.password,value:i.password})],n.next=9,Promise.all(o);case 9:return n.next=11,this.authService.login(null,null);case 11:n.next=17;break;case 13:return n.next=15,this.modalController.create({component:Se.b});case 15:return n.next=17,n.sent.present();case 17:case"end":return n.stop()}},n,this)}))}},{key:"removeElement",value:function(e,t,n){this.lookupService.dashboardList[e].cols[t].splice(n,1),this.lookupService.setDashboardList(this.lookupService.dashboardList)}},{key:"customizeElement",value:function(e,t,n,i){var o,r,a,c;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function s(){var l,u;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.modalController.create({component:we,cssClass:"dashboardModal",componentProps:{deviceId:i,selectedLayout:null===(a=null===(r=null===(o=this.lookupService.dashboardList[e].cols[t][n])||void 0===o?void 0:o.devices)||void 0===r?void 0:r[i])||void 0===a?void 0:a.layout}});case 2:return l=s.sent,s.next=5,l.present();case 5:return s.next=7,l.onWillDismiss();case 7:(u=s.sent).data&&(this.lookupService.dashboardList[e].cols[t][n].devices[i]=Object.assign(Object.assign({},this.lookupService.dashboardList[e].cols[t][n].devices[i]),{layout:null===(c=u.data)||void 0===c?void 0:c.selectedLayout}),this.lookupService.dashboardList[e].cols[t][n]=(0,se.cloneDeep)(this.lookupService.dashboardList[e].cols[t][n]),this.lookupService.setDashboardList(this.lookupService.dashboardList));case 9:case"end":return s.stop()}},s,this)}))}},{key:"collapsedChanged",value:function(e,t,n){this.lookupService.dashboardList[e].cols[t][n].collapsed=!this.lookupService.dashboardList[e].cols[t][n].collapsed,this.lookupService.setDashboardList(this.lookupService.dashboardList)}},{key:"controlButtonsChanged",value:function(e,t,n){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,ue.V)(1);case 2:this.lookupService.dashboardList[e].cols[t][n].controlButtons=!this.lookupService.dashboardList[e].cols[t][n].controlButtons,this.lookupService.setDashboardList(this.lookupService.dashboardList);case 4:case"end":return i.stop()}},i,this)}))}},{key:"saveSettings",value:function(){this.lookupService.setDashboardList(this.lookupService.dashboardList),this.lookupService.setSettings(this.lookupService.settings)}},{key:"presentPopover",value:function(e){var t;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.popoverController.create({component:Dt,event:e,cssClass:"more-popover",translucent:!1,showBackdrop:!0});case 2:return i=n.sent,n.next=5,i.present();case 5:return n.next=7,i.onDidDismiss();case 7:return n.next=9,(0,ue.V)(200);case 9:null===(t=this.slides)||void 0===t||t.update();case 10:case"end":return n.stop()}},n,this)}))}},{key:"slideLeft",value:function(){this.slides.slidePrev()}},{key:"slideRight",value:function(){this.slides.slideNext()}},{key:"addDashboard",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertService.addDashboard();case 2:if(!(t=e.sent).cols){e.next=10;break}return n=Array.from({length:t.cols}).map(function(){return[]}),this.lookupService.dashboardList.push({cols:n}),this.lookupService.setDashboardList(this.lookupService.dashboardList),e.next=9,(0,ue.V)(200);case 9:this.slides.slideTo(this.lookupService.dashboardList.length+1);case 10:case"end":return e.stop()}},e,this)}))}},{key:"editDashboard",value:function(){var e;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertService.addDashboard(null===(e=this.lookupService.dashboardList[this.currentSlide$.value].cols)||void 0===e?void 0:e.length);case 2:(n=t.sent).cols&&(console.log(),i=Array.from({length:n.cols}).map(function(e,t){return o.lookupService.dashboardList[o.currentSlide$.value].cols[t]||[]}),this.lookupService.dashboardList[this.currentSlide$.value].cols=i,this.lookupService.setDashboardList(this.lookupService.dashboardList));case 4:case"end":return t.stop()}},t,this)}))}},{key:"drop",value:function(e){e.previousContainer===e.container?(0,v.bA)(e.container.data,e.previousIndex,e.currentIndex):(0,v.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.lookupService.setDashboardList(this.lookupService.dashboardList)}},{key:"identifyIndex",value:function(e,t){return e}},{key:"identify",value:function(e,t){var n=Object.keys(t.devices).map(function(e){return t.devices[e].layout}).join(",");return t.key+t.type+n}},{key:"onDragStart",value:function(){this.renderer2.setStyle(document.getElementsByClassName("cdk-drag-placeholder")[0],"height",document.getElementsByClassName("cdk-drag-preview")[0].clientHeight+"px")}},{key:"slidesDidChange",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.slides.getActiveIndex();case 2:return t=e.sent,e.next=5,(0,ue.V)(100);case 5:this.currentSlide$.next(t);case 6:case"end":return e.stop()}},e,this)}))}},{key:"removeDashboard",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.reorder=!1,e.next=3,this.slides.lockSwipes(!1);case 3:if(this.lookupService.dashboardList.splice(this.currentSlide$.value,1),this.lookupService.dashboardList=t(this.lookupService.dashboardList),this.lookupService.setDashboardList(this.lookupService.dashboardList),!(this.currentSlide$.value>=1)){e.next=11;break}return e.next=9,this.slides.slideTo(this.currentSlide$.value-1);case 9:e.next=15;break;case 11:if(e.t0=this.lookupService.dashboardList.length>1,!e.t0){e.next=15;break}return e.next=15,this.slides.slideTo(0);case 15:case"end":return e.stop()}},e,this)}))}},{key:"onClickAdd",value:function(){var e,t,n,i,o,r;return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function a(){var c=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.actionSheetController.create({mode:"ios",header:this.translateService.instant("app.component.dashboard.edit.header.label"),buttons:[{cssClass:(null===(t=null===(e=this.lookupService)||void 0===e?void 0:e.dashboardList)||void 0===t?void 0:t.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-device.header.label"),icon:"cog-outline",handler:function(){return(0,U.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openDevices();case 1:case"end":return e.stop()}},e,this)}))}},{cssClass:(null===(i=null===(n=this.lookupService)||void 0===n?void 0:n.dashboardList)||void 0===i?void 0:i.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-room.header.label"),icon:"home-outline",handler:function(){return(0,U.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openRooms();case 1:case"end":return e.stop()}},e,this)}))}},{cssClass:(null===(r=null===(o=this.lookupService)||void 0===o?void 0:o.dashboardList)||void 0===r?void 0:r.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-group.header.label"),icon:"copy-outline",handler:function(){return(0,U.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openGroups();case 1:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.dashboard.add-dashboard.header.label"),icon:"duplicate-outline",handler:function(){return(0,U.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.addDashboard();case 1:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.dashboard.cancel.header.label"),role:"cancel",icon:"close",handler:function(){}}]});case 2:return a.next=4,a.sent.present();case 4:case"end":return a.stop()}},a,this)}))}},{key:"openRooms",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ce.g,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"openGroups",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:Ze.B,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"openDevices",value:function(){return(0,U.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:ye.Z,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Z.Y36(Z.Qsj),Z.Y36(St.e),Z.Y36(Pe.c),Z.Y36(Le.W),Z.Y36(m.IN),Z.Y36(x.sK),Z.Y36(he.H),Z.Y36(m.Dh),Z.Y36(m.BX))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-dashboard"]],viewQuery:function(e,t){var n;(1&e&&(Z.Gf(Ft,5),Z.Gf(m.W2,5)),2&e)&&(Z.iGM(n=Z.CRH())&&(t.slides=n.first),Z.iGM(n=Z.CRH())&&(t.ionContents=n))},decls:2,vars:3,consts:[[4,"ngIf"],["translucent","true",1,"ion-no-border"],["slot","start"],["color","primary",3,"menu"],["slot","icon-only","name","menu-outline"],["color","primary",3,"disabled","click"],["slot","icon-only","name","people-outline",2,"transform","scaleX(-1)"],["color","primary"],["slot","end"],["color","primary",3,"click"],["slot","icon-only",3,"name"],["slot","icon-only","name","add"],["slot","icon-only","md","ellipsis-vertical-outline","ios","ellipsis-horizontal-outline"],[2,"--overflow","hidden"],["mode","md","vertical","bottom","horizontal","start","slot","fixed"],["size","small","color","danger",3,"click",4,"ngIf"],["mode","md","vertical","bottom","horizontal","end","slot","fixed"],["size","small","color","success",3,"click",4,"ngIf"],["mode","md","vertical","bottom","horizontal","start","slot","fixed",4,"ngIf"],["mode","md","vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["pager","true",3,"options","ionSlideDidChange"],["slides",""],["style","height: calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top));",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["size","small","color","danger",3,"click"],["name","trash-outline"],["size","small","color","success",3,"click"],["name","create-outline"],["class","slideFab","size","small","color","transparent",3,"click",4,"ngIf"],["size","small","color","transparent",1,"slideFab",3,"click"],["name","chevron-back-outline"],["name","chevron-forward-outline"],[2,"height","calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top))",3,"click"],["mode","ios",1,"empty"],["cdkScrollable","","scroll-events","",1,"scrollContent"],["class","dashboardCol","cdkDropList","",3,"width","cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDropList","",1,"dashboardCol",3,"cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click"],["mode","ios","class","empty",4,"ngIf"],["class","dragElement","cdkDrag","",3,"cdkDragData","cdkDragDisabled","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dragElement",3,"cdkDragData","cdkDragDisabled","cdkDragStarted"],["class","remove","color","danger",3,"click",4,"ngIf"],["class","card",4,"ngIf"],["class","wrapper",4,"ngIf"],["color","danger",1,"remove",3,"click"],["name","close",1,"remove-icon"],[1,"card"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange",4,"ngIf"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange"],["inView","inView"],["cdkDragHandle","",4,"ngIf"],["customize",""],["cdkDragHandle",""],["name","move-outline"],[1,"controlButton"],["color","success","fill","clear","size","small",1,"smallFab",3,"click"],["name","settings-outline"],[1,"wrapper"],["inView","",3,"ping","room","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","room","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeRoom",""],["inView","",3,"ping","group","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","group","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeGroup",""]],template:function(e,t){1&e&&(Z.YNc(0,gn,31,18,"ng-container",0),Z.ALo(1,"async")),2&e&&Z.Q6J("ngIf",Z.lcZ(1,1,t.dashboardList$))},directives:[h.O5,m.Gu,m.sr,m.Sm,m.fG,m.gu,m.YG,m.wd,m.W2,m.IJ,V.e,m.Hr,h.sg,m.W4,m.A$,m.jY,f.PQ,m.q_,m.Nd,m.wI,v.Wj,v.Zt,m.PM,ge.v,me.z,v.Bh,Jt.Y,Nt.m],pipes:[h.Ov,x.X$,qt.j,ne.B,Ut,$t],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-background-color)}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center}ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{background:var(--ion-background-color)}[_nghost-%COMP%]{background:#fff;background:var(--ion-background-color, #fff)}[_nghost-%COMP%]     app-device   .reorderLabel   p{padding-right:134px}  .header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.add[_ngcontent-%COMP%]{height:3px;width:calc(50% - 75px);top:50%;position:absolute;max-width:200px}.add.right[_ngcontent-%COMP%]{left:calc(50% + 50px);background:linear-gradient(to left,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.add.left[_ngcontent-%COMP%]{right:calc(50% + 50px);background:linear-gradient(to right,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.addText[_ngcontent-%COMP%]{width:100%;color:var(--ion-color-primary);top:calc(50% - 75px);position:absolute;left:0;text-align:center}  .swiper-pagination{position:fixed!important;pointer-events:none}.scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 57px - var(--ion-safe-area-bottom));overflow-y:auto;width:100%}.ios[_ngcontent-%COMP%]   .scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 44px - var(--ion-safe-area-bottom))}.card[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item{border-radius:4px}.card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item::part(native){box-shadow:#0003 0 3px 1px -2px,#00000024 0 2px 2px,#0000001f 0 1px 5px;-webkit-font-smoothing:antialiased;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragElement[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{font-size:31px;position:absolute;right:11px;top:11px;z-index:1;background:var(--ion-color-base)}.cdk-drag-handle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;top:0;left:0}.dragElement[_ngcontent-%COMP%]{position:relative;margin:15px 5px}.dragElement[_ngcontent-%COMP%]:last-child{margin-bottom:calc(50px + var(--ion-safe-area-bottom))}.slideFab[_ngcontent-%COMP%]{--box-shadow: none;--ion-color-base: none !important;--ion-color-contrast: var(--ion-color-primary) !important}  .ios .action-sheet-icon{position:absolute!important;left:10px}ion-fab-button.remove[_ngcontent-%COMP%]{position:absolute;transform:scale(.6);z-index:2;opacity:.8;bottom:-16px;left:calc(50% - 16px);width:35px;height:35px}  .disabledAction{pointer-events:none;opacity:.5}.ios[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 64px - var(--ion-safe-area-bottom))}.md[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 70px - var(--ion-safe-area-bottom))}ion-slide[_ngcontent-%COMP%], ion-grid[_ngcontent-%COMP%], ion-list[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%]{padding-top:0}.controlButton[_ngcontent-%COMP%]{margin-right:-5px;width:45px;display:block;height:40px;padding-top:.1px;position:absolute;right:46px;top:5px;z-index:10}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]::part(native){background:transparent;box-shadow:none}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]{margin:3px 3px 3px 5.5px;margin-right:0!important;height:34px;width:34px;opacity:.7;--ion-color-contrast: var(--ion-color-base) !important}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{transform:scale(.8)}"],changeDetection:0}),e}()}],xn=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[oe.Bz.forChild(mn)],oe.Bz]}),e}(),bn=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[h.ez,g.u5,m.Pc,q,ie,v._t,f.Cl,x.aw,xn]]}),e}()}}])}();