"use strict";(self.webpackChunkShellyHome=self.webpackChunkShellyHome||[]).push([[3495],{83495:function(e,t,i){i.r(t),i.d(t,{DashboardPageModule:function(){return oi}});var n=i(77310),o=i(1275),s=i(38583),r=i(3679),c=i(92859),l=i(29790),a=i(51095),d=i(7539),p=i(43220),u=i(98295),h=i(37716),v=i(72458),g=(i(39490),i(25917)),m=(i(40205),i(35758),i(75319),i(93342)),f=i(88002),y=(i(5304),i(68939),i(18819),i(15257)),b=i(91841),x=i(39075);let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[v.BQ],v.BQ]}),e})();var k=i(49983),Z=i(4885),C=i(67441);i(36461),i(46237),i(80521),i(4765),i(70946);let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[s.ez,v.BQ],v.BQ]}),e})();var I=i(75721),_=i(69129);let A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[s.ez]]}),e})();var M=i(64762),T=i(79765),O=i(54395),P=i(87519),L=i(43190),D=i(46782),J=i(28049),N=i(22557),U=i(59353),q=i(27773),F=i(16873);function Q(e,t){if(1&e&&(h.TgZ(0,"ion-item",9),h.TgZ(1,"ion-row",10),h._UZ(2,"ion-col"),h.TgZ(3,"ion-col",11),h._uU(4),h.qZA(),h._UZ(5,"ion-col",12),h.qZA(),h.qZA()),2&e){const e=h.oxw(2);h.xp6(4),h.hij(" ",null==e.deviceInfo||null==e.deviceInfo.deviceStatus||null==e.deviceInfo.deviceStatus.lights[null==e.deviceInfo||null==e.deviceInfo.device?null:e.deviceInfo.device.channel]?null:e.deviceInfo.deviceStatus.lights[null==e.deviceInfo||null==e.deviceInfo.device?null:e.deviceInfo.device.channel].gain," % ")}}function G(e,t){if(1&e&&(h.TgZ(0,"ion-item",9),h.TgZ(1,"ion-row",10),h._UZ(2,"ion-col"),h.TgZ(3,"ion-col",11),h._uU(4),h.qZA(),h._UZ(5,"ion-col",12),h.qZA(),h.qZA()),2&e){const e=h.oxw(2);h.xp6(4),h.hij(" ",((null==e.deviceInfo||null==e.deviceInfo.deviceStatus||null==e.deviceInfo.deviceStatus.lights[null==e.deviceInfo||null==e.deviceInfo.device?null:e.deviceInfo.device.channel]?null:e.deviceInfo.deviceStatus.lights[null==e.deviceInfo||null==e.deviceInfo.device?null:e.deviceInfo.device.channel].white)/2.55).toFixed(0)," % ")}}function Y(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-item",1),h.NdJ("touchstart",function(){return h.CHM(e),h.oxw().touch(!0)})("mousedown",function(){return h.CHM(e),h.oxw().mouse(!0)})("touchend",function(){return h.CHM(e),h.oxw().touch(!1)})("mouseup",function(){return h.CHM(e),h.oxw().mouse(!1)}),h._UZ(2,"input",2),h.qZA(),h.YNc(3,Q,6,1,"ion-item",3),h.TgZ(4,"ion-item",4),h.TgZ(5,"ion-range",5),h.NdJ("touchstart",function(){return h.CHM(e),h.oxw().touch(!0)})("mousedown",function(){return h.CHM(e),h.oxw().mouse(!0)})("touchend",function(){return h.CHM(e),h.oxw().touch(!1)})("mouseup",function(){return h.CHM(e),h.oxw().mouse(!1)}),h._UZ(6,"ion-icon",6),h._UZ(7,"ion-icon",7),h.qZA(),h.qZA(),h.YNc(8,G,6,1,"ion-item",3),h.TgZ(9,"ion-item",8),h.TgZ(10,"ion-range",5),h.NdJ("touchstart",function(){return h.CHM(e),h.oxw().touch(!0)})("mousedown",function(){return h.CHM(e),h.oxw().mouse(!0)})("touchend",function(){return h.CHM(e),h.oxw().touch(!1)})("mouseup",function(){return h.CHM(e),h.oxw().mouse(!1)}),h._UZ(11,"ion-icon",6),h._UZ(12,"ion-icon",7),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=h.oxw();h.xp6(3),h.Q6J("ngIf",e.showCurrent),h.xp6(1),h.Udp("margin-top",e.showCurrent?"-40px":"-20px"),h.xp6(1),h.Q6J("formControl",e.formControlGain),h.xp6(3),h.Q6J("ngIf",e.showCurrent),h.xp6(1),h.Udp("margin-top",e.showCurrent?"-40px":"-20px"),h.xp6(1),h.Q6J("formControl",e.formControlWhite)}}let E=(()=>{class e{constructor(e,t,i){this.elementRef=e,this.localService=t,this.deviceService=i,this.showCurrent=!0,this.formControlGain=new r.NI(null,null,this.onLightGainValidatorFn()),this.formControlWhite=new r.NI(null,null,this.onLightWhiteValidatorFn()),this.color=new T.xQ,this.unsubscribe=new T.xQ}ngOnChanges(){var e,t,i,n,o,s,r,c,l,a,d,p,u,h;if(!this.dragging&&!this.mousedown&&(null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights)){this.formControlGain.setValue(null===(s=null===(n=null===(i=this.deviceInfo)||void 0===i?void 0:i.deviceStatus)||void 0===n?void 0:n.lights[null===(o=this.deviceInfo)||void 0===o?void 0:o.device.channel])||void 0===s?void 0:s.gain,{emitEvent:!1}),this.formControlWhite.setValue((null===(a=null===(c=null===(r=this.deviceInfo)||void 0===r?void 0:r.deviceStatus)||void 0===c?void 0:c.lights[null===(l=this.deviceInfo)||void 0===l?void 0:l.device.channel])||void 0===a?void 0:a.white)/2.55,{emitEvent:!1});const e=null===(p=null===(d=this.deviceInfo)||void 0===d?void 0:d.deviceStatus)||void 0===p?void 0:p.lights[null===(h=null===(u=this.deviceInfo)||void 0===u?void 0:u.device)||void 0===h?void 0:h.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${e.red},${e.green},${e.blue})`)}}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngAfterViewInit(){var e,t,i,n,o,s,r,c;if($("#colorpicker").wheelColorPicker({htmlOptions:!0}),null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(n=null===(i=this.deviceInfo)||void 0===i?void 0:i.device)||void 0===n?void 0:n.channel]){const e=null===(s=null===(o=this.deviceInfo)||void 0===o?void 0:o.deviceStatus)||void 0===s?void 0:s.lights[null===(c=null===(r=this.deviceInfo)||void 0===r?void 0:r.device)||void 0===c?void 0:c.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${e.red},${e.green},${e.blue})`)}$("#colorpicker").on("slidermove",()=>{const e=$("#colorpicker").get(0).value.slice(4,-1).split(",");this.color.next({red:+e[0],green:+e[1],blue:+e[2]})}),this.color.pipe((0,O.b)(50),(0,P.x)(),(0,L.w)(e=>(0,g.of)(this.onLightColor(e))),(0,D.R)(this.unsubscribe)).subscribe()}touch(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.dragging=e}mouse(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.mousedown=e}onLightGainValidatorFn(){return e=>e.valueChanges?e.valueChanges.pipe((0,O.b)(50),(0,P.x)(),(0,L.w)(e=>(0,g.of)(this.onLightGain(e))),(0,J.P)()):(0,g.of)(null)}onLightWhiteValidatorFn(){return e=>e.valueChanges?e.valueChanges.pipe((0,O.b)(50),(0,P.x)(),(0,L.w)(e=>(0,g.of)(this.onLightWhite(+(2.55*e).toFixed(0)))),(0,J.P)()):(0,g.of)(null)}onLightWhite(e){var t,i;return(0,M.mG)(this,void 0,void 0,function*(){(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===N.L.local&&(yield this.localService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(()=>this.onErrorWhite())),(null===(i=this.deviceInfo)||void 0===i?void 0:i.deviceConStatus)===N.L.cloud&&(yield this.deviceService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(()=>this.onErrorWhite()))})}onLightGain(e){var t,i;return(0,M.mG)(this,void 0,void 0,function*(){(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===N.L.local&&(yield this.localService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(()=>this.onErrorGain())),(null===(i=this.deviceInfo)||void 0===i?void 0:i.deviceConStatus)===N.L.cloud&&(yield this.deviceService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(()=>this.onErrorGain()))})}onLightColor(e){var t,i;return(0,M.mG)(this,void 0,void 0,function*(){(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===N.L.local&&(yield this.localService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue,this.deviceInfo.ip).toPromise().catch(()=>this.onErrorColor())),(null===(i=this.deviceInfo)||void 0===i?void 0:i.deviceConStatus)===N.L.cloud&&(yield this.deviceService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue).toPromise().catch(()=>this.onErrorColor()))})}onErrorGain(){var e,t,i,n;this.formControlGain.setValue(null===(n=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=this.deviceInfo)||void 0===i?void 0:i.device.channel])||void 0===n?void 0:n.gain,{emitEvent:!1})}onErrorWhite(){var e,t,i,n;this.formControlGain.setValue(null===(n=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=this.deviceInfo)||void 0===i?void 0:i.device.channel])||void 0===n?void 0:n.white,{emitEvent:!1})}onErrorColor(){var e,t,i,n;const o=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(n=null===(i=this.deviceInfo)||void 0===i?void 0:i.device)||void 0===n?void 0:n.channel];$("#colorpicker").wheelColorPicker("setValue",`rgb(${o.red},${o.green},${o.blue})`)}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(h.SBq),h.Y36(U.C),h.Y36(q.U))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-color-content"]],inputs:{deviceInfo:"deviceInfo",showCurrent:"showCurrent"},features:[h.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"touchstart","mousedown","touchend","mouseup"],["id","colorpicker","type","text","data-wheelcolorpicker","","data-wcp-sliders","hws","data-wcp-layout","block","data-wcp-format","rgb"],["mode","md","lines","none","style","z-index: 1;",4,"ngIf"],["mode","md",2,"margin-top","-40px","margin-bottom","-20px"],["id","range","mode","md","min","0","max","100","step","1","pin","true",3,"formControl","touchstart","mousedown","touchend","mouseup"],["size","small","slot","start","name","sunny","color","medium"],["slot","end","name","sunny","color","medium"],["mode","md",2,"margin-top","-40px","--background","none","margin-bottom","-20px"],["mode","md","lines","none",2,"z-index","1"],[2,"width","100%"],[2,"text-align","center"],[2,"text-align","right"]],template:function(e,t){1&e&&h.YNc(0,Y,13,8,"ng-container",0),2&e&&h.Q6J("ngIf","light"===(null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.category)&&(null==t.deviceInfo||null==t.deviceInfo.deviceStatus?null:t.deviceInfo.deviceStatus.lights)&&"color"===(null==t.deviceInfo||null==t.deviceInfo.deviceStatus||null==t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel]?null:t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel].mode))},directives:[s.O5,c.Ie,F.e,c.I_,c.QI,r.JJ,r.oH,c.gu,c.Nd,c.wI],styles:[".control-light .popover-content{width:321px!important;max-width:321px!important}  ion-item>.jQWCP-wWidget.jQWCP-block{width:270px!important;height:195px;border:none;background:none;box-shadow:none;left:50%;transform:translate(-50%);margin:8px}[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;padding-bottom:10px;--background: none}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{padding-bottom:0;--knob-size: 25px;--bar-height: 3px;--knob-handle-size: 45px}ion-item.ios[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-handle-size: 40px;padding-bottom:1px;padding-top:44px}  .jQWCP-wWidget{outline:none!important}ion-col[_ngcontent-%COMP%]{background-color:transparent!important}"],changeDetection:0}),e})();var B=i(18343),H=i(70775);let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[c.Pc,A,r.u5,r.UX,s.ez,l.aw,n._t,w,a.ot,u.lN,d.p9,k.c,S,p.FA,Z.Cq,_.yI,C.LD,n._t,o.Cl,I.vQ]]}),e})();h.B6R(B.M,[c.W2,E],[s.Ov,H.B]);var z=i(12630),V=i(42138),W=i(88592),R=i(96628),X=i(23815),K=i(26215),ee=i(20945),te=i(11627),ie=i(55229),ne=i(75598),oe=i(28243),se=i(25473),re=i(2699);function ce(e,t){if(1&e&&(h.TgZ(0,"ion-item",11),h._UZ(1,"app-device",12,13),h.ALo(3,"async"),h.qZA()),2&e){const e=h.MAs(2),t=h.oxw().$implicit,i=h.oxw().ngIf;h.xp6(1),h.Q6J("inView","#customizeContainer")("ping",h.lcZ(3,6,e.isInView))("deviceInfo",i)("config",t.config)("reorder",!1)("showDetails",!1)}}function le(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-card",9),h.NdJ("click",function(){const t=h.CHM(e).index;return h.oxw(2).selectedLayout=t}),h.YNc(1,ce,4,8,"ion-item",10),h.qZA()}if(2&e){const e=t.$implicit,i=t.index,n=h.oxw(2);h.Udp("display",e.hidden?"none":null),h.ekj("selected",n.selectedLayout===i||0===i&&!n.selectedLayout),h.xp6(1),h.Q6J("ngIf",!e.hidden)}}function ae(e,t){if(1&e&&(h.TgZ(0,"ion-list"),h.YNc(1,le,2,5,"ion-card",8),h.ALo(2,"async"),h.qZA()),2&e){const e=h.oxw();h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,1,e.layouts$))}}let de=(()=>{class e{constructor(e,t){this.deviceInfoService=e,this.modalController=t,this.DEVICE_TYPES=ne.E.DEVICE_TYPES}ngOnInit(){this.deviceInfo$=this.deviceInfoService.subDeviceInfoChange(this.deviceId).pipe((0,te.j)((e,t)=>(0,ee.F)(0===t?150:0))),this.layouts$=this.deviceInfo$.pipe((0,f.U)(e=>{var t;return e.deviceStatus?((0,ie.$U)(null===(t=null==e?void 0:e.device)||void 0===t?void 0:t.category)||(0,ie.$U)("default")).map(t=>({config:t,hidden:!(0,ie.v)(t,e)})):[]}),(0,P.x)(this.compareConfig))}closeModal(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss()})}save(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss({selectedLayout:this.selectedLayout})})}addRow(){return(0,M.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:e,cssClass:"dashboardModal",componentProps:{deviceId:this.deviceId}});yield t.present(),yield t.onWillDismiss()})}compareConfig(e,t){return JSON.stringify(e)===JSON.stringify(t)}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(oe.H),h.Y36(c.IN))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-customize"]],decls:14,vars:6,consts:[["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["slot","icon-only","name","checkmark-done-sharp"],["id","customizeContainer","scroll-events","",1,"cards"],[4,"ngIf"],["class","card",3,"selected","display","click",4,"ngFor","ngForOf"],[1,"card",3,"click"],["mode","md","lines","none","button","",4,"ngIf"],["mode","md","lines","none","button",""],[3,"inView","ping","deviceInfo","config","reorder","showDetails"],["inView","inView"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-buttons",0),h.TgZ(3,"ion-button",1),h.NdJ("click",function(){return t.closeModal()}),h._UZ(4,"ion-icon",2),h.qZA(),h.qZA(),h.TgZ(5,"ion-title",3),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"ion-buttons",4),h.TgZ(9,"ion-button",1),h.NdJ("click",function(){return t.save()}),h._UZ(10,"ion-icon",5),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"ion-content",6),h.YNc(12,ae,3,3,"ion-list",7),h.ALo(13,"async"),h.qZA()),2&e&&(h.xp6(6),h.hij(" ",h.lcZ(7,2,"app.component.customize.header.label")," "),h.xp6(6),h.Q6J("ngIf",h.lcZ(13,4,t.deviceInfo$)))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,s.O5,c.q_,s.sg,c.PM,c.Ie,F.e,se.v,re.z],pipes:[l.X$,s.Ov],styles:["[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}app-device[_ngcontent-%COMP%]{width:100%;z-index:-1}ion-card.selected[_ngcontent-%COMP%]{box-shadow:0 0 1px 3px var(--ion-color-primary-shade)!important}ion-card[_ngcontent-%COMP%]{transform:translateZ(0)}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}"],changeDetection:0}),e})();var pe=i(89968),ue=i(29379),he=i(99119),ve=i(25355),ge=i(97722),me=i(42810),fe=i(17238),ye=i(52580),be=i(45435),xe=i(64010),we=i(77220),ke=i(52141),Ze=i(56149);const Ce=["matSelect"];function Se(e,t){1&e&&h._UZ(0,"ion-progress-bar",21)}function Ie(e,t){if(1&e&&(h.TgZ(0,"mat-option",22),h._uU(1),h.TgZ(2,"div",23),h._uU(3),h.qZA(),h.qZA()),2&e){const e=t.$implicit,i=h.oxw(2);h.Q6J("value",e),h.xp6(1),h.hij(" ","Shelly "+i.deviceTypes[e].friendly_name," "),h.xp6(2),h.hij(" ",i.deviceTypes[e].name," ")}}function _e(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"img",24),h.NdJ("error",function(){return h.CHM(e),h.oxw(2).onImageError(!0)}),h.qZA()}if(2&e){const e=h.oxw().ngIf;h.Q6J("src","https://my.shelly.cloud/assets/img/device_images/"+e.selectedDevice+".png",h.LSH)}}function Ae(e,t){1&e&&(h.TgZ(0,"h2",25),h._uU(1," No image available "),h.qZA())}function Me(e,t){1&e&&h._UZ(0,"ion-spinner")}function Te(e,t){1&e&&h._UZ(0,"ion-icon",30)}function Oe(e,t){1&e&&h._UZ(0,"ion-icon",31)}function Pe(e,t){1&e&&h._UZ(0,"ion-icon",32)}function Le(e,t){1&e&&h._UZ(0,"ion-spinner")}function De(e,t){1&e&&h._UZ(0,"ion-icon",30)}function $e(e,t){1&e&&h._UZ(0,"ion-icon",31)}function Je(e,t){1&e&&h._UZ(0,"ion-spinner")}function Ne(e,t){1&e&&h._UZ(0,"ion-icon",30)}function Ue(e,t){1&e&&h._UZ(0,"ion-icon",31)}function qe(e,t){1&e&&h._UZ(0,"ion-spinner")}function Fe(e,t){1&e&&h._UZ(0,"ion-icon",30)}function Qe(e,t){1&e&&h._UZ(0,"ion-icon",31)}function Ge(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",26),h.NdJ("click",function(){return h.CHM(e),h.oxw(2).resetState()}),h.TgZ(1,"div"),h.TgZ(2,"div"),h._uU(3),h.YNc(4,Me,1,0,"ion-spinner",0),h.YNc(5,Te,1,0,"ion-icon",27),h.YNc(6,Oe,1,0,"ion-icon",28),h.YNc(7,Pe,1,0,"ion-icon",29),h.qZA(),h.TgZ(8,"div"),h._uU(9),h.YNc(10,Le,1,0,"ion-spinner",0),h.YNc(11,De,1,0,"ion-icon",27),h.YNc(12,$e,1,0,"ion-icon",28),h.qZA(),h.TgZ(13,"div"),h._uU(14),h.YNc(15,Je,1,0,"ion-spinner",0),h.YNc(16,Ne,1,0,"ion-icon",27),h.YNc(17,Ue,1,0,"ion-icon",28),h.qZA(),h.TgZ(18,"div"),h._uU(19),h.YNc(20,qe,1,0,"ion-spinner",0),h.YNc(21,Fe,1,0,"ion-icon",27),h.YNc(22,Qe,1,0,"ion-icon",28),h.qZA(),h.qZA(),h.qZA()}if(2&e){const e=h.oxw().ngIf,t=h.oxw();h.Q6J("@showHide",void 0),h.xp6(3),h.hij(' 1. Verifying "',e.network,'" '),h.xp6(1),h.Q6J("ngIf",void 0===e.state.verifiedNetwork),h.xp6(1),h.Q6J("ngIf",!1===e.state.verifiedNetwork),h.xp6(1),h.Q6J("ngIf",!0===e.state.verifiedNetwork&&!e.state.warningNetwork),h.xp6(1),h.Q6J("ngIf",!0===e.state.verifiedNetwork&&e.state.warningNetwork),h.xp6(1),h.ekj("inactive",!e.state.verifiedNetwork),h.xp6(1),h.hij(' 2. Connecting to "',"Shelly "+t.deviceTypes[e.selectedDevice].friendly_name,'" '),h.xp6(1),h.Q6J("ngIf",e.state.verifiedNetwork&&void 0===e.state.connectedShelly),h.xp6(1),h.Q6J("ngIf",!1===e.state.connectedShelly),h.xp6(1),h.Q6J("ngIf",!0===e.state.connectedShelly),h.xp6(1),h.ekj("inactive",!e.state.connectedShelly),h.xp6(1),h.hij(' 3. Sending information to "',"Shelly "+t.deviceTypes[e.selectedDevice].friendly_name,'" '),h.xp6(1),h.Q6J("ngIf",e.state.connectedShelly&&void 0===e.state.sendShelly),h.xp6(1),h.Q6J("ngIf",!1===e.state.sendShelly),h.xp6(1),h.Q6J("ngIf",!0===e.state.sendShelly),h.xp6(1),h.ekj("inactive",!e.state.sendShelly),h.xp6(1),h.hij(' 4. Connecting to "',e.network,'" '),h.xp6(1),h.Q6J("ngIf",e.state.sendShelly&&void 0===e.state.connectedNetwork),h.xp6(1),h.Q6J("ngIf",!1===e.state.connectedNetwork),h.xp6(1),h.Q6J("ngIf",!0===e.state.connectedNetwork)}}function Ye(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-header"),h.TgZ(2,"ion-toolbar"),h.TgZ(3,"ion-buttons",1),h.TgZ(4,"ion-button",2),h.NdJ("click",function(){return h.CHM(e),h.oxw().closeModal()}),h._UZ(5,"ion-icon",3),h.qZA(),h.qZA(),h.TgZ(6,"ion-title",4),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.YNc(9,Se,1,0,"ion-progress-bar",5),h.qZA(),h.qZA(),h.TgZ(10,"ion-content",6),h.TgZ(11,"h2"),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.TgZ(14,"mat-form-field",7),h.TgZ(15,"mat-label"),h._uU(16),h.ALo(17,"translate"),h.TgZ(18,"div",8),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.TgZ(21,"mat-select",9,10),h.NdJ("ngModelChange",function(t){return h.CHM(e).ngIf.selectedDevice=t})("ngModelChange",function(){return h.CHM(e),h.oxw().onImageError(!1)}),h.TgZ(23,"mat-select-trigger"),h._uU(24),h.TgZ(25,"div",11),h._uU(26),h.qZA(),h.qZA(),h.YNc(27,Ie,4,3,"mat-option",12),h.qZA(),h.qZA(),h.YNc(28,_e,1,1,"img",13),h.YNc(29,Ae,2,0,"h2",14),h.TgZ(30,"h2"),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.TgZ(33,"mat-form-field",15),h.TgZ(34,"mat-label"),h._uU(35),h.ALo(36,"translate"),h.qZA(),h.TgZ(37,"input",16),h.NdJ("ngModelChange",function(t){return h.CHM(e).ngIf.network=t}),h.qZA(),h.qZA(),h.TgZ(38,"mat-form-field",17),h.TgZ(39,"mat-label"),h._uU(40),h.ALo(41,"translate"),h.qZA(),h.TgZ(42,"input",18),h.NdJ("ngModelChange",function(t){return h.CHM(e).ngIf.password=t}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(43,"ion-footer"),h.TgZ(44,"ion-toolbar"),h.TgZ(45,"ion-button",19),h.NdJ("click",function(){return h.CHM(e),h.oxw().addDevice()}),h._uU(46),h.ALo(47,"translate"),h.qZA(),h.qZA(),h.qZA(),h.YNc(48,Ge,23,24,"div",20),h.BQk()}if(2&e){const e=t.ngIf,i=h.oxw();h.xp6(7),h.hij(" ",h.lcZ(8,22,"app.component.more.add-devices.label")," "),h.xp6(2),h.Q6J("ngIf",e.loading),h.xp6(3),h.Oqu(h.lcZ(13,24,"app.component.add.select-shelly.label")),h.xp6(4),h.hij(" ",h.lcZ(17,26,"app.component.add.select-type.label")," "),h.xp6(3),h.hij(" ",h.lcZ(20,28,"app.component.add.select-ssid.label")," "),h.xp6(2),h.Q6J("ngModel",e.selectedDevice)("disabled",e.loading),h.xp6(3),h.hij(" ","Shelly "+i.deviceTypes[e.selectedDevice].friendly_name," "),h.xp6(2),h.hij(" ",i.deviceTypes[e.selectedDevice].name," "),h.xp6(1),h.Q6J("ngForOf",e.devices),h.xp6(1),h.Q6J("ngIf",!e.imageError),h.xp6(1),h.Q6J("ngIf",e.imageError),h.xp6(2),h.Oqu(h.lcZ(32,30,"app.component.add.network.header.label")),h.xp6(4),h.Oqu(h.lcZ(36,32,"app.component.add.network.label")),h.xp6(2),h.Q6J("ngModel",e.network)("disabled",e.loading),h.xp6(3),h.Oqu(h.lcZ(41,34,"app.component.add.password.label")),h.xp6(2),h.Q6J("ngModel",e.password)("disabled",e.loading),h.xp6(3),h.Q6J("disabled",!e.network||!e.password||e.loading),h.xp6(1),h.hij(" ",h.lcZ(47,36,"app.component.add.confirm.label")," "),h.xp6(2),h.Q6J("ngIf",e.state)}}let Ee=(()=>{class e{constructor(e,t,i,n,o,s){this.notificationsService=e,this.localService=t,this.alertService=i,this.lookupService=n,this.modalController=o,this.deviceInfoService=s,this.state$=new K.X({devices:[],selectedDevice:"SHSW-1"}),this.slideOpts={initialSlide:0,speed:400},this.deviceTypes=ne.E.DEVICE_TYPES,this.ignoredDevices=["PLG1NB","SMK1NB","DS1NB","MS1NB","HT1NB","WS1NB","SHSW-1S","SHUNI-1","SHSPOT-1"]}ngOnInit(){return(0,M.mG)(this,void 0,void 0,function*(){this.state$.value.devices=Object.keys(ne.E.DEVICE_TYPES).filter(e=>-1===this.ignoredDevices.indexOf(e)).sort(),this.state$.value.network=yield ye.k.getSSID().then(e=>e.ssid).catch(()=>""),this.state$.next(this.state$.value)})}ngAfterViewInit(){setTimeout(()=>this.matSelect.focus(),550)}ngOnDestroy(){}onImageError(e){this.state$.value.imageError=e,this.state$.next(this.state$.value)}closeModal(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss()})}resetState(){(Object.keys(this.state$.value.state).some(e=>!1===this.state$.value.state[e])||this.state$.value.state.connectedNetwork)&&(this.state$.value.state=void 0,this.state$.next(this.state$.value))}addDevice(){return(0,M.mG)(this,void 0,void 0,function*(){this.state$.value.loading=!0,this.state$.value.state={},this.state$.next(this.state$.value);const e=yield ye.k.getSSID().then(e=>e.ssid).catch(()=>null),t=yield ye.k.connect({ssid:this.state$.value.network,password:this.state$.value.password}).then(e=>e.ssid).catch(()=>null);if(this.state$.value.state={warningNetwork:e===this.state$.value.network,verifiedNetwork:!!t},this.state$.next(this.state$.value),this.state$.value.state.verifiedNetwork){const e=yield ye.k.connectPrefix({ssid:ne.E.DEVICE_TYPES[this.state$.value.selectedDevice].name}).then(e=>e.ssid).catch(()=>null);if(this.state$.value.state.connectedShelly=!!e,this.state$.next(this.state$.value),this.state$.value.state.connectedShelly){const e=yield this.deviceInfoService.pingShellyWifi("192.168.33.1").toPromise().catch(()=>null);let t=!1;if(e){const i=yield this.deviceInfoService.subDeviceInfo(e).pipe((0,be.h)(e=>!!e&&e.deviceConStatus!==N.L.offline),(0,y.q)(1),(0,xe.V)(2e4)).toPromise();(yield this.checkLocked(i))&&(yield this.deviceInfoService.setWifi(i.device,this.state$.value.network,this.state$.value.password,i.ip).toPromise().catch(()=>null),t=!0)}if(this.state$.value.state.sendShelly=t,this.state$.next(this.state$.value),this.state$.value.state.sendShelly){const e=yield ye.k.connect({ssid:this.state$.value.network,password:this.state$.value.password}).then(e=>e.ssid).catch(()=>null);this.state$.value.state.connectedNetwork=!!e,this.state$.next(this.state$.value)}}}this.state$.value.state.connectedNetwork&&this.notificationsService.presentCustomToast("Successfully send network information to the shelly device. You can now search and add it",6e3),this.state$.value.loading=!1,this.state$.next(this.state$.value)})}checkLocked(e){return(0,M.mG)(this,void 0,void 0,function*(){if(e.deviceConStatus===N.L.locked){const t=yield this.alertService.onClickUnlock();if(t){const i={enabled:!0,password:btoa(t.password),username:btoa(t.username)},n=(0,X.cloneDeep)(e.device);n.login=i;const o=yield this.localService.deviceSettings(n,e.ip).toPromise().catch(()=>null);if(o)return n.category=this.deviceInfoService.getCategory(n.type,o),this.lookupService.setDevice(n.id,n),yield this.deviceInfoService.checkStatus(n,e.ip,!0).pipe((0,y.q)(1)).toPromise(),!0}return!1}return!0})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(we.T),h.Y36(U.C),h.Y36(ke.c),h.Y36(Ze.W),h.Y36(c.IN),h.Y36(oe.H))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-search"]],viewQuery:function(e,t){if(1&e&&h.Gf(Ce,5),2&e){let e;h.iGM(e=h.CRH())&&(t.matSelect=e.first)}},decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["type","indeterminate",4,"ngIf"],["fullscreen","true","id","searchContainer","scroll-events",""],["appearance","fill",1,"select"],[2,"float","right","padding-right","25px"],[3,"ngModel","disabled","ngModelChange"],["matSelect",""],[1,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"src","error",4,"ngIf"],["style","height: 184px; vertical-align: center; line-height: 160px;",4,"ngIf"],["appearance","fill",1,"network"],["matInput","","type","ssid",3,"ngModel","disabled","ngModelChange"],["appearance","fill",1,"password"],["matInput","","type","password",3,"ngModel","disabled","ngModelChange"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["class","status",3,"click",4,"ngIf"],["type","indeterminate"],[3,"value"],[2,"float","right","filter","contrast(0.5)"],[3,"src","error"],[2,"height","184px","vertical-align","center","line-height","160px"],[1,"status",3,"click"],["slot","icon-only","name","close","color","danger",4,"ngIf"],["slot","icon-only","name","checkmark-done-outline","color","success",4,"ngIf"],["slot","icon-only","name","warning-outline","color","warning",4,"ngIf"],["slot","icon-only","name","close","color","danger"],["slot","icon-only","name","checkmark-done-outline","color","success"],["slot","icon-only","name","warning-outline","color","warning"]],template:function(e,t){1&e&&(h.YNc(0,Ye,49,38,"ng-container",0),h.ALo(1,"async")),2&e&&h.Q6J("ngIf",h.lcZ(1,1,t.state$))},directives:[s.O5,c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,u.KE,u.hX,C.gD,r.JJ,r.On,C.$L,s.sg,k.Nt,r.Fj,c.fr,c.X7,v.ey,c.PQ],pipes:[s.Ov,l.X$],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.select[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:0 50px;margin:0 auto;display:block}.label[_ngcontent-%COMP%]{filter:contrast(.5);position:absolute;top:0;right:18px;max-width:100px;overflow-x:auto}  body.dark .select .mat-form-field-label{color:#9fa8da}  body:not(.dark) .select .mat-form-field-label{color:#3f51b5}img[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;margin:0 auto;display:block;height:200px}.network[_ngcontent-%COMP%], .password[_ngcontent-%COMP%]{width:100%;max-width:400px;padding-left:50px;padding-right:50px;margin:0 auto;display:block}h2[_ngcontent-%COMP%]{padding-top:20px;text-align:center}.status[_ngcontent-%COMP%]{position:fixed;width:100vw;height:100vh;background-color:#d3d3d33a;z-index:10}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--ion-text-color);background:var(--ion-background-color);border-radius:10px;padding:10px;height:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:7px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-spinner[_ngcontent-%COMP%]{height:20px;width:20px;float:right;margin-left:20px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{font-size:20px;float:right;margin-left:20px}.status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   div.inactive[_ngcontent-%COMP%]{color:#a9a9a9;margin-right:40px}"],data:{animation:[(0,fe.X$)("showHide",[(0,fe.eR)(":enter",[(0,fe.oB)({opacity:"0"}),(0,fe.jt)("300ms ease-in",(0,fe.oB)({opacity:"1"}))]),(0,fe.eR)(":leave",[(0,fe.jt)("300ms ease-out",(0,fe.oB)({opacity:"0"}))])])]},changeDetection:0}),e})();var Be=i(72353),He=i(9112),je=i(65792);let ze=(()=>{class e{constructor(e){this.popoverController=e,this.type="update"}confirm(){this.popoverController.dismiss({type:this.type})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(c.Dh))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-update-settings"]],decls:17,vars:8,consts:[["mode","md","button","","lines","none",3,"detail","click"],["slot","start",2,"pointer-events","none","margin-left","5px","margin-right","20px",3,"ngModel"],["color","primary",2,"text-align","center","padding-right","25px"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"ion-item",0),h.NdJ("click",function(){return t.type="update",t.confirm()}),h._UZ(2,"ion-checkbox",1),h.TgZ(3,"ion-label",2),h._uU(4," Latest "),h.qZA(),h.qZA(),h.TgZ(5,"ion-item",0),h.NdJ("click",function(){return t.type="beta",t.confirm()}),h._UZ(6,"ion-checkbox",1),h.TgZ(7,"ion-label",2),h._uU(8," Beta "),h.qZA(),h.qZA(),h.TgZ(9,"ion-item",0),h.NdJ("click",function(){return t.type="revert",t.confirm()}),h._UZ(10,"ion-checkbox",1),h.TgZ(11,"ion-label",2),h._uU(12," Revert Beta "),h.qZA(),h.qZA(),h.TgZ(13,"ion-item",0),h.NdJ("click",function(){return t.type="select",t.confirm()}),h._UZ(14,"ion-checkbox",1),h.TgZ(15,"ion-label",2),h._uU(16," Select firmware "),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(1),h.Q6J("detail",!1),h.xp6(1),h.Q6J("ngModel","update"===t.type),h.xp6(3),h.Q6J("detail",!1),h.xp6(1),h.Q6J("ngModel","beta"===t.type),h.xp6(3),h.Q6J("detail",!1),h.xp6(1),h.Q6J("ngModel","revert"===t.type),h.xp6(3),h.Q6J("detail",!1),h.xp6(1),h.Q6J("ngModel","select"===t.type))},directives:[c.Ie,F.e,c.nz,c.w,r.JJ,r.On,c.Q$],styles:[".md.update-settings-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.update-settings-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),e})();var Ve=i(9074),We=i(68384),Re=i(72773),Xe=i(8239);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var Ke=(()=>{return(e=Ke||(Ke={})).Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE",Ke;var e})();class et extends Error{constructor(e,t){super(e),this.message=e,this.code=t}}const tt=e=>{var t,i,n,o,s;const r=e.CapacitorCustomPlatform||null,c=e.Capacitor||{},l=c.Plugins=c.Plugins||{},a=e.CapacitorPlatforms,d=(null===(t=null==a?void 0:a.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==r?r.name:(e=>{var t,i;return(null==e?void 0:e.androidBridge)?"android":(null===(i=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===i?void 0:i.bridge)?"ios":"web"})(e)),p=(null===(i=null==a?void 0:a.currentPlatform)||void 0===i?void 0:i.isNativePlatform)||(()=>"web"!==d()),u=(null===(n=null==a?void 0:a.currentPlatform)||void 0===n?void 0:n.isPluginAvailable)||(e=>{const t=v.get(e);return!(!(null==t?void 0:t.platforms.has(d()))&&!h(e))}),h=(null===(o=null==a?void 0:a.currentPlatform)||void 0===o?void 0:o.getPluginHeader)||(e=>{var t;return null===(t=c.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)}),v=new Map,g=(null===(s=null==a?void 0:a.currentPlatform)||void 0===s?void 0:s.registerPlugin)||((e,t={})=>{const i=v.get(e);if(i)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),i.proxy;const n=d(),o=h(e);let s;const a=function(){var e=(0,Xe.Z)(function*(){return!s&&n in t?s=s="function"==typeof t[n]?yield t[n]():t[n]:null!==r&&!s&&"web"in t&&(s=s="function"==typeof t.web?yield t.web():t.web),s});return function(){return e.apply(this,arguments)}}(),p=t=>{let i;const s=(...s)=>{const r=a().then(r=>{const l=((t,i)=>{var s,r;if(!o){if(t)return null===(r=t[i])||void 0===r?void 0:r.bind(t);throw new et(`"${e}" plugin is not implemented on ${n}`,Ke.Unimplemented)}{const n=null==o?void 0:o.methods.find(e=>i===e.name);if(n)return"promise"===n.rtype?t=>c.nativePromise(e,i.toString(),t):(t,n)=>c.nativeCallback(e,i.toString(),t,n);if(t)return null===(s=t[i])||void 0===s?void 0:s.bind(t)}})(r,t);if(l){const e=l(...s);return i=null==e?void 0:e.remove,e}throw new et(`"${e}.${t}()" is not implemented on ${n}`,Ke.Unimplemented)});return"addListener"===t&&(r.remove=(0,Xe.Z)(function*(){return i()})),r};return s.toString=()=>`${t.toString()}() { [capacitor code] }`,Object.defineProperty(s,"name",{value:t,writable:!1,configurable:!1}),s},u=p("addListener"),g=p("removeListener"),m=(e,t)=>{const i=u({eventName:e},t),n=function(){var n=(0,Xe.Z)(function*(){const n=yield i;g({eventName:e,callbackId:n},t)});return function(){return n.apply(this,arguments)}}(),o=new Promise(e=>i.then(()=>e({remove:n})));return o.remove=(0,Xe.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield n()}),o},f=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return o?m:u;case"removeListener":return g;default:return p(t)}}});return l[e]=f,v.set(e,{name:e,proxy:f,platforms:new Set([...Object.keys(t),...o?[n]:[]])}),f});return c.convertFileSrc||(c.convertFileSrc=e=>e),c.getPlatform=d,c.handleError=t=>e.console.error(t),c.isNativePlatform=p,c.isPluginAvailable=u,c.pluginMethodNoop=(e,t,i)=>Promise.reject(`${i} does not have an implementation of "${t}".`),c.registerPlugin=g,c.Exception=et,c.DEBUG=!!c.DEBUG,c.isLoggingEnabled=!!c.isLoggingEnabled,c.platform=c.getPlatform(),c.isNative=c.isNativePlatform(),c},it=(0,(e=>e.Capacitor=tt(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).registerPlugin)("Filesystem",{electron:()=>window.CapacitorCustomPlatform.plugins.Filesystem});let nt=Re.fy,ot=(()=>{class e{constructor(e,t){this.platform=e,this.domSanitizer=t,this.baseDirectory=Re.tP.Data,this.folder="ShellyHome",this.platform.is("electron")&&(nt=it)}initFolder(e){return(0,M.mG)(this,void 0,void 0,function*(){return this.platform.is("electron")&&(this.baseDirectory=Re.tP.Documents),this.folder=e,yield nt.mkdir({path:this.folder,directory:this.baseDirectory,recursive:!1}).catch(e=>(console.error(e),null)),this.directory=yield nt.getUri({path:this.folder,directory:this.baseDirectory}).catch(e=>(console.error(e),null)),this.directory})}fetchFileNames(e=this.folder){return(0,M.mG)(this,void 0,void 0,function*(){const t=yield nt.readdir({path:e,directory:this.baseDirectory}).catch(e=>(console.error(e),null)),i=t?t.files:[];return i.length>0?(yield Promise.all(i.map(t=>this.fetchFileNames(e+"/"+t)))).reduce((e,t)=>[...e,...t],[]):[e]})}writeFile(e,t,i=3/64){return(0,M.mG)(this,void 0,void 0,function*(){this.platform.is("capacitor")||this.platform.is("electron")?yield this.convertToBase64Chunks(t,i,(t,i)=>(0,M.mG)(this,void 0,void 0,function*(){i?yield nt.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,recursive:!0}):yield nt.appendFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t})})):yield nt.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,encoding:Re.ez.UTF8,recursive:!0})})}readFile(e){return(0,M.mG)(this,void 0,void 0,function*(){if(this.platform.is("capacitor")||this.platform.is("electron")){const t=We.dV.convertFileSrc(this.directory.uri+"/"+e);return{success:this.domSanitizer.bypassSecurityTrustResourceUrl(t),revoke:()=>{}}}{const t=yield this.readFileAsBlob(e),i=URL.createObjectURL(t);return{success:this.domSanitizer.bypassSecurityTrustResourceUrl(i),revoke:()=>{URL.revokeObjectURL(i)}}}})}readFileAsBlob(e){return(0,M.mG)(this,void 0,void 0,function*(){if(this.platform.is("capacitor")||this.platform.is("electron")){const t=We.dV.convertFileSrc(this.directory.uri+"/"+e);return yield fetch(t).then(e=>e.blob())}return(yield nt.readFile({path:this.folder+"/"+e,directory:this.baseDirectory})).data})}deleteFile(e){return(0,M.mG)(this,void 0,void 0,function*(){yield nt.deleteFile({path:this.folder+"/"+e,directory:this.baseDirectory}).catch(e=>(console.error(e),null))})}start(){return(0,M.mG)(this,void 0,void 0,function*(){const e=this.directory.uri;return yield Ve.D.start({path:e,port:8080}).then(e=>"http://"+e.ip+":8080").catch(e=>null)})}stop(){return(0,M.mG)(this,void 0,void 0,function*(){yield Ve.D.stop().catch(e=>console.log(e))})}convertToBase64Chunks(e,t,i){return(0,M.mG)(this,void 0,void 0,function*(){const n=1048576*t;if(n%6)throw{error:"Chunksize must be a multiple of 6!"};{const t=e.size;for(;e.size>n;){const o=yield this.convertToBase64(e.slice(0,n));yield i(t===e.size?o:o.split(",")[1],t===e.size),e=e.slice(n)}const o=yield this.convertToBase64(e.slice(0,e.size));yield i(o.split(",")[1],t===e.size),e=e.slice(e.size)}})}convertToBase64(e){return new Promise((t,i)=>{let n=new FileReader;const o=n._realReader;o&&(n=o),n.onerror=e=>{console.log(e),i()},n.onload=()=>{t(n.result)},n.readAsDataURL(e)})}}return e.\u0275fac=function(t){return new(t||e)(h.LFG(c.t4),h.LFG(x.H7))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),st=(()=>{class e{constructor(e,t,i,n,o,s){this.httpClient=e,this.fileService=t,this.deviceService=i,this.translateService=n,this.loadingController=o,this.notificationsService=s}checkDevices(e,t,i="update",n){let o={};return{deviceInfos:t.filter(t=>{var s,r,c,l;const a=t.deviceInfos[0],d=null===(r=null===(s=a.deviceStatus)||void 0===s?void 0:s.update)||void 0===r?void 0:r.old_version;if(a.deviceStatus&&d){let t=!1;return"update"===i?(t=!!e[a.device.type]&&(null===(c=e[a.device.type].version)||void 0===c?void 0:c.split("/")[0])>(null==d?void 0:d.split("/")[0]),t&&(o[a.device.type]={version:e[a.device.type].version,url:e[a.device.type].url}),t):"beta"===i?(t=e[a.device.type]&&(null===(l=e[a.device.type].beta_ver)||void 0===l?void 0:l.split("/")[0])>(null==d?void 0:d.split("/")[0]),t&&(o[a.device.type]={beta_ver:e[a.device.type].beta_ver,beta_url:e[a.device.type].beta_url}),t):("revert"===i?(t=e[a.device.type]&&e[a.device.type].version&&(null==d?void 0:d.indexOf("-rc"))>-1,t&&(o[a.device.type]={version:e[a.device.type].version,url:e[a.device.type].url})):"select"===i&&n&&(t=n.startsWith(a.device.type)&&a.device.type+"_"+(null==d?void 0:d.split("/")[0])!==(null==n?void 0:n.split(".")[0]),t&&(o[a.device.type]={version:n,url:n})),t)}return!1}),firmwareList:o}}checkFirmwares(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.fileService.initFolder("ShellyHome");let e=yield this.deviceService.getFirmwareList();if(!e){e={};const t=yield this.getFirmareEntries();for(const i of t){const t=i.split("/").slice(0,-1).join("/");e[i.split("_")[0]]={url:null,version:t}}}return e})}startDeviceUpdateServer(){return this.fileService.start()}downloadFiles(e){return new Promise(t=>(0,M.mG)(this,void 0,void 0,function*(){if(e){const i=yield this.getFirmareEntries(),n=Object.keys(e).filter(t=>-1===i.indexOf(this.getFilename(t,e[t].version||e[t].beta_ver,e[t].url||e[t].beta_url)));if(n.length>0){const i=yield this.loadingController.create({message:this.translateService.instant("app.component.update.download.label")+" (0/"+n.length+")",showBackdrop:!1});yield i.present();const o={},s={},r=[];for(const c of n){const l=e[c].url||e[c].beta_url,a=this.getFilename(c,e[c].version||e[c].beta_ver,l);this.httpClient.get(l,{responseType:"blob",reportProgress:!0,observe:"events"}).subscribe(e=>(0,M.mG)(this,void 0,void 0,function*(){var c;if(e.type===b.dt.DownloadProgress){o[l]=e.total,s[l]=e.loaded;const t=Object.keys(s).map(e=>s[e]).reduce((e,t)=>e+t,0),n=Object.keys(o).map(e=>o[e]).reduce((e,t)=>e+t,0);i.message=(t/1e3).toFixed()+" / "+(n/1e3).toFixed()+" KB ("+(t/n*100).toFixed()+"%)"}else e.type===b.dt.Response&&(yield this.fileService.writeFile(a,e.body),r.push(!0),(null===(c=i.message)||void 0===c?void 0:c.toString().startsWith(this.translateService.instant("app.component.update.download.label")))&&(i.message=this.translateService.instant("app.component.update.download.label")+" ("+r.length+"/"+n.length+")"),r.length===n.length&&(i.dismiss(),t()))}),()=>{r.push(!1),r.length===n.length&&(i.dismiss(),t())})}}else this.notificationsService.presentCustomToast("app.component.update.download-done.label"),t()}else t()}))}getFirmareEntries(){return(0,M.mG)(this,void 0,void 0,function*(){return(yield this.fileService.fetchFileNames()).map(e=>e.replace("ShellyHome/",""))})}getFilename(e,t,i){return e+"/"+t+"/"+i.split("/").pop()}}return e.\u0275fac=function(t){return new(t||e)(h.LFG(b.eN),h.LFG(ot),h.LFG(q.U),h.LFG(l.sK),h.LFG(c.HT),h.LFG(we.T))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),rt=(()=>{class e{transform(e,t,i){return(e||[]).filter(e=>e[t]===i)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=h.Yjl({name:"filter",type:e,pure:!0}),e})();function ct(e,t){1&e&&h._UZ(0,"ion-progress-bar",17)}function lt(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h._UZ(1,"app-device",25,26),h.ALo(3,"async"),h.qZA()),2&e){const e=t.$implicit,i=h.MAs(2);h.xp6(1),h.Q6J("inView","#updateContainer")("ping",h.lcZ(3,5,i.isInView))("deviceInfo",e)("showDetails",!1)("reorder",!1)}}function at(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-item",18),h.NdJ("click",function(){const t=h.CHM(e).$implicit;return h.oxw(3).selectDevice(t)}),h.TgZ(2,"ion-grid",19),h.TgZ(3,"ion-list",20),h.YNc(4,lt,4,7,"ion-row",13),h.qZA(),h.qZA(),h._UZ(5,"ion-checkbox",21,22),h.TgZ(7,"ion-button",23),h.NdJ("click",function(t){const i=h.CHM(e).$implicit,n=h.oxw().ngIf,o=h.oxw(2);return t.stopPropagation(),o.showInfo(i.deviceInfos[0],n.firmwareList)}),h._UZ(8,"ion-icon",24),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=t.$implicit,i=h.oxw(2).ngIf,n=h.oxw();h.xp6(1),h.Q6J("disabled",i.searching),h.xp6(3),h.Q6J("ngForOf",e.deviceInfos)("ngForTrackBy",n.identifyInfo),h.xp6(1),h.s9C("color",i.selectedDevices[e.id]&&"local"!==e.deviceInfos[0].deviceConStatus?"danger":null),h.Q6J("mode","initial")("ngModel",i.selectedDevices[e.id]&&"local"===e.deviceInfos[0].deviceConStatus)("indeterminate",i.selectedDevices[e.id]&&"local"!==e.deviceInfos[0].deviceConStatus)}}function dt(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-header"),h.TgZ(2,"ion-toolbar"),h.TgZ(3,"ion-buttons",1),h.TgZ(4,"ion-button",2),h.NdJ("click",function(){return h.CHM(e),h.oxw(2).closeModal()}),h._UZ(5,"ion-icon",3),h.qZA(),h.qZA(),h.TgZ(6,"ion-title",4),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"ion-buttons",5),h.TgZ(10,"ion-button",6),h.NdJ("click",function(){const t=h.CHM(e).ngIf;return h.oxw(2).downloadFirmwares(t.firmwareList)}),h._UZ(11,"ion-icon",7),h.qZA(),h.TgZ(12,"ion-button",2),h.NdJ("click",function(t){return h.CHM(e),h.oxw(2).presentPopover(t)}),h._UZ(13,"ion-icon",8),h.qZA(),h.qZA(),h.YNc(14,ct,1,0,"ion-progress-bar",9),h.qZA(),h.qZA(),h.TgZ(15,"ion-content",10),h.TgZ(16,"ion-refresher",11),h.NdJ("ionRefresh",function(t){return h.CHM(e),h.oxw(2).checkFirmware(t)}),h._UZ(17,"ion-refresher-content"),h.qZA(),h.TgZ(18,"ion-list",12),h.YNc(19,at,9,7,"ng-container",13),h.qZA(),h.qZA(),h.TgZ(20,"ion-footer"),h.TgZ(21,"ion-toolbar"),h.TgZ(22,"div",14),h.NdJ("click",function(){const t=h.CHM(e).ngIf;return h.oxw(2).selectAllDevices(t.deviceInfos)}),h._UZ(23,"ion-checkbox",15),h.ALo(24,"filter"),h.ALo(25,"keyvalue"),h.ALo(26,"filter"),h.ALo(27,"keyvalue"),h.ALo(28,"filter"),h.ALo(29,"keyvalue"),h.qZA(),h.TgZ(30,"ion-button",16),h.NdJ("click",function(){const t=h.CHM(e).ngIf;return h.oxw(2).updateDevices(t.deviceInfos,t.firmwareList)}),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=t.ngIf,i=h.oxw().ngIf,n=h.oxw();h.xp6(7),h.hij(" ",h.lcZ(8,10,"app.component.more.update-devices.label")," "),h.xp6(3),h.Q6J("disabled",!e.firmwareList),h.xp6(4),h.Q6J("ngIf",i.searching),h.xp6(2),h.Q6J("disabled",i.searching),h.xp6(3),h.Q6J("ngForOf",e.deviceInfos)("ngForTrackBy",n.identify),h.xp6(4),h.Q6J("indeterminate",h.Dn7(24,12,h.lcZ(25,16,i.selectedDevices),"value",!0).length<(null==e.deviceInfos?null:e.deviceInfos.length)&&h.Dn7(26,18,h.lcZ(27,22,i.selectedDevices),"value",!0).length>0)("checked",h.Dn7(28,24,h.lcZ(29,28,i.selectedDevices),"value",!0).length===(null==e.deviceInfos?null:e.deviceInfos.length)),h.xp6(7),h.Q6J("disabled",i.searching||!e.firmwareList),h.xp6(1),h.hij(" ",h.lcZ(32,30,"app.component.update.confirm.label")," ")}}const pt=function(){return{}};function ut(e,t){if(1&e&&(h.ynx(0),h.YNc(1,dt,33,32,"ng-container",0),h.ALo(2,"async"),h.BQk()),2&e){const e=h.oxw();h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,e.updateDevices$)||h.DdM(3,pt))}}let ht=(()=>{class e{constructor(e,t,i,n,o,s,r,c){this.localService=e,this.lookupService=t,this.modalController=i,this.alertController=n,this.popoverController=o,this.deviceInfoService=s,this.deviceUpdateService=r,this.notificationsService=c,this.state$=new K.X({selectedDevices:{}}),this.firmwares$=new K.X({}),this.type="update"}ngOnInit(){return(0,M.mG)(this,void 0,void 0,function*(){this.devices$=this.lookupService.subDeviceList().pipe((0,te.j)((e,t)=>(0,ee.F)(0===t?100:0)),(0,f.U)(e=>[...Object.keys(e)]),(0,P.x)(this.compareKeys),(0,L.w)(e=>this.mapToDeviceInfo(e)),(0,f.U)(e=>this.mapSameDevices(e))),this.checkFirmware(),this.updateDevices$=(0,He.aj)([this.devices$,this.firmwares$]).pipe((0,f.U)(e=>this.deviceUpdateService.checkDevices(e[1],e[0],this.type,this.selectedFirmware)),(0,m.b)(e=>{for(const t of e.deviceInfos)void 0===this.state$.value.selectedDevices[t.id]&&(this.state$.value.selectedDevices[t.id]=!0);for(const t of Object.keys(this.state$.value.selectedDevices))e.deviceInfos.some(e=>e.id===t)||delete this.state$.value.selectedDevices[t];this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}))})}checkFirmware(e){return(0,M.mG)(this,void 0,void 0,function*(){this.state$.value.searching=!0,this.state$.next(this.state$.value);const t=yield this.deviceUpdateService.checkFirmwares();this.firmwares$.next(t),e&&e.target.complete(),this.state$.value.searching=!1,this.state$.next(this.state$.value)})}showInfo(e,t){this.notificationsService.presentCustomToast(e.deviceStatus.update.old_version+"<br/> - <br/>"+(t[e.device.type].version||t[e.device.type].beta_ver),5e3)}selectDevice(e){this.state$.value.selectedDevices[e.id]=!this.state$.value.selectedDevices[e.id],this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}selectAllDevices(e){if(e.length===Object.keys(this.state$.value.selectedDevices).filter(e=>this.state$.value.selectedDevices[e]).length)for(const t of e)this.state$.value.selectedDevices[t.id]=!1;else for(const t of e)this.state$.value.selectedDevices[t.id]=!0;this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}downloadFirmwares(e){return(0,M.mG)(this,void 0,void 0,function*(){yield this.deviceUpdateService.downloadFiles(e)})}closeModal(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss()})}identify(e,t){return t.id}identifyInfo(e,t){var i;return null===(i=t.device)||void 0===i?void 0:i.id}updateDevices(e,t){return(0,M.mG)(this,void 0,void 0,function*(){const i=e.filter(e=>{var t;return(null===(t=e.deviceInfos[0])||void 0===t?void 0:t.deviceConStatus)===N.L.local&&this.state$.value.selectedDevices[e.id]});if(i.length>0){"select"!==this.type&&(yield this.downloadFirmwares(t)),this.state$.value.searching=!0,this.state$.next(this.state$.value);const e=yield this.deviceUpdateService.startDeviceUpdateServer(),n=i.map(i=>{const n=i.deviceInfos[0],o=n.device.type;let s;return s="select"===this.type?this.selectedFirmware:this.deviceUpdateService.getFilename(o,t[o].version||t[o].beta_ver,t[o].url||t[o].beta_url),this.localService.ota(n.device,e+"/"+s,n.ip).pipe((0,xe.V)(1e4)).toPromise().catch(e=>(console.log(e),null))});yield Promise.all(n),yield(0,g.of)().pipe((0,je.g)(5e3)).toPromise(),this.notificationsService.presentCustomToast("app.component.update.done.label",3e3),this.state$.value.searching=!1,this.state$.next(this.state$.value)}else this.notificationsService.presentCustomToast("app.component.update.no-devices.label",3e3)})}presentPopover(e){var t;return(0,M.mG)(this,void 0,void 0,function*(){const i=yield this.popoverController.create({component:ze,event:e,cssClass:"update-settings-popover",translucent:!1,showBackdrop:!0,componentProps:{type:this.type}});yield i.present();const n=yield i.onWillDismiss();this.type=(null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.type)||this.type,"select"===this.type&&(this.selectedFirmware=(yield this.selectFirmware(this.selectedFirmware))||this.selectedFirmware,this.selectedFirmware||(this.type="update")),this.state$.value.selectedDevices={},this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value),this.firmwares$.next(this.firmwares$.value)})}selectFirmware(e){return(0,M.mG)(this,void 0,void 0,function*(){let t,i;const n=(yield this.deviceUpdateService.getFirmareEntries()).map(n=>({name:n,type:"radio",label:n,value:n,checked:e===n,handler:()=>{t=n,i.dismiss()}}));return i=yield this.alertController.create({header:"Select firmware",inputs:n,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{}}]}),yield i.present(),yield i.onWillDismiss(),t})}compareKeys(e,t){return JSON.stringify(e)===JSON.stringify(t)}mapToDeviceInfo(e){const t=e.map(e=>this.deviceInfoService.subDeviceInfoChange(e));return(0,He.aj)(t)}mapSameDevices(e){var t,i;const n={};for(const o of e){const e=null===(i=null===(t=null==o?void 0:o.device)||void 0===t?void 0:t.id)||void 0===i?void 0:i.split("_")[0];n[e]||(n[e]=[]),n[e].push(o)}return Object.keys(n).map(e=>({id:e,deviceInfos:n[e]}))}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(U.C),h.Y36(Ze.W),h.Y36(c.IN),h.Y36(c.Br),h.Y36(c.Dh),h.Y36(oe.H),h.Y36(st),h.Y36(we.T))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-update"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["color","primary",3,"disabled","click"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","settings-outline"],["type","indeterminate",4,"ngIf"],["fullscreen","true","scroll-events",""],["slot","fixed",3,"disabled","ionRefresh"],["id","updateContainer"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"left","5px","top","8px","position","absolute","width","42px","height","42px","padding","12px","z-index","2",3,"click"],["slot","start",3,"indeterminate","checked"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["type","indeterminate"],["mode","md","lines","inset","button","",3,"disabled","click"],[2,"z-index","-1"],[2,"padding","0"],["slot","start",2,"margin-left","5px","margin-right","15px","pointer-events","none",3,"mode","color","ngModel","indeterminate"],["checkbox",""],["color","primary","slot","end","shape","round",1,"infoButton",3,"click"],["slot","icon-only","name","information-outline"],[3,"inView","ping","deviceInfo","showDetails","reorder"],["inView","inView"]],template:function(e,t){1&e&&(h.YNc(0,ut,3,4,"ng-container",0),h.ALo(1,"async")),2&e&&h.Q6J("ngIf",h.lcZ(1,1,t.state$))},directives:[s.O5,c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,c.nJ,c.Wo,c.q_,s.sg,c.fr,c.nz,c.w,c.X7,c.Ie,F.e,c.jY,r.JJ,r.On,c.Nd,se.v,re.z],pipes:[s.Ov,l.X$,rt,s.Nd],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.searchText[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%)}.searchText[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding-bottom:10px}ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%}[_nghost-%COMP%]     app-device{width:100%}[_nghost-%COMP%]     app-device>div>div{margin-bottom:-1px}[_nghost-%COMP%]     app-device>div>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}.infoButton[_ngcontent-%COMP%]{height:25px;width:25px;margin-left:5px;margin-right:12px}ion-item[_ngcontent-%COMP%]{--padding-start: 12px;--inner-padding-end: 0px}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:0}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding:0}ion-checkbox[_ngcontent-%COMP%]{pointer-events:none}.card[_ngcontent-%COMP%]{box-shadow:none!important;padding:0;margin:0;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden;border-radius:0!important}"],changeDetection:0}),e})();var vt=i(90382);const gt=(0,We.fo)("Share",{web:()=>i.e(4648).then(i.bind(i,54648)).then(e=>new e.ShareWeb)});var mt=i(56448);let ft=(()=>{class e{constructor(e,t,i,n,o){this.authService=e,this.alertService=t,this.lookupService=i,this.translateService=n,this.notificationsService=o}shareBackup(){return(0,M.mG)(this,void 0,void 0,function*(){const e=yield this.alertService.addPin(!0);if(!e)return;const t=yield me.A.getInfo(),i=yield this.createBackup(),n=yield this.aesGcmEncrypt(JSON.stringify(i),e.pin);"web"===t.platform||"mac"===t.operatingSystem||"windows"===t.operatingSystem?yield this.downloadBackup({pin:"shellyhome"!==e.pin,data:n},"shelly-home-backup.txt"):yield this.saveBackup({pin:"shellyhome"!==e.pin,data:n},"ShellyHome/shelly-home-backup.txt")})}saveBackup(e,t="ShellyHome/shelly-home-backup.txt"){return(0,M.mG)(this,void 0,void 0,function*(){if(!e)return void this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label");const i=yield me.A.getInfo();let n=Re.tP.External;("mac"===i.operatingSystem||"windows"===i.operatingSystem)&&(n=Re.tP.Documents);const o={path:t,data:JSON.stringify(e),directory:n,recursive:!0,encoding:Re.ez.UTF8},s=yield Re.fy.writeFile(o).catch(()=>(this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label"),null));s&&(this.notificationsService.presentCustomToast("app.component.more.backup-download-success.label"),yield gt.share({title:"Shelly Home Backup",text:"Shelly Home Backup",dialogTitle:"Shelly Home Backup",url:s.uri}))})}createBackup(){return(0,M.mG)(this,void 0,void 0,function*(){const e=yield R.K.keys().then(e=>e.keys),t=yield Promise.all(e.map(e=>R.K.get({key:e}).then(t=>({key:e,value:t.value}))));try{return t.reduce((e,t)=>{let i;try{i=JSON.parse(t.value)}catch(n){i=t.value}return e[t.key]=i,e},{})}catch(i){return null}})}exportBackup(){return(0,M.mG)(this,void 0,void 0,function*(){const e=yield this.createBackup();this.downloadBackup(e,"shelly-home-backup.txt")})}downloadBackup(e,t){if(!e)return void this.notificationsService.presentCustomToast("app.component.more.backup-download-error.label");const i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}loadBackup(){return(0,M.mG)(this,void 0,void 0,function*(){const e=window.document.createElement("input");e.type="file",e.accept="txt",e.style.height="0px",e.style.width="0px",e.style.border="0px",e.style.position="fixed",e.style.top="50%",e.style.left="50%",document.body.appendChild(e),e.click(),e.addEventListener("change",()=>{const t=e.files[0];if(t.type.match(/text.*/)){let i=new FileReader;const n=i._realReader;n&&(i=n),i.onload=()=>(0,M.mG)(this,void 0,void 0,function*(){try{let e=JSON.parse(i.result);if(!1===e.pin||!0===e.pin){const t=e.pin?yield this.alertService.addPin():{pin:"shellyhome"};if(!t)return;e=yield this.aesGcmDecrypt(e.data,t.pin).then(e=>JSON.parse(e))}if(void 0===e.welcome)yield R.K.set({key:"deviceList",value:JSON.stringify(e.deviceList)}),yield R.K.set({key:"deviceStatusList",value:JSON.stringify(e.deviceStatusList)}),yield R.K.set({key:"roomList",value:JSON.stringify(e.roomList)}),yield R.K.set({key:"groupList",value:JSON.stringify(e.groupList)}),yield this.lookupService.init();else{for(const t in e)"string"==typeof e[t]?yield R.K.set({key:t,value:e[t]}):yield R.K.set({key:t,value:JSON.stringify(e[t])});yield this.lookupService.init(),this.authService.login(),this.lookupService.setDarkMode()}this.notificationsService.presentCustomToast("app.component.more.backup-load-success.label")}catch(t){console.error(t),this.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")}document.body.removeChild(e)}),i.readAsText(t)}else document.body.removeChild(e),this.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")})})}writeErrorLog(){return(0,M.mG)(this,void 0,void 0,function*(){const e=localStorage.getItem("errorLog"),t={path:"shelly-home-error-log.txt",data:JSON.stringify(e),directory:Re.tP.Documents,encoding:Re.ez.UTF8};Re.fy.writeFile(t).then(()=>(0,M.mG)(this,void 0,void 0,function*(){const e=yield me.A.getInfo();this.notificationsService.presentCustomToast("app.component.more.report-error-prompt.label"),yield(0,ge.Vs)(2e3);const t=this.translateService.instant("app.component.more.report-error.label"),i=("ios"===e.platform?"iOS":"android"===e.platform?"Android":"Electron")+" Version: "+e.osVersion+"\r\n\r\n"+this.translateService.instant("app.component.more.report-error-body.label")+"\r\n\r\n\r\n\r\n\r\n\r\n";let n="mailto:di.gausma@googlemail.com?subject=";n+=encodeURIComponent(t),n+="&body=",n+=encodeURIComponent(i),window.open(n,"_system")})).catch(()=>{})})}aesGcmEncrypt(e,t){return(0,M.mG)(this,void 0,void 0,function*(){const i=(new TextEncoder).encode(t),n=yield crypto.subtle.digest("SHA-256",i),o=crypto.getRandomValues(new Uint8Array(12)),s=Array.from(o).map(e=>String.fromCharCode(e)).join(""),r={name:"AES-GCM",iv:o},c=yield crypto.subtle.importKey("raw",n,r,!1,["encrypt"]),l=(new TextEncoder).encode(e),a=yield crypto.subtle.encrypt(r,c,l),d=Array.from(new Uint8Array(a)).map(e=>String.fromCharCode(e)).join("");return btoa(s+d)})}aesGcmDecrypt(e,t){return(0,M.mG)(this,void 0,void 0,function*(){const i=(new TextEncoder).encode(t),n=yield crypto.subtle.digest("SHA-256",i),o=atob(e).slice(0,12),s={name:"AES-GCM",iv:new Uint8Array(Array.from(o).map(e=>e.charCodeAt(0)))},r=yield crypto.subtle.importKey("raw",n,s,!1,["decrypt"]),c=atob(e).slice(12),l=new Uint8Array(Array.from(c).map(e=>e.charCodeAt(0)));try{const e=yield crypto.subtle.decrypt(s,r,l);return(new TextDecoder).decode(e)}catch(a){throw new Error("Decrypt failed")}})}}return e.\u0275fac=function(t){return new(t||e)(h.LFG(mt.e),h.LFG(ke.c),h.LFG(Ze.W),h.LFG(l.sK),h.LFG(we.T))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var yt=i(37443);function bt(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e){const e=t.$implicit;h.s9C("value",e),h.xp6(1),h.hij(" ",h.lcZ(2,2,"app.commons.languages["+e+"].label")," ")}}function xt(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",21),h._uU(1),h.qZA()),2&e){const e=t.$implicit;h.s9C("value",e.id),h.xp6(1),h.hij(" ",e.price," ")}}function wt(e,t){if(1&e&&(h.TgZ(0,"ion-badge",22),h._uU(1),h.qZA()),2&e){const e=t.ngIf;h.xp6(1),h.Oqu(e)}}function kt(e,t){1&e&&(h.TgZ(0,"ion-label"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"app.component.more.dark-theme.label")," "))}function Zt(e,t){1&e&&(h.TgZ(0,"ion-label"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"app.component.more.light-theme.label")," "))}function Ct(e,t){1&e&&(h.TgZ(0,"ion-label"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"app.component.more.system-theme.label")," "))}let St=(()=>{class e{constructor(e,t,i,n,o,s,r){this.donateService=e,this.backupService=t,this.lookupService=i,this.popoverService=n,this.translateService=o,this.popoverController=s,this.actionSheetController=r,this.products=[],this.unsubscribe=new T.xQ}ngOnInit(){this.languages=this.translateService.getLangs(),this.products=this.donateService.getProducts(),this.settings=this.lookupService.settings,this.devices$=this.lookupService.subDeviceList().pipe((0,f.U)(e=>{var t;return null===(t=Object.keys(e).filter(t=>!e[t].room_id&&!t.includes("_")))||void 0===t?void 0:t.length}))}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}applyZoom(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.dismiss(),this.lookupService.applyZoomFactor(),this.lookupService.setSettings(this.settings)})}onClickAddDevices(){this.popoverService.presentModal(Ee,!0),this.dismiss()}onClickSearch(){this.popoverService.presentModal(Be.g,!0),this.dismiss()}onClickUpdateDevices(){this.popoverService.presentModal(ht,!0),this.dismiss()}onClickToggleTheme(){!0===this.settings.darkTheme?this.settings.darkTheme=!1:!1===this.settings.darkTheme?this.settings.darkTheme=void 0:null==this.settings.darkTheme&&(this.settings.darkTheme=!0),this.lookupService.setSettings(this.settings),this.lookupService.setDarkMode()}onLangChange(e){this.translateService.use(e),this.settings.language=e,this.lookupService.setSettings(this.settings)}onClickDonate(e){return(0,M.mG)(this,void 0,void 0,function*(){"android"===(yield me.A.getInfo()).platform?e.open():window.open("https://github.com/digaus/shellyhome-i18n/blob/master/README.md","_system","location=yes")})}onClickReportError(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.backupService.writeErrorLog()})}onDonate(e){return(0,M.mG)(this,void 0,void 0,function*(){e&&this.donateService.order(e),this.product=null})}onClickBackup(){return(0,M.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({header:this.translateService.instant("app.component.more.backup.header.label"),buttons:[{text:this.translateService.instant("app.component.more.backup-do.label"),icon:"arrow-redo",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){this.backupService.shareBackup()})},{text:this.translateService.instant("app.component.more.backup-load.label"),icon:"arrow-undo",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){yield this.backupService.loadBackup()})},{text:this.translateService.instant("app.component.more.cancel.label"),role:"cancel",icon:"close",handler:()=>{console.log("Cancel clicked")}}]})).present()})}dismiss(){return(0,M.mG)(this,void 0,void 0,function*(){yield this.popoverController.dismiss()})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(vt.x),h.Y36(ft),h.Y36(Ze.W),h.Y36(yt.X),h.Y36(l.sK),h.Y36(c.Dh),h.Y36(c.BX))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-more"]],decls:67,vars:52,consts:[[2,"display","none"],["slot","end",3,"okText","cancelText","ngModel","ngModelChange"],["langSelect",""],[3,"value",4,"ngFor","ngForOf"],["donateSelect",""],["mode","md","lines","none","button","","detail","false",3,"click"],["color","primary","name","wifi","slot","start"],["color","primary","name","search","slot","start"],["slot","end",4,"ngIf"],["color","primary","name","sync","slot","start"],["color","primary","name","mail","slot","start",2,"height","20px"],["color","primary","name","repeat","slot","start"],["color","primary","name","contrast","slot","start"],[4,"ngIf"],["color","primary","name","heart","slot","start"],["color","primary","name","globe","slot","start"],["mode","md","lines","none","detail","false"],[1,"zoomDiv"],["min","100","max","150",2,"padding","28px 0 0 0",3,"pin","ngModel","ngModelChange","touchend","mouseup"],["color","primary","name","remove-circle-outline","slot","start"],["color","primary","name","add-circle-outline","slot","end"],[3,"value"],["slot","end"]],template:function(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-item",0),h.TgZ(1,"ion-label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"ion-select",1,2),h.NdJ("ngModelChange",function(e){return t.settings.language=e})("ngModelChange",function(e){return t.onLangChange(e)}),h.ALo(6,"translate"),h.ALo(7,"translate"),h.YNc(8,bt,3,4,"ion-select-option",3),h.qZA(),h.qZA(),h.TgZ(9,"ion-item",0),h.TgZ(10,"ion-label"),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.TgZ(13,"ion-select",1,4),h.NdJ("ngModelChange",function(e){return t.product=e})("ngModelChange",function(e){return t.onDonate(e)}),h.ALo(15,"translate"),h.ALo(16,"translate"),h.YNc(17,xt,2,2,"ion-select-option",3),h.qZA(),h.qZA(),h.TgZ(18,"ion-list"),h.TgZ(19,"ion-item",5),h.NdJ("click",function(){return t.onClickAddDevices()}),h._UZ(20,"ion-icon",6),h.TgZ(21,"ion-label"),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.qZA(),h.TgZ(24,"ion-item",5),h.NdJ("click",function(){return t.onClickSearch()}),h._UZ(25,"ion-icon",7),h.TgZ(26,"ion-label"),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.YNc(29,wt,2,1,"ion-badge",8),h.ALo(30,"async"),h.qZA(),h.TgZ(31,"ion-item",5),h.NdJ("click",function(){return t.onClickUpdateDevices()}),h._UZ(32,"ion-icon",9),h.TgZ(33,"ion-label"),h._uU(34),h.ALo(35,"translate"),h.qZA(),h.qZA(),h.TgZ(36,"ion-item",5),h.NdJ("click",function(){return t.onClickReportError()}),h._UZ(37,"ion-icon",10),h.TgZ(38,"ion-label"),h._uU(39),h.ALo(40,"translate"),h.qZA(),h.qZA(),h.TgZ(41,"ion-item",5),h.NdJ("click",function(){return t.onClickBackup()}),h._UZ(42,"ion-icon",11),h.TgZ(43,"ion-label"),h._uU(44),h.ALo(45,"translate"),h.qZA(),h.qZA(),h.TgZ(46,"ion-item",5),h.NdJ("click",function(){return t.onClickToggleTheme()}),h._UZ(47,"ion-icon",12),h.YNc(48,kt,3,3,"ion-label",13),h.YNc(49,Zt,3,3,"ion-label",13),h.YNc(50,Ct,3,3,"ion-label",13),h.qZA(),h.TgZ(51,"ion-item",5),h.NdJ("click",function(){h.CHM(e);const i=h.MAs(14);return t.onClickDonate(i)}),h._UZ(52,"ion-icon",14),h.TgZ(53,"ion-label"),h._uU(54),h.ALo(55,"translate"),h.qZA(),h.qZA(),h.TgZ(56,"ion-item",5),h.NdJ("click",function(){return h.CHM(e),h.MAs(5).open()}),h._UZ(57,"ion-icon",15),h.TgZ(58,"ion-label"),h._uU(59),h.ALo(60,"translate"),h.qZA(),h.qZA(),h.TgZ(61,"ion-item",16),h.TgZ(62,"div",17),h._uU(63),h.qZA(),h.TgZ(64,"ion-range",18),h.NdJ("ngModelChange",function(e){return t.settings.zoomFactor=e})("touchend",function(){return t.applyZoom()})("mouseup",function(){return t.applyZoom()}),h._UZ(65,"ion-icon",19),h._UZ(66,"ion-icon",20),h.qZA(),h.qZA(),h.qZA()}2&e&&(h.xp6(2),h.Oqu(h.lcZ(3,24,"app.component.more.language.label")),h.xp6(2),h.Q6J("okText",h.lcZ(6,26,"app.commons.confirm.label"))("cancelText",h.lcZ(7,28,"app.commons.cancel.label"))("ngModel",t.settings.language),h.xp6(4),h.Q6J("ngForOf",t.languages),h.xp6(3),h.Oqu(h.lcZ(12,30,"app.component.more.donate.label")),h.xp6(2),h.Q6J("okText",h.lcZ(15,32,"app.commons.confirm.label"))("cancelText",h.lcZ(16,34,"app.commons.cancel.label"))("ngModel",t.product),h.xp6(4),h.Q6J("ngForOf",t.products),h.xp6(5),h.hij(" ",h.lcZ(23,36,"app.component.more.add-devices.label")," "),h.xp6(5),h.hij(" ",h.lcZ(28,38,"app.component.more.search-devices.label")," "),h.xp6(2),h.Q6J("ngIf",h.lcZ(30,40,t.devices$)),h.xp6(5),h.hij(" ",h.lcZ(35,42,"app.component.more.update-devices.label")," "),h.xp6(5),h.hij(" ",h.lcZ(40,44,"app.component.more.report-error.label")," "),h.xp6(5),h.hij(" ",h.lcZ(45,46,"app.component.more.backup.label")," "),h.xp6(4),h.Q6J("ngIf",!0===(null==t.settings?null:t.settings.darkTheme)),h.xp6(1),h.Q6J("ngIf",!1===(null==t.settings?null:t.settings.darkTheme)),h.xp6(1),h.Q6J("ngIf",null==(null==t.settings?null:t.settings.darkTheme)),h.xp6(4),h.Oqu(h.lcZ(55,48,"app.component.more.donate.label")),h.xp6(5),h.hij("",h.lcZ(60,50,"app.commons.languages["+(null==t.settings?null:t.settings.language)+"].label")," "),h.xp6(4),h.hij("",t.settings.zoomFactor||"100","%"),h.xp6(1),h.Q6J("pin",!0)("ngModel",t.settings.zoomFactor))},directives:[c.Ie,c.Q$,c.t9,c.QI,r.JJ,r.On,s.sg,c.q_,F.e,c.gu,s.O5,c.I_,c.n0,c.yp],pipes:[l.X$,s.Ov],styles:["ion-item[_ngcontent-%COMP%]:not(:last-child){height:38px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.md[_ngcontent-%COMP%]{margin-right:15px;margin-top:2px}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-icon.ios[_ngcontent-%COMP%]{margin-right:15px;margin-top:0}ion-item[_ngcontent-%COMP%]:not(:last-child)   ion-label.ios[_ngcontent-%COMP%]{margin-top:4px}ion-item[_ngcontent-%COMP%]:not(:last-child) > *[_ngcontent-%COMP%]{margin-top:-2px}ion-item[_ngcontent-%COMP%]:not(:last-child) > ion-badge[_ngcontent-%COMP%]{margin-top:-12px;border-radius:10px;padding-top:4px}ion-list.list-ios[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}  .md.more-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.more-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios .action-sheet-icon{position:absolute!important;left:10px}.zoomDiv[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(calc(-50% - 10px))}"],changeDetection:0}),e})();var It=i(65754),_t=i(62411),At=i(46662),Mt=i(3001);let Tt=(()=>{class e{constructor(e){this.lookupService=e}transform(e){return this.lookupService.subRoomList().pipe((0,f.U)(t=>t[e]))}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(Ze.W,16))},e.\u0275pipe=h.Yjl({name:"room",type:e,pure:!0}),e})(),Ot=(()=>{class e{constructor(e){this.lookupService=e}transform(e){return this.lookupService.subGroupList().pipe((0,f.U)(t=>t[e]))}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(Ze.W,16))},e.\u0275pipe=h.Yjl({name:"group",type:e,pure:!0}),e})();const Pt=["slides"];function Lt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-fab-button",20),h.NdJ("click",function(){return h.CHM(e),h.oxw(2).removeDashboard()}),h._UZ(1,"ion-icon",21),h.qZA()}}function Dt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-slide",22),h.NdJ("click",function(){return h.CHM(e),h.oxw(2).addDashboard()}),h.TgZ(1,"ion-title",23),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"app.component.dashboard.empty-list.label")," "))}function $t(e,t){1&e&&(h.TgZ(0,"ion-title",23),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"app.component.dashboard.empty.label")," "))}function Jt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-fab-button",33),h.NdJ("click",function(){h.CHM(e);const t=h.oxw().index,i=h.oxw().index,n=h.oxw(2).index;return h.oxw(2).removeElement(n,i,t)}),h._UZ(1,"ion-icon",34),h.qZA()}}function Nt(e,t){1&e&&(h.TgZ(0,"div",41),h._UZ(1,"ion-icon",42),h._UZ(2,"div"),h.qZA())}function Ut(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",43),h.TgZ(1,"ion-fab-button",44),h.NdJ("click",function(){const t=h.CHM(e).$implicit,i=h.oxw(3).index,n=h.oxw().index,o=h.oxw(2).index;return h.oxw(2).customizeElement(o,n,i,t)}),h._UZ(2,"ion-icon",45),h.qZA(),h.qZA()}}const qt=function(){return["open"]};function Ft(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"app-device",37,38),h.NdJ("dashboardSettingsChange",function(t){const i=h.CHM(e).ngIf;return h.oxw(2).$implicit.devices[null==i||null==i.device?null:i.device.id]=t})("dashboardSettingsChange",function(){return h.CHM(e),h.oxw(7).saveSettings()}),h.ALo(2,"async"),h.YNc(3,Nt,3,0,"div",39),h.YNc(4,Ut,3,0,"ng-template",null,40,h.W1O),h.qZA()}if(2&e){const e=t.ngIf,i=h.MAs(1),n=h.oxw(2).$implicit,o=h.oxw(5);h.Q6J("allow",h.DdM(9,qt))("ping",h.lcZ(2,7,i.isInView))("deviceInfo",e)("dashboardSettings",n.devices[null==e||null==e.device?null:e.device.id])("showDetails",!1)("reorder",o.reorder),h.xp6(3),h.Q6J("ngIf",o.reorder)}}function Qt(e,t){if(1&e&&(h.TgZ(0,"ion-card",35),h.YNc(1,Ft,6,10,"app-device",36),h.ALo(2,"async"),h.ALo(3,"deviceInfo"),h.qZA()),2&e){const e=h.oxw().$implicit;h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,h.lcZ(3,3,e.key)))}}function Gt(e,t){1&e&&(h.TgZ(0,"div",41),h._UZ(1,"ion-icon",42),h._UZ(2,"div"),h.qZA())}function Yt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",43),h.TgZ(1,"ion-fab-button",44),h.NdJ("click",function(){const t=h.CHM(e).$implicit,i=h.oxw(3).index,n=h.oxw().index,o=h.oxw(2).index;return h.oxw(2).customizeElement(o,n,i,t)}),h._UZ(2,"ion-icon",45),h.qZA(),h.qZA()}}const Et=function(){return[]};function Bt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"app-room",48,38),h.NdJ("dashboardSettingsChange",function(t){return h.CHM(e),h.oxw(2).$implicit.devices=t})("dashboardSettingsChange",function(){return h.CHM(e),h.oxw(7).saveSettings()})("select",function(){h.CHM(e);const t=h.oxw(2).index,i=h.oxw().index,n=h.oxw(2).index;return h.oxw(2).collapsedChanged(n,i,t)})("controlButtonsChange",function(){h.CHM(e);const t=h.oxw(2).index,i=h.oxw().index,n=h.oxw(2).index;return h.oxw(2).controlButtonsChanged(n,i,t)}),h.ALo(2,"async"),h.YNc(3,Gt,3,0,"div",39),h.YNc(4,Yt,3,0,"ng-template",null,49,h.W1O),h.qZA()}if(2&e){const e=t.ngIf,i=h.MAs(1),n=h.oxw(2).$implicit,o=h.oxw(5);h.ekj("collapsed",n.collapsed)("not-collapsed",!n.collapsed),h.Q6J("ping",h.lcZ(2,12,i.isInView))("room",e)("allow",h.DdM(14,Et))("reorder",o.reorder)("collapsed",n.collapsed)("dashboardSettings",n.devices)("controlButtons",n.controlButtons),h.xp6(3),h.Q6J("ngIf",o.reorder)}}function Ht(e,t){if(1&e&&(h.TgZ(0,"div",46),h.YNc(1,Bt,6,15,"app-room",47),h.ALo(2,"async"),h.ALo(3,"room"),h.qZA()),2&e){const e=h.oxw().$implicit;h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,h.lcZ(3,3,e.key)))}}function jt(e,t){1&e&&(h.TgZ(0,"div",41),h._UZ(1,"ion-icon",42),h._UZ(2,"div"),h.qZA())}function zt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",43),h.TgZ(1,"ion-fab-button",44),h.NdJ("click",function(){const t=h.CHM(e).$implicit,i=h.oxw(3).index,n=h.oxw().index,o=h.oxw(2).index;return h.oxw(2).customizeElement(o,n,i,t)}),h._UZ(2,"ion-icon",45),h.qZA(),h.qZA()}}function Vt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"app-group",51,38),h.NdJ("dashboardSettingsChange",function(t){return h.CHM(e),h.oxw(2).$implicit.devices=t})("dashboardSettingsChange",function(){return h.CHM(e),h.oxw(7).saveSettings()})("select",function(){h.CHM(e);const t=h.oxw(2).index,i=h.oxw().index,n=h.oxw(2).index;return h.oxw(2).collapsedChanged(n,i,t)})("controlButtonsChange",function(){h.CHM(e);const t=h.oxw(2).index,i=h.oxw().index,n=h.oxw(2).index;return h.oxw(2).controlButtonsChanged(n,i,t)}),h.ALo(2,"async"),h.YNc(3,jt,3,0,"div",39),h.YNc(4,zt,3,0,"ng-template",null,52,h.W1O),h.qZA()}if(2&e){const e=t.ngIf,i=h.MAs(1),n=h.oxw(2).$implicit,o=h.oxw(5);h.ekj("collapsed",n.collapsed)("not-collapsed",!n.collapsed),h.Q6J("ping",h.lcZ(2,12,i.isInView))("group",e)("allow",h.DdM(14,Et))("reorder",o.reorder)("collapsed",n.collapsed)("dashboardSettings",n.devices)("controlButtons",n.controlButtons),h.xp6(3),h.Q6J("ngIf",o.reorder)}}function Wt(e,t){if(1&e&&(h.TgZ(0,"div",46),h.YNc(1,Vt,6,15,"app-group",50),h.ALo(2,"async"),h.ALo(3,"group"),h.qZA()),2&e){const e=h.oxw().$implicit;h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,h.lcZ(3,3,e.key)))}}function Rt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",29),h.NdJ("cdkDragStarted",function(){return h.CHM(e),h.oxw(5).onDragStart()}),h.YNc(1,Jt,2,0,"ion-fab-button",30),h.YNc(2,Qt,4,5,"ion-card",31),h.YNc(3,Ht,4,5,"div",32),h.YNc(4,Wt,4,5,"div",32),h.qZA()}if(2&e){const e=t.$implicit,i=h.oxw(5);h.Q6J("cdkDragData",e)("cdkDragDisabled",!i.reorder),h.xp6(1),h.Q6J("ngIf",i.reorder),h.xp6(1),h.Q6J("ngIf","device"===e.type),h.xp6(1),h.Q6J("ngIf","room"===e.type),h.xp6(1),h.Q6J("ngIf","group"===e.type)}}function Xt(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-col",26),h.NdJ("cdkDropListDropped",function(t){return h.CHM(e),h.oxw(4).drop(t)})("click",function(){const t=h.CHM(e).$implicit,i=h.oxw(4);return null!=t&&t.length?null:i.onClickAdd()}),h.ALo(1,"dropListConnected"),h.ALo(2,"async"),h.ALo(3,"async"),h.YNc(4,$t,3,3,"ion-title",27),h.YNc(5,Rt,5,6,"div",28),h.qZA()}if(2&e){const e=t.$implicit,i=t.index,n=h.oxw(2).$implicit,o=h.oxw(2);h.Udp("width",100/n.cols.length+"%"),h.Q6J("cdkDropListData",e)("cdkDropListConnectedTo",h.xi3(1,8,n.cols,h.lcZ(2,11,o.currentSlide$)))("id","dashboard"+h.lcZ(3,13,o.currentSlide$)+"Col"+i),h.xp6(4),h.Q6J("ngIf",!(null!=e&&e.length)),h.xp6(1),h.Q6J("ngForOf",e)("ngForTrackBy",o.identify)}}function Kt(e,t){if(1&e&&(h.TgZ(0,"ion-row"),h.YNc(1,Xt,6,15,"ion-col",25),h.qZA()),2&e){const e=h.oxw().$implicit,t=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",e.cols)("ngForTrackBy",t.identifyIndex)}}function ei(e,t){if(1&e&&(h.TgZ(0,"ion-slide"),h.TgZ(1,"ion-grid",24),h.TgZ(2,"ion-list"),h.YNc(3,Kt,2,2,"ion-row",0),h.ALo(4,"async"),h.qZA(),h.qZA(),h.qZA()),2&e){const e=t.index,i=h.oxw(2);h.xp6(3),h.Q6J("ngIf",h.lcZ(4,1,i.currentSlide$)===e)}}function ti(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-header",1),h.TgZ(2,"ion-toolbar"),h.TgZ(3,"ion-buttons",2),h.TgZ(4,"ion-menu-button",3),h._UZ(5,"ion-icon",4),h.qZA(),h.TgZ(6,"ion-button",5),h.NdJ("click",function(){return h.CHM(e),h.oxw().selectUser()}),h.ALo(7,"async"),h._UZ(8,"ion-icon",6),h.qZA(),h.qZA(),h.TgZ(9,"ion-title",7),h._uU(10,"Dashboard"),h.qZA(),h.TgZ(11,"ion-buttons",8),h.TgZ(12,"ion-button",9),h.NdJ("click",function(){h.CHM(e);const t=h.MAs(22),i=h.oxw();return i.reorder=!i.reorder,null==t?null:t.lockSwipes(i.reorder)}),h._UZ(13,"ion-icon",10),h.qZA(),h.TgZ(14,"ion-button",5),h.NdJ("click",function(){return h.CHM(e),h.oxw().onClickAdd()}),h._UZ(15,"ion-icon",11),h.qZA(),h.TgZ(16,"ion-button",5),h.NdJ("click",function(t){return h.CHM(e),h.oxw().presentPopover(t)}),h._UZ(17,"ion-icon",12),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(18,"ion-content",13),h.TgZ(19,"ion-fab",14),h.YNc(20,Lt,2,0,"ion-fab-button",15),h.qZA(),h.TgZ(21,"ion-slides",16,17),h.NdJ("ionSlideDidChange",function(){return h.CHM(e),h.oxw().slidesDidChange()}),h.YNc(23,Dt,4,3,"ion-slide",18),h.YNc(24,ei,5,3,"ion-slide",19),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=t.ngIf,i=h.oxw();h.xp6(4),h.Q6J("menu","first"),h.xp6(2),h.Q6J("disabled",i.reorder||"connecting"===h.lcZ(7,9,i.cloudStatus$)),h.xp6(7),h.Q6J("name",i.reorder?"checkmark-done-sharp":"create-outline"),h.xp6(1),h.Q6J("disabled",i.reorder),h.xp6(2),h.Q6J("disabled",i.reorder),h.xp6(4),h.Q6J("ngIf",i.reorder),h.xp6(1),h.Q6J("options",i.slideConfig),h.xp6(2),h.Q6J("ngIf",!(null!=e&&e.length)),h.xp6(1),h.Q6J("ngForOf",e)}}const ii=[{path:"",component:(()=>{class e{constructor(e,t,i,n,o,s,r,c,l){this.renderer2=e,this.authService=t,this.alertService=i,this.lookupService=n,this.modalController=o,this.translateService=s,this.deviceInfoService=r,this.popoverController=c,this.actionSheetController=l,this.slideConfig={slidesPerView:1,centeredSlides:!0},this.currentSlide$=new K.X(0)}ngOnInit(){V.g.addListener("appStateChange",e=>{e.isActive&&this.slides.update()}),W.c.hide(),R.K.set({key:It.Q.welcome,value:"done"}),this.deviceInfoService.init(),this.dashboardList$=this.lookupService.subDashboardList().pipe((0,f.U)(e=>(e.forEach(e=>e.cols.forEach(e=>e.forEach(e=>{e.devices=e.devices||{},e.collapsed=e.collapsed||!1,e.controlButtons=e.controlButtons||!1}))),e)),(0,m.b)(e=>{var t;e[this.currentSlide$.value]||null===(t=this.slides)||void 0===t||t.slideTo(0)})),this.cloudStatus$=this.authService.cloudStatus.asObservable()}selectUser(){var e,t;return(0,M.mG)(this,void 0,void 0,function*(){if((null===(t=null===(e=this.lookupService.userList)||void 0===e?void 0:e.users)||void 0===t?void 0:t.length)>0){const e=yield this.alertService.selectUser(this.lookupService.userList);if(e){this.lookupService.selectUser(e);const t=[R.K.set({key:It.Q.email,value:e.email}),R.K.set({key:It.Q.password,value:e.password})];yield Promise.all(t),yield this.authService.login(null,null)}}else yield(yield this.modalController.create({component:ve.b})).present()})}removeElement(e,t,i){this.lookupService.dashboardList[e].cols[t].splice(i,1),this.lookupService.setDashboardList(this.lookupService.dashboardList)}customizeElement(e,t,i,n){var o,s,r,c;return(0,M.mG)(this,void 0,void 0,function*(){const l=yield this.modalController.create({component:de,cssClass:"dashboardModal",componentProps:{deviceId:n,selectedLayout:null===(r=null===(s=null===(o=this.lookupService.dashboardList[e].cols[t][i])||void 0===o?void 0:o.devices)||void 0===s?void 0:s[n])||void 0===r?void 0:r.layout}});yield l.present();const a=yield l.onWillDismiss();a.data&&(this.lookupService.dashboardList[e].cols[t][i].devices[n]=Object.assign(Object.assign({},this.lookupService.dashboardList[e].cols[t][i].devices[n]),{layout:null===(c=a.data)||void 0===c?void 0:c.selectedLayout}),this.lookupService.dashboardList[e].cols[t][i]=(0,X.cloneDeep)(this.lookupService.dashboardList[e].cols[t][i]),this.lookupService.setDashboardList(this.lookupService.dashboardList))})}collapsedChanged(e,t,i){this.lookupService.dashboardList[e].cols[t][i].collapsed=!this.lookupService.dashboardList[e].cols[t][i].collapsed,this.lookupService.setDashboardList(this.lookupService.dashboardList)}controlButtonsChanged(e,t,i){return(0,M.mG)(this,void 0,void 0,function*(){yield(0,ge.Vs)(1),this.lookupService.dashboardList[e].cols[t][i].controlButtons=!this.lookupService.dashboardList[e].cols[t][i].controlButtons,this.lookupService.setDashboardList(this.lookupService.dashboardList)})}saveSettings(){this.lookupService.setDashboardList(this.lookupService.dashboardList),this.lookupService.setSettings(this.lookupService.settings)}presentPopover(e){var t;return(0,M.mG)(this,void 0,void 0,function*(){const i=yield this.popoverController.create({component:St,event:e,cssClass:"more-popover",translucent:!1,showBackdrop:!0});yield i.present(),yield i.onDidDismiss(),yield(0,ge.Vs)(200),null===(t=this.slides)||void 0===t||t.update()})}addDashboard(){return(0,M.mG)(this,void 0,void 0,function*(){const e=yield this.alertService.addDashboard();if(e.cols){const t=Array.from({length:e.cols}).map(()=>[]);this.lookupService.dashboardList.push({cols:t}),this.lookupService.setDashboardList(this.lookupService.dashboardList),yield(0,ge.Vs)(200),this.slides.slideTo(this.lookupService.dashboardList.length+1)}})}drop(e){e.previousContainer===e.container?(0,n.bA)(e.container.data,e.previousIndex,e.currentIndex):(0,n.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.lookupService.setDashboardList(this.lookupService.dashboardList)}identifyIndex(e,t){return e}identify(e,t){const i=Object.keys(t.devices).map(e=>t.devices[e].layout).join(",");return t.key+t.type+i}onDragStart(){this.renderer2.setStyle(document.getElementsByClassName("cdk-drag-placeholder")[0],"height",document.getElementsByClassName("cdk-drag-preview")[0].clientHeight+"px")}slidesDidChange(){return(0,M.mG)(this,void 0,void 0,function*(){const e=yield this.slides.getActiveIndex();yield(0,ge.Vs)(100),this.currentSlide$.next(e)})}removeDashboard(){return(0,M.mG)(this,void 0,void 0,function*(){this.reorder=!1,yield this.slides.lockSwipes(!1),this.lookupService.dashboardList.splice(this.currentSlide$.value,1),this.lookupService.dashboardList=[...this.lookupService.dashboardList],this.lookupService.setDashboardList(this.lookupService.dashboardList),this.currentSlide$.value>=1?yield this.slides.slideTo(this.currentSlide$.value-1):this.lookupService.dashboardList.length>1&&(yield this.slides.slideTo(0))})}onClickAdd(){var e,t,i,n,o,s;return(0,M.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({mode:"ios",header:this.translateService.instant("app.component.dashboard.edit.header.label"),buttons:[{cssClass:(null===(t=null===(e=this.lookupService)||void 0===e?void 0:e.dashboardList)||void 0===t?void 0:t.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-device.header.label"),icon:"cog-outline",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){this.openDevices()})},{cssClass:(null===(n=null===(i=this.lookupService)||void 0===i?void 0:i.dashboardList)||void 0===n?void 0:n.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-room.header.label"),icon:"home-outline",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){this.openRooms()})},{cssClass:(null===(s=null===(o=this.lookupService)||void 0===o?void 0:o.dashboardList)||void 0===s?void 0:s.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-group.header.label"),icon:"copy-outline",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){this.openGroups()})},{text:this.translateService.instant("app.component.dashboard.add-dashboard.header.label"),icon:"duplicate-outline",handler:()=>(0,M.mG)(this,void 0,void 0,function*(){this.addDashboard()})},{text:this.translateService.instant("app.component.dashboard.cancel.header.label"),role:"cancel",icon:"close",handler:()=>{}}]})).present()})}openRooms(){return(0,M.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:he.g,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}})).present()})}openGroups(){return(0,M.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:ue.B,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}})).present()})}openDevices(){return(0,M.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:pe.Z,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}})).present()})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(h.Qsj),h.Y36(mt.e),h.Y36(ke.c),h.Y36(Ze.W),h.Y36(c.IN),h.Y36(l.sK),h.Y36(oe.H),h.Y36(c.Dh),h.Y36(c.BX))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-dashboard"]],viewQuery:function(e,t){if(1&e&&(h.Gf(Pt,5),h.Gf(c.W2,5)),2&e){let e;h.iGM(e=h.CRH())&&(t.slides=e.first),h.iGM(e=h.CRH())&&(t.ionContents=e)}},decls:2,vars:3,consts:[[4,"ngIf"],["translucent","true",1,"ion-no-border"],["slot","start"],["color","primary",3,"menu"],["slot","icon-only","name","menu-outline"],["color","primary",3,"disabled","click"],["slot","icon-only","name","people-outline",2,"transform","scaleX(-1)"],["color","primary"],["slot","end"],["color","primary",3,"click"],["slot","icon-only",3,"name"],["slot","icon-only","name","add"],["slot","icon-only","md","ellipsis-vertical-outline","ios","ellipsis-horizontal-outline"],[2,"--overflow","hidden"],["mode","md","vertical","bottom","horizontal","end","slot","fixed"],["size","small","color","danger",3,"click",4,"ngIf"],["pager","true",3,"options","ionSlideDidChange"],["slides",""],["style","height: calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top));",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["size","small","color","danger",3,"click"],["name","trash-outline"],[2,"height","calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top))",3,"click"],["mode","ios",1,"empty"],["cdkScrollable","","scroll-events","",1,"scrollContent"],["class","dashboardCol","cdkDropList","",3,"width","cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDropList","",1,"dashboardCol",3,"cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click"],["mode","ios","class","empty",4,"ngIf"],["class","dragElement","cdkDrag","",3,"cdkDragData","cdkDragDisabled","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dragElement",3,"cdkDragData","cdkDragDisabled","cdkDragStarted"],["class","remove","color","danger",3,"click",4,"ngIf"],["class","card",4,"ngIf"],["class","wrapper",4,"ngIf"],["color","danger",1,"remove",3,"click"],["name","close",1,"remove-icon"],[1,"card"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange",4,"ngIf"],["inView","",3,"allow","ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange"],["inView","inView"],["cdkDragHandle","",4,"ngIf"],["customize",""],["cdkDragHandle",""],["name","move-outline"],[1,"controlButton"],["color","success","fill","clear","size","small",1,"smallFab",3,"click"],["name","settings-outline"],[1,"wrapper"],["inView","",3,"ping","room","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","room","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeRoom",""],["inView","",3,"ping","group","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","group","allow","reorder","collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["customizeGroup",""]],template:function(e,t){1&e&&(h.YNc(0,ti,25,11,"ng-container",0),h.ALo(1,"async")),2&e&&h.Q6J("ngIf",h.lcZ(1,1,t.dashboardList$))},directives:[s.O5,c.Gu,c.sr,c.Sm,c.fG,c.gu,c.YG,c.wd,c.W2,c.IJ,F.e,c.Hr,s.sg,c.W4,c.A$,c.jY,o.PQ,c.q_,c.Nd,c.wI,n.Wj,n.Zt,c.PM,se.v,re.z,n.Bh,_t.Y,At.m],pipes:[s.Ov,l.X$,Mt.j,H.B,Tt,Ot],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-background-color)}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center}ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{background:var(--ion-background-color)}[_nghost-%COMP%]{background:#fff;background:var(--ion-background-color, #fff)}[_nghost-%COMP%]     app-device   .reorderLabel   p{padding-right:105px}  .header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.add[_ngcontent-%COMP%]{height:3px;width:calc(50% - 75px);top:50%;position:absolute;max-width:200px}.add.right[_ngcontent-%COMP%]{left:calc(50% + 50px);background:linear-gradient(to left,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.add.left[_ngcontent-%COMP%]{right:calc(50% + 50px);background:linear-gradient(to right,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.addText[_ngcontent-%COMP%]{width:100%;color:var(--ion-color-primary);top:calc(50% - 75px);position:absolute;left:0;text-align:center}  .swiper-pagination{position:fixed!important;pointer-events:none}.scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 57px - var(--ion-safe-area-bottom));overflow-y:auto;width:100%}.ios[_ngcontent-%COMP%]   .scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 44px - var(--ion-safe-area-bottom))}.card[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item{border-radius:4px}.card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item::part(native){box-shadow:#0003 0 3px 1px -2px,#00000024 0 2px 2px,#0000001f 0 1px 5px;-webkit-font-smoothing:antialiased;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragElement[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{font-size:31px;position:absolute;right:11px;top:11px;z-index:1;background:var(--ion-color-base)}.cdk-drag-handle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;top:0;left:0}.dragElement[_ngcontent-%COMP%]{position:relative;margin:15px 5px}.dragElement[_ngcontent-%COMP%]:last-child{margin-bottom:calc(50px + var(--ion-safe-area-bottom))}  .ios .action-sheet-icon{position:absolute!important;left:10px}ion-fab-button.remove[_ngcontent-%COMP%]{position:absolute;transform:scale(.6);z-index:2;opacity:.8;bottom:-16px;left:calc(50% - 16px);width:35px;height:35px}  .disabledAction{pointer-events:none;opacity:.5}.ios[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 64px - var(--ion-safe-area-bottom))}.md[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 70px - var(--ion-safe-area-bottom))}ion-slide[_ngcontent-%COMP%], ion-grid[_ngcontent-%COMP%], ion-list[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%]{padding-top:0}.controlButton[_ngcontent-%COMP%]{margin-right:-5px;width:45px;display:block;height:40px;padding-top:.1px;position:absolute;right:46px;top:5px;z-index:10}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]::part(native){background:transparent;box-shadow:none}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]{margin:3px 3px 3px 5.5px;margin-right:0!important;height:34px;width:34px;opacity:.7;--ion-color-contrast: var(--ion-color-base) !important}.controlButton[_ngcontent-%COMP%]   .smallFab[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{transform:scale(.8)}"],changeDetection:0}),e})()}];let ni=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[z.Bz.forChild(ii)],z.Bz]}),e})(),oi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[s.ez,r.u5,c.Pc,A,j,n._t,o.Cl,l.aw,ni]]}),e})()}}]);