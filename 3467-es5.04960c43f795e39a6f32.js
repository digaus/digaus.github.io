!function(){"use strict";function e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function t(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function n(e){var t="function"==typeof Map?new Map:void 0;return(n=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,a(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e)})(e)}function i(e,t,n){return(i=r()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&o(r,n.prototype),r}).apply(null,arguments)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkShellyHome=self.webpackChunkShellyHome||[]).push([[3467],{93467:function(i,s,l){l.r(s),l.d(s,{DashboardPageModule:function(){return nn}});var u=l(77310),v=l(1275),f=l(38583),h=l(3679),g=l(92859),m=l(29790),x=l(72458),k=(l(46237),l(37716));l(4765);var b,w=((b=function e(){p(this,e)}).\u0275fac=function(e){return new(e||b)},b.\u0275mod=k.oAB({type:b}),b.\u0275inj=k.cJS({imports:[[x.si,x.BQ],x.BQ]}),b),y=l(7539),Z=l(98295),C=(l(39490),l(25917)),S=(l(40205),l(35758),l(75319),l(93342)),I=l(88002),A=(l(5304),l(68939)),M=(l(18819),l(15257),l(91841)),_=l(39075),T=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[x.BQ],x.BQ]}),e}(),O=l(49983),P=l(22850);l(36461),l(80521),l(70946);var J=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[f.ez,x.BQ],x.BQ]}),e}(),R=l(69129),D=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[f.ez]]}),e}(),L=l(64762),q=l(79765),N=l(54395),F=l(87519),U=l(43190),Q=l(46782),G=l(28049),B=l(22557),Y=l(59353),E=l(27773),j=l(16873);function H(e,t){if(1&e&&(k.TgZ(0,"ion-item",8),k.TgZ(1,"ion-row",9),k._UZ(2,"ion-col"),k.TgZ(3,"ion-col",10),k._uU(4),k.qZA(),k._UZ(5,"ion-col",11),k.qZA(),k.qZA()),2&e){var n=k.oxw(2);k.xp6(4),k.hij(" ",null==n.deviceInfo||null==n.deviceInfo.deviceStatus||null==n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel]?null:n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel].gain," % ")}}function z(e,t){if(1&e&&(k.TgZ(0,"ion-item",8),k.TgZ(1,"ion-row",9),k._UZ(2,"ion-col"),k.TgZ(3,"ion-col",10),k._uU(4),k.qZA(),k._UZ(5,"ion-col",11),k.qZA(),k.qZA()),2&e){var n=k.oxw(2);k.xp6(4),k.hij(" ",((null==n.deviceInfo||null==n.deviceInfo.deviceStatus||null==n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel]?null:n.deviceInfo.deviceStatus.lights[null==n.deviceInfo||null==n.deviceInfo.device?null:n.deviceInfo.device.channel].white)/2.55).toFixed(0)," % ")}}function V(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-item",1),k.NdJ("touchstart",function(){return k.CHM(n),k.oxw().touch(!0)})("mousedown",function(){return k.CHM(n),k.oxw().mouse(!0)})("touchend",function(){return k.CHM(n),k.oxw().touch(!1)})("mouseup",function(){return k.CHM(n),k.oxw().mouse(!1)}),k._UZ(2,"input",2),k.qZA(),k.YNc(3,H,6,1,"ion-item",3),k.TgZ(4,"ion-item",4),k.TgZ(5,"ion-range",5),k.NdJ("touchstart",function(){return k.CHM(n),k.oxw().touch(!0)})("mousedown",function(){return k.CHM(n),k.oxw().mouse(!0)})("touchend",function(){return k.CHM(n),k.oxw().touch(!1)})("mouseup",function(){return k.CHM(n),k.oxw().mouse(!1)}),k._UZ(6,"ion-icon",6),k._UZ(7,"ion-icon",7),k.qZA(),k.qZA(),k.YNc(8,z,6,1,"ion-item",3),k.TgZ(9,"ion-item",4),k.TgZ(10,"ion-range",5),k.NdJ("touchstart",function(){return k.CHM(n),k.oxw().touch(!0)})("mousedown",function(){return k.CHM(n),k.oxw().mouse(!0)})("touchend",function(){return k.CHM(n),k.oxw().touch(!1)})("mouseup",function(){return k.CHM(n),k.oxw().mouse(!1)}),k._UZ(11,"ion-icon",6),k._UZ(12,"ion-icon",7),k.qZA(),k.qZA(),k.BQk()}if(2&e){var i=k.oxw();k.xp6(3),k.Q6J("ngIf",i.showCurrent),k.xp6(1),k.Udp("margin-top",i.showCurrent?"-40px":"-20px"),k.xp6(1),k.Q6J("formControl",i.formControlGain),k.xp6(3),k.Q6J("ngIf",i.showCurrent),k.xp6(1),k.Udp("margin-top",i.showCurrent?"-40px":"-20px"),k.xp6(1),k.Q6J("formControl",i.formControlWhite)}}var W=function(){var e=function(){function e(t,n,i){p(this,e),this.elementRef=t,this.localService=n,this.deviceService=i,this.showCurrent=!0,this.formControlGain=new h.NI(null,null,this.onLightGainValidatorFn()),this.formControlWhite=new h.NI(null,null,this.onLightWhiteValidatorFn()),this.color=new q.xQ,this.unsubscribe=new q.xQ}return d(e,[{key:"ngOnChanges",value:function(){var e,t,n,i,r,o,a,c,s,l,u,d,p,v;if(!this.dragging&&!this.mousedown&&(null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights)){this.formControlGain.setValue(null===(o=null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceStatus)||void 0===i?void 0:i.lights[null===(r=this.deviceInfo)||void 0===r?void 0:r.device.channel])||void 0===o?void 0:o.gain,{emitEvent:!1}),this.formControlWhite.setValue((null===(l=null===(c=null===(a=this.deviceInfo)||void 0===a?void 0:a.deviceStatus)||void 0===c?void 0:c.lights[null===(s=this.deviceInfo)||void 0===s?void 0:s.device.channel])||void 0===l?void 0:l.white)/2.55,{emitEvent:!1});var f=null===(d=null===(u=this.deviceInfo)||void 0===u?void 0:u.deviceStatus)||void 0===d?void 0:d.lights[null===(v=null===(p=this.deviceInfo)||void 0===p?void 0:p.device)||void 0===v?void 0:v.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(f.red,",").concat(f.green,",").concat(f.blue,")"))}}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){var e,t,n,i,r,o,a,c,s=this;if($("#colorpicker").wheelColorPicker({htmlOptions:!0}),null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.device)||void 0===i?void 0:i.channel]){var l=null===(o=null===(r=this.deviceInfo)||void 0===r?void 0:r.deviceStatus)||void 0===o?void 0:o.lights[null===(c=null===(a=this.deviceInfo)||void 0===a?void 0:a.device)||void 0===c?void 0:c.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(l.red,",").concat(l.green,",").concat(l.blue,")"))}$("#colorpicker").on("slidermove",function(){var e=$("#colorpicker").get(0).value.slice(4,-1).split(",");s.color.next({red:+e[0],green:+e[1],blue:+e[2]})}),this.color.pipe((0,N.b)(50),(0,F.x)(),(0,U.w)(function(e){return(0,C.of)(s.onLightColor(e))}),(0,Q.R)(this.unsubscribe)).subscribe()}},{key:"touch",value:function(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.dragging=e}},{key:"mouse",value:function(e){var t;null===(t=this.elementRef.nativeElement.closest("ion-slides"))||void 0===t||t.lockSwipes(e),this.mousedown=e}},{key:"onLightGainValidatorFn",value:function(){var e=this;return function(t){return t.valueChanges?t.valueChanges.pipe((0,N.b)(50),(0,F.x)(),(0,U.w)(function(t){return(0,C.of)(e.onLightGain(t))}),(0,G.P)()):(0,C.of)(null)}}},{key:"onLightWhiteValidatorFn",value:function(){var e=this;return function(t){return t.valueChanges?t.valueChanges.pipe((0,N.b)(50),(0,F.x)(),(0,U.w)(function(t){return(0,C.of)(e.onLightWhite(+(2.55*t).toFixed(0)))}),(0,G.P)()):(0,C.of)(null)}}},{key:"onLightWhite",value:function(e){var t,n;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===B.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(function(){return r.onErrorWhite()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===B.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightWhite(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(function(){return r.onErrorWhite()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onLightGain",value:function(e){var t,n;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===B.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e,this.deviceInfo.ip).toPromise().catch(function(){return r.onErrorGain()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===B.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightGain(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e).toPromise().catch(function(){return r.onErrorGain()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onLightColor",value:function(e){var t,n;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=(null===(t=this.deviceInfo)||void 0===t?void 0:t.deviceConStatus)===B.L.local,!i.t0){i.next=4;break}return i.next=4,this.localService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue,this.deviceInfo.ip).toPromise().catch(function(){return r.onErrorColor()});case 4:if(i.t1=(null===(n=this.deviceInfo)||void 0===n?void 0:n.deviceConStatus)===B.L.cloud,!i.t1){i.next=8;break}return i.next=8,this.deviceService.controlLightColor(this.deviceInfo.device,this.deviceInfo.deviceStatus,this.deviceInfo.device.channel,e.red,e.green,e.blue).toPromise().catch(function(){return r.onErrorColor()});case 8:case"end":return i.stop()}},i,this)}))}},{key:"onErrorGain",value:function(){var e,t,n,i;this.formControlGain.setValue(null===(i=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(n=this.deviceInfo)||void 0===n?void 0:n.device.channel])||void 0===i?void 0:i.gain,{emitEvent:!1})}},{key:"onErrorWhite",value:function(){var e,t,n,i;this.formControlGain.setValue(null===(i=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(n=this.deviceInfo)||void 0===n?void 0:n.device.channel])||void 0===i?void 0:i.white,{emitEvent:!1})}},{key:"onErrorColor",value:function(){var e,t,n,i,r=null===(t=null===(e=this.deviceInfo)||void 0===e?void 0:e.deviceStatus)||void 0===t?void 0:t.lights[null===(i=null===(n=this.deviceInfo)||void 0===n?void 0:n.device)||void 0===i?void 0:i.channel];$("#colorpicker").wheelColorPicker("setValue","rgb(".concat(r.red,",").concat(r.green,",").concat(r.blue,")"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(k.SBq),k.Y36(Y.C),k.Y36(E.U))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-color-content"]],inputs:{deviceInfo:"deviceInfo",showCurrent:"showCurrent"},features:[k.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"touchstart","mousedown","touchend","mouseup"],["id","colorpicker","type","text","data-wheelcolorpicker","","data-wcp-sliders","hws","data-wcp-layout","block","data-wcp-format","rgb"],["mode","md","lines","none","style","z-index: 1;",4,"ngIf"],["mode","md",2,"margin-top","-40px","--background","none","margin-bottom","-20px"],["id","range","mode","md","min","1","max","100","step","1","pin","true",3,"formControl","touchstart","mousedown","touchend","mouseup"],["size","small","slot","start","name","sunny","color","medium"],["slot","end","name","sunny","color","medium"],["mode","md","lines","none",2,"z-index","1"],[2,"width","100%"],[2,"text-align","center"],[2,"text-align","right"]],template:function(e,t){1&e&&k.YNc(0,V,13,8,"ng-container",0),2&e&&k.Q6J("ngIf","light"===(null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.category)&&(null==t.deviceInfo||null==t.deviceInfo.deviceStatus?null:t.deviceInfo.deviceStatus.lights)&&"color"===(null==t.deviceInfo||null==t.deviceInfo.deviceStatus||null==t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel]?null:t.deviceInfo.deviceStatus.lights[null==t.deviceInfo||null==t.deviceInfo.device?null:t.deviceInfo.device.channel].mode))},directives:[f.O5,g.Ie,j.e,g.I_,g.QI,h.JJ,h.oH,g.gu,g.Nd,g.wI],styles:[".control-light .popover-content{width:321px!important;max-width:321px!important}  ion-item>.jQWCP-wWidget.jQWCP-block{width:270px!important;height:195px;border:none;background:none;box-shadow:none;left:50%;transform:translate(-50%);margin:8px}[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;padding-bottom:10px}ion-item[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{padding-bottom:0;--knob-size: 25px;--bar-height: 3px;--knob-handle-size: 45px}ion-item.ios[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{--knob-handle-size: 40px;padding-bottom:1px;padding-top:44px}  .jQWCP-wWidget{outline:none!important}"],changeDetection:0}),e}(),X=l(18343),K=l(66255),ee=l(14503),te=l(73580),ne=l(77220),ie=["ssid"],re=["key"];function oe(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-input",8,9),k.NdJ("ngModelChange",function(e){return k.CHM(n),k.oxw().deviceSettingsEdit.wifi_sta.ssid=e}),k.qZA()}if(2&e){var i=k.oxw();k.Q6J("ngModel",i.deviceSettingsEdit.wifi_sta.ssid)}}function ae(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-input",10,11),k.NdJ("ngModelChange",function(e){return k.CHM(n),k.oxw().deviceSettingsEdit.wifi_sta.key=e}),k.qZA()}if(2&e){var i=k.oxw();k.Q6J("ngModel",i.deviceSettingsEdit.wifi_sta.key)}}var ce=function(){var e=function(){function e(t){p(this,e),this.notificationsService=t}return d(e,[{key:"ngOnChanges",value:function(e){e.deviceSettings&&(this.deviceSettingsEdit=JSON.parse(JSON.stringify(this.deviceSettings)))}},{key:"onWifiClientSave",value:function(){}},{key:"onClickSave",value:function(){this.deviceSettingsEdit.wifi_sta.key?this.onWifiClientSave():this.notificationsService.presentCustomToast("app.shelly-home.settings.key.required.label")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(ne.T))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-connectivity"]],viewQuery:function(e,t){var n;(1&e&&(k.Gf(ie,5),k.Gf(re,5)),2&e)&&(k.iGM(n=k.CRH())&&(t.ssid=n.first),k.iGM(n=k.CRH())&&(t.key=n.first))},inputs:{device:"device",deviceCon:"deviceCon",deviceSettings:"deviceSettings"},features:[k.TTD],decls:16,vars:11,consts:[[2,"padding-left","15px","padding-top","0","padding-bottom","0"],["mode","md",3,"click"],["name","wifi","slot","start"],["type","text","slot","end",3,"ngModel","ngModelChange",4,"ngIf"],["mode","md","lines","none",3,"click"],["name","lock-closed","slot","start"],["type","password","slot","end",3,"ngModel","ngModelChange",4,"ngIf"],["expand","full","fill","clear",3,"click"],["type","text","slot","end",3,"ngModel","ngModelChange"],["ssid",""],["type","password","slot","end",3,"ngModel","ngModelChange"],["key",""]],template:function(e,t){1&e&&(k.TgZ(0,"ion-list",0),k.TgZ(1,"ion-item",1),k.NdJ("click",function(){return t.ssid?t.ssid.setFocus():null}),k._UZ(2,"ion-icon",2),k.TgZ(3,"ion-label"),k._uU(4),k.ALo(5,"translate"),k.qZA(),k.YNc(6,oe,2,1,"ion-input",3),k.qZA(),k.TgZ(7,"ion-item",4),k.NdJ("click",function(){return t.key?t.key.setFocus():null}),k._UZ(8,"ion-icon",5),k.TgZ(9,"ion-label"),k._uU(10),k.ALo(11,"translate"),k.qZA(),k.YNc(12,ae,2,1,"ion-input",6),k.qZA(),k.qZA(),k.TgZ(13,"ion-button",7),k.NdJ("click",function(){return t.onClickSave()}),k._uU(14),k.ALo(15,"translate"),k.qZA()),2&e&&(k.xp6(4),k.hij(" ",k.lcZ(5,5,"app.shelly-home.settings.ssid.label")," "),k.xp6(2),k.Q6J("ngIf",t.deviceSettingsEdit),k.xp6(4),k.hij(" ",k.lcZ(11,7,"app.shelly-home.settings.key.label")," "),k.xp6(2),k.Q6J("ngIf",t.deviceSettingsEdit),k.xp6(2),k.hij(" ",k.lcZ(15,9,"app.shelly-home.settings.save.label"),""))},directives:[g.q_,g.Ie,j.e,g.gu,g.Q$,f.O5,g.YG,g.pK,g.j9,h.JJ,h.On],pipes:[m.X$],styles:["ion-list.list-ios[_ngcontent-%COMP%]{margin-bottom:0}ion-button[_ngcontent-%COMP%]{border-top:1px solid lightgray;margin:0;height:45px}"],changeDetection:0}),e}(),se=l(55173),le=l(85454),ue=l(70775),de=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[g.Pc,D,h.u5,h.UX,f.ez,m.aw,u._t,T,w,Z.lN,y.p9,O.c,J,R.yI,P.LD,u._t,v.Cl,le.vQ]]}),e}();k.B6R(se.f,[f.O5,g.Gu,g.sr,g.td,te.v,g.Sm,g.YG,g.gu,g.X7,g.W2,g.q_,ee.P,W,K.u,g.rH,j.e,ce,g.Ie,g.Q$],[f.Ov,ue.B,m.X$]),k.B6R(X.M,[g.W2,W],[f.Ov,ue.B]);var pe=l(63423),ve=l(88592),fe=l(96628),he=l(42138),ge=l(26215),me=l(89968),xe=l(29379),ke=l(99119),be=l(97722),we=l(42810),ye=l(23806),Ze=l(52580),Ce=l(20945),Se=l(58071),Ie=l(11627),Ae=l(56149),Me=["ip"];function _e(e,t){1&e&&(k.ynx(0),k._uU(1,"Search current network"),k.BQk())}function Te(e,t){if(1&e&&(k.ynx(0),k._uU(1),k.BQk()),2&e){var n=t.ngIf;k.xp6(1),k.hij("",n,".1 - 254")}}function Oe(e,t){1&e&&(k.ynx(0),k._uU(1),k.ALo(2,"translate"),k.BQk()),2&e&&(k.xp6(1),k.Oqu(k.lcZ(2,1,"IP not identified")))}function Pe(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"mat-form-field",17),k.TgZ(1,"input",18),k.NdJ("ngModelChange",function(e){return k.CHM(n),k.oxw().$implicit.ip=e})("keyup.enter",function(){return k.CHM(n),k.oxw(),k.MAs(9).focus()}),k.qZA(),k.qZA()}if(2&e){var i=k.oxw().$implicit;k.xp6(1),k.Q6J("ngModel",i.ip)("dropSpecialCharacters",!1)}}function Je(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"mat-form-field",17),k.TgZ(1,"input",18,19),k.NdJ("ngModelChange",function(e){return k.CHM(n),k.oxw().$implicit.ip=e})("keyup.enter",function(){return k.CHM(n),k.oxw(),k.MAs(9).focus()}),k.qZA(),k.qZA()}if(2&e){var i=k.oxw().$implicit;k.xp6(1),k.Q6J("ngModel",i.ip)("dropSpecialCharacters",!1)}}function Re(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-item",0),k.NdJ("click",function(){var e=k.CHM(n).$implicit;return e.active=!e.active}),k.TgZ(1,"ion-checkbox",8),k.NdJ("ngModelChange",function(e){return k.CHM(n).$implicit.active=e}),k.qZA(),k.TgZ(2,"div",9),k.NdJ("click",function(e){return e.stopImmediatePropagation()}),k.YNc(3,Pe,2,2,"mat-form-field",10),k.YNc(4,Je,3,2,"mat-form-field",10),k.TgZ(5,"div",11),k._uU(6," - "),k.qZA(),k.TgZ(7,"mat-form-field",12),k.TgZ(8,"input",13,14),k.NdJ("ngModelChange",function(e){return k.CHM(n).$implicit.to=e}),k.qZA(),k.qZA(),k.qZA(),k.TgZ(10,"ion-buttons",4),k.NdJ("click",function(e){return e.stopPropagation()}),k.TgZ(11,"ion-button",15),k.NdJ("click",function(e){var t=k.CHM(n).index,i=k.oxw();return e.stopPropagation(),i.removeRange(t)}),k._UZ(12,"ion-icon",16),k.qZA(),k.qZA(),k.qZA()}if(2&e){var i=t.$implicit,r=t.index,o=k.oxw();k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel",i.active),k.xp6(2),k.Q6J("ngIf",r!==(null==o.settings.searchSettings.ranges?null:o.settings.searchSettings.ranges.length)-1),k.xp6(1),k.Q6J("ngIf",r===(null==o.settings.searchSettings.ranges?null:o.settings.searchSettings.ranges.length)-1),k.xp6(4),k.Q6J("ngModel",i.to)("min",null==i||null==i.ip?null:i.ip.split(".")[3])}}var De=function(){var e=function(){function e(t){p(this,e),this.lookupService=t,this.currentIp$=new ge.X(null),this.editIndex=-1}return d(e,[{key:"ngOnInit",value:function(){this.settings=this.lookupService.settings,!this.currentIp&&this.settings.searchSettings.currentIp&&(this.failed=!0),this.currentIp$.next(this.currentIp||null)}},{key:"addIpRange",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.settings.searchSettings.ranges[this.settings.searchSettings.ranges.length-1],e.t0=!t||(null==t?void 0:t.ip)&&t.to,!e.t0){e.next=9;break}return this.settings.searchSettings.ranges=this.settings.searchSettings.ranges||[],this.settings.searchSettings.ranges.push({active:!0,ip:"",to:null}),this.settings.searchSettings.ranges=c(this.settings.searchSettings.ranges),this.editIndex=this.settings.searchSettings.ranges.length-1,e.next=9,(0,be.Vs)(100);case 9:this.ip.nativeElement.focus();case 10:case"end":return e.stop()}},e,this)}))}},{key:"removeRange",value:function(e){this.settings.searchSettings.ranges.splice(e,1),this.settings.searchSettings.ranges=c(this.settings.searchSettings.ranges),this.saveSettings()}},{key:"toggleCurrentIp",value:function(){var e,t;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.settings.searchSettings.currentIp=!this.settings.searchSettings.currentIp,!this.settings.searchSettings.currentIp){n.next=7;break}return n.next=3,Ze.k.getIP().then(function(e){return e.ip}).catch(function(){return null});case 3:i=n.sent,this.currentIp$.next(null===(t=null===(e=null==i?void 0:i.split("."))||void 0===e?void 0:e.slice(0,-1))||void 0===t?void 0:t.join(".")),i||(this.failed=!0,this.currentIp$.next(null)),n.next=8;break;case 7:this.currentIp$.next(null),this.failed=!1;case 8:this.saveSettings();case 9:case"end":return n.stop()}},n,this)}))}},{key:"ngOnDestroy",value:function(){this.saveSettings()}},{key:"saveSettings",value:function(){var e;this.settings.searchSettings.ranges=null===(e=this.settings.searchSettings.ranges)||void 0===e?void 0:e.filter(function(e){return e.ip&&e.to}),this.lookupService.setSettings(this.settings)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(Ae.W))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-search-settings"]],viewQuery:function(e,t){var n;(1&e&&k.Gf(Me,5),2&e)&&(k.iGM(n=k.CRH())&&(t.ip=n.first))},decls:15,vars:16,consts:[["mode","md","button","","lines","none",3,"detail","click"],["slot","start",2,"pointer-events","none","margin-left","5px","margin-right","20px",3,"ngModel","color","indeterminate"],["color","primary",2,"text-align","center"],[4,"ngIf"],["slot","end",2,"margin-inline-start","5px",3,"click"],["color","primary",1,"addButton",3,"click"],["color","primary","name","add-outline",2,"transform","scale(1.5)"],["mode","md","button","","lines","none",3,"detail","click",4,"ngFor","ngForOf"],["slot","start",2,"margin-left","5px","margin-right","20px","pointer-events","none",3,"ngModel","ngModelChange"],[3,"click"],["appearance","fill","style","width: calc(100% - 70px);float: left;",4,"ngIf"],[2,"width","20px","float","left","line-height","40px","padding","7px"],["appearance","fill",2,"width","50px","float","left"],["matInput","","inputmode","numeric","pattern","[0-9.]*","type","text","max","255","mask","999",3,"ngModel","min","ngModelChange"],["to",""],["color","danger",1,"addButton",3,"click"],["color","danger","name","trash-outline",2,"transform","scale(1)"],["appearance","fill",2,"width","calc(100% - 70px)","float","left"],["inputmode","decimal","pattern","[0-9.]*","autofocus","true","matInput","","mask","IP",3,"ngModel","dropSpecialCharacters","ngModelChange","keyup.enter"],["ip",""]],template:function(e,t){1&e&&(k.TgZ(0,"div"),k.TgZ(1,"ion-item",0),k.NdJ("click",function(){return t.toggleCurrentIp()}),k._UZ(2,"ion-checkbox",1),k.ALo(3,"async"),k.ALo(4,"async"),k.TgZ(5,"ion-label",2),k.YNc(6,_e,2,0,"ng-container",3),k.YNc(7,Te,2,1,"ng-container",3),k.ALo(8,"async"),k.YNc(9,Oe,3,3,"ng-container",3),k.ALo(10,"async"),k.qZA(),k.TgZ(11,"ion-buttons",4),k.NdJ("click",function(e){return e.stopPropagation()}),k.TgZ(12,"ion-button",5),k.NdJ("click",function(e){return e.stopPropagation(),t.addIpRange()}),k._UZ(13,"ion-icon",6),k.qZA(),k.qZA(),k.qZA(),k.YNc(14,Re,13,6,"ion-item",7),k.qZA()),2&e&&(k.xp6(1),k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel",t.settings.searchSettings.currentIp)("color",t.settings.searchSettings.currentIp&&null===k.lcZ(3,8,t.currentIp$)?"danger":null)("indeterminate",t.settings.searchSettings.currentIp&&null===k.lcZ(4,10,t.currentIp$)),k.xp6(4),k.Q6J("ngIf",!t.settings.searchSettings.currentIp),k.xp6(1),k.Q6J("ngIf",k.lcZ(8,12,t.currentIp$)),k.xp6(2),k.Q6J("ngIf",t.failed||t.settings.searchSettings.currentIp&&null===k.lcZ(10,14,t.currentIp$)),k.xp6(5),k.Q6J("ngForOf",t.settings.searchSettings.ranges))},directives:[g.Ie,j.e,g.nz,g.w,h.JJ,h.On,g.Q$,f.O5,g.Sm,g.YG,g.gu,f.sg,Z.KE,O.Nt,R.hx,h.Fj,h.c5],pipes:[f.Ov,m.X$],styles:[".md.search-settings-popover .popover-content{margin-top:-42px;min-width:300px}  .ios.search-settings-popover .popover-content{min-width:340px}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),e}(),Le=l(28243),$e=l(2699);function qe(e,t){1&e&&k._UZ(0,"ion-icon",15)}function Ne(e,t){1&e&&k._UZ(0,"ion-icon",16)}function Fe(e,t){if(1&e&&k._UZ(0,"ion-progress-bar",17),2&e){var n=k.oxw().ngIf;k.Q6J("value",null==n?null:n.progress)}}function Ue(e,t){if(1&e&&(k.TgZ(0,"p",4),k._uU(1),k.qZA()),2&e){var n=k.oxw().ngIf;k.xp6(1),k.AsE("",null==n?null:n.currentIp,".1 - ",null==n?null:n.currentIp,".254")}}function Qe(e,t){1&e&&(k.TgZ(0,"p",4),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e&&(k.xp6(1),k.Oqu(k.lcZ(2,1,"IP not identified")))}function Ge(e,t){if(1&e&&(k.ynx(0),k._uU(1),k.BQk()),2&e){var n=k.oxw().$implicit;k.xp6(1),k.AsE(" ",n.ip," - ",n.ip.split(".").slice(0,-1).join(".")+"."+n.to," ")}}function Be(e,t){if(1&e&&(k.TgZ(0,"p",4),k.YNc(1,Ge,2,2,"ng-container",0),k.qZA()),2&e){var n=t.$implicit;k.xp6(1),k.Q6J("ngIf",n.active&&n.ip&&n.to)}}function Ye(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-card",19),k.TgZ(2,"app-device",20,21),k.NdJ("click",function(e){k.CHM(n);var t=k.MAs(4);return"locked"!==k.oxw().ngIf.deviceConStatus?t.onClickEdit():t.onClickUnlock(e)}),k.ALo(5,"async"),k.qZA(),k.qZA(),k.BQk()}if(2&e){var i=k.MAs(3),r=k.oxw().ngIf;k.xp6(2),k.Q6J("inView","#searchContainer")("ping",k.lcZ(5,5,i.isInView))("deviceInfo",r)("showDetails",!1)("reorder",!1)}}function Ee(e,t){if(1&e&&(k.ynx(0),k.YNc(1,Ye,6,7,"ng-container",0),k.BQk()),2&e){var n=t.ngIf;k.xp6(1),k.Q6J("ngIf",n&&!(null!=n.device&&n.device.name))}}function je(e,t){if(1&e&&(k.ynx(0),k.YNc(1,Ee,2,1,"ng-container",0),k.ALo(2,"async"),k.ALo(3,"deviceInfo"),k.BQk()),2&e){var n=t.$implicit;k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,k.lcZ(3,3,n)))}}function He(e,t){if(1&e&&(k.TgZ(0,"ion-list"),k.YNc(1,je,4,5,"ng-container",18),k.qZA()),2&e){var n=t.ngIf;k.xp6(1),k.Q6J("ngForOf",n)}}function ze(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-header"),k.TgZ(2,"ion-toolbar"),k.TgZ(3,"ion-buttons",1),k.TgZ(4,"ion-button",2),k.NdJ("click",function(){return k.CHM(n),k.oxw().closeModal()}),k._UZ(5,"ion-icon",3),k.qZA(),k.qZA(),k.TgZ(6,"ion-title",4),k._uU(7),k.ALo(8,"translate"),k.qZA(),k.TgZ(9,"ion-buttons",5),k.TgZ(10,"ion-button",2),k.NdJ("click",function(){var e=k.CHM(n).ngIf,t=k.oxw();return e.searching?t.cancel():t.search()}),k.YNc(11,qe,1,0,"ion-icon",6),k.YNc(12,Ne,1,0,"ion-icon",7),k.qZA(),k.TgZ(13,"ion-button",2),k.NdJ("click",function(e){return k.CHM(n),k.oxw().presentPopover(e)}),k._UZ(14,"ion-icon",8),k.qZA(),k.qZA(),k.YNc(15,Fe,1,1,"ion-progress-bar",9),k.qZA(),k.qZA(),k.TgZ(16,"ion-content",10),k.TgZ(17,"ion-refresher",11),k.NdJ("ionRefresh",function(e){return k.CHM(n),k.oxw().search(e)}),k._UZ(18,"ion-refresher-content"),k.qZA(),k.TgZ(19,"div",12),k.YNc(20,Ue,2,2,"p",13),k.YNc(21,Qe,3,3,"p",13),k.YNc(22,Be,2,1,"p",14),k.qZA(),k.YNc(23,He,2,1,"ion-list",0),k.ALo(24,"async"),k.qZA(),k.BQk()}if(2&e){var i=t.ngIf,r=k.oxw();k.xp6(7),k.hij(" ",k.lcZ(8,9,"app.component.more.search-devices.label")," "),k.xp6(4),k.Q6J("ngIf",i.searching),k.xp6(1),k.Q6J("ngIf",!i.searching),k.xp6(3),k.Q6J("ngIf",i.searching),k.xp6(2),k.Q6J("disabled",i.searching),k.xp6(3),k.Q6J("ngIf",(null==i||null==i.settings?null:i.settings.searchSettings.currentIp)&&(null==i?null:i.currentIp)),k.xp6(1),k.Q6J("ngIf",(null==i||null==i.settings?null:i.settings.searchSettings.currentIp)&&(null==i?null:i.failed)),k.xp6(1),k.Q6J("ngForOf",null==i||null==i.settings?null:i.settings.searchSettings.ranges),k.xp6(1),k.Q6J("ngIf",k.lcZ(24,11,r.devices$))}}var Ve=function(){var e=function(){function e(t,n,i,r){p(this,e),this.lookupService=t,this.modalController=n,this.popoverController=i,this.deviceInfoService=r,this.state$=new ge.X({})}return d(e,[{key:"ngOnInit",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state$.value.settings=this.lookupService.settings,this.state$.next(this.state$.value),this.devices$=this.lookupService.subDeviceList().pipe((0,Ie.j)(function(e,t){return(0,Ce.F)(0===t?1:0)}),(0,I.U)(function(e){return Object.keys(e)}),(0,F.x)(this.compareKeys)),e.next=5,this.search();case 5:case"end":return e.stop()}},e,this)}))}},{key:"ngOnDestroy",value:function(){var e;null===(e=this.cancelHandle)||void 0===e||e.unsubscribe()}},{key:"search",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state$.value.searching=!0,this.state$.next(this.state$.value),t.t0=this.lookupService.settings.searchSettings.currentIp,!t.t0){t.next=9;break}return t.next=6,Ze.k.getIP().then(function(e){return e.ip}).catch(function(){return null});case 6:(n=t.sent)?(this.state$.value.failed=!1,this.state$.value.currentIp=n.split(".").slice(0,-1).join(".")):this.state$.value.failed=!0,this.state$.next(this.state$.value);case 9:i=0,r=(this.lookupService.settings.searchSettings.ranges||[]).filter(function(e){return e.active}).map(function(e){var t=+e.ip.split(".").pop(),n=e.to;return i+=n-t,o.deviceInfoService.pingNetwork(e.ip,t,n)}),n&&(0,254,r.push(this.deviceInfoService.pingNetwork(n,0,254)),i+=254),r.length>0?(this.state$.value.progress=0,this.state$.next(this.state$.value),this.cancelHandle=Se.z.apply(void 0,c(r)).pipe((0,A.x)(function(){o.state$.value.searching=!1,o.state$.next(o.state$.value),e&&e.target.complete()}),(0,S.b)(function(e){o.state$.value.progress+=e.length/i,o.state$.next(o.state$.value)})).subscribe()):(this.state$.value.searching=!1,this.state$.next(this.state$.value),e&&e.target.complete());case 13:case"end":return t.stop()}},t,this)}))}},{key:"cancel",value:function(){this.ngOnDestroy()}},{key:"closeModal",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}},{key:"presentPopover",value:function(e){var t,n,i,r;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function o(){var a,c;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.t0=this.lookupService.settings.searchSettings.currentIp,!o.t0){o.next=7;break}return o.next=4,Ze.k.getIP().then(function(e){return e.ip}).catch(function(){return null});case 4:(a=o.sent)?(this.state$.value.failed=!1,this.state$.value.currentIp=a.split(".").slice(0,-1).join(".")):this.state$.value.failed=!0,this.state$.next(this.state$.value);case 7:return console.log(a,null===(n=null===(t=null==a?void 0:a.split("."))||void 0===t?void 0:t.slice(0,-1))||void 0===n?void 0:n.join(".")),o.next=10,this.popoverController.create({component:De,event:e,cssClass:"search-settings-popover",translucent:!1,showBackdrop:!0,componentProps:{currentIp:null===(r=null===(i=null==a?void 0:a.split("."))||void 0===i?void 0:i.slice(0,-1))||void 0===r?void 0:r.join(".")}});case 10:return c=o.sent,o.next=13,c.present();case 13:return o.next=15,c.onWillDismiss();case 15:this.state$.value.settings=this.lookupService.settings,this.state$.next(this.state$.value);case 17:case"end":return o.stop()}},o,this)}))}},{key:"compareKeys",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(Ae.W),k.Y36(g.IN),k.Y36(g.Dh),k.Y36(Le.H))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-search"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["slot","icon-only","name","stop-outline",4,"ngIf"],["slot","icon-only","name","reload-outline",4,"ngIf"],["slot","icon-only","name","settings-outline"],[3,"value",4,"ngIf"],["id","searchContainer","scroll-events",""],["slot","fixed",3,"disabled","ionRefresh"],[1,"searchText"],["color","primary",4,"ngIf"],["color","primary",4,"ngFor","ngForOf"],["slot","icon-only","name","stop-outline"],["slot","icon-only","name","reload-outline"],[3,"value"],[4,"ngFor","ngForOf"],[1,"dummyCard"],[3,"inView","ping","deviceInfo","showDetails","reorder","click"],["inView","inView","deviceComp",""]],template:function(e,t){1&e&&(k.YNc(0,ze,25,13,"ng-container",0),k.ALo(1,"async")),2&e&&k.Q6J("ngIf",k.lcZ(1,1,t.state$))},directives:[f.O5,g.Gu,g.sr,g.Sm,g.YG,g.gu,g.wd,g.W2,g.nJ,g.Wo,f.sg,g.X7,g.q_,g.PM,te.v,$e.z],pipes:[f.Ov,m.X$,ue.B],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.searchText[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%);white-space:nowrap}.searchText[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding-bottom:10px}ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.dummyCard[_ngcontent-%COMP%]{box-shadow:none!important;padding:0;margin:0;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden;border-radius:0!important}"],changeDetection:0}),e}(),We=l(9112),Xe=l(64010),Ke=l(65792),et=function(){var e=function(){function e(t){p(this,e),this.popoverController=t,this.type="update"}return d(e,[{key:"confirm",value:function(){this.popoverController.dismiss({type:this.type})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(g.Dh))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-update-settings"]],decls:17,vars:8,consts:[["mode","md","button","","lines","none",3,"detail","click"],["slot","start",2,"pointer-events","none","margin-left","5px","margin-right","20px",3,"ngModel"],["color","primary",2,"text-align","center","padding-right","25px"]],template:function(e,t){1&e&&(k.TgZ(0,"div"),k.TgZ(1,"ion-item",0),k.NdJ("click",function(){return t.type="update",t.confirm()}),k._UZ(2,"ion-checkbox",1),k.TgZ(3,"ion-label",2),k._uU(4," Latest "),k.qZA(),k.qZA(),k.TgZ(5,"ion-item",0),k.NdJ("click",function(){return t.type="beta",t.confirm()}),k._UZ(6,"ion-checkbox",1),k.TgZ(7,"ion-label",2),k._uU(8," Beta "),k.qZA(),k.qZA(),k.TgZ(9,"ion-item",0),k.NdJ("click",function(){return t.type="revert",t.confirm()}),k._UZ(10,"ion-checkbox",1),k.TgZ(11,"ion-label",2),k._uU(12," Revert Beta "),k.qZA(),k.qZA(),k.TgZ(13,"ion-item",0),k.NdJ("click",function(){return t.type="select",t.confirm()}),k._UZ(14,"ion-checkbox",1),k.TgZ(15,"ion-label",2),k._uU(16," Select firmware "),k.qZA(),k.qZA(),k.qZA()),2&e&&(k.xp6(1),k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel","update"===t.type),k.xp6(3),k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel","beta"===t.type),k.xp6(3),k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel","revert"===t.type),k.xp6(3),k.Q6J("detail",!1),k.xp6(1),k.Q6J("ngModel","select"===t.type))},directives:[g.Ie,j.e,g.nz,g.w,h.JJ,h.On,g.Q$],styles:[".md.update-settings-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.update-settings-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}.currentIp[_ngcontent-%COMP%]{font-size:12px;width:100%;height:12px;text-align:center;padding-top:7px;position:absolute;z-index:2}.addButton[_ngcontent-%COMP%]{--border-radius: 20px !important;height:35px;width:35px}.mat-form-field[_ngcontent-%COMP%]{font-size:6px;padding-top:1.7em}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px}"],changeDetection:0}),e}(),tt=l(9074),nt=l(68384),it=l(72773),rt=l(8239);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var ot=function(){return(e=ot||(ot={})).Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE",ot;var e}(),at=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(s,e);var n,i,c=(n=s,i=r(),function(){var e,r=a(n);if(i){var o=a(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return t(this,e)});function s(e,t){var n;return p(this,s),(n=c.call(this,e)).message=e,n.code=t,n}return s}(n(Error)),ct=(0,function(e){return e.Capacitor=function(e){var t,n,i,r,o,a=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},l=s.Plugins=s.Plugins||{},u=e.CapacitorPlatforms,d=(null===(t=null==u?void 0:u.currentPlatform)||void 0===t?void 0:t.getPlatform)||function(){return null!==a?a.name:function(e){var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"}(e)},p=(null===(n=null==u?void 0:u.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||function(){return"web"!==d()},v=(null===(i=null==u?void 0:u.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||function(e){var t=h.get(e);return!(!(null==t?void 0:t.platforms.has(d()))&&!f(e))},f=(null===(r=null==u?void 0:u.currentPlatform)||void 0===r?void 0:r.getPluginHeader)||function(e){var t;return null===(t=s.PluginHeaders)||void 0===t?void 0:t.find(function(t){return t.name===e})},h=new Map,g=(null===(o=null==u?void 0:u.currentPlatform)||void 0===o?void 0:o.registerPlugin)||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=h.get(e);if(n)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),n.proxy;var i,r,o=d(),u=f(e),p=(r=(0,rt.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i||!(o in t)){e.next=11;break}if("function"!=typeof t[o]){e.next=7;break}return e.next=4,t[o]();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=t[o];case 8:i=i=e.t0,e.next=21;break;case 11:if(e.t1=null!==a&&!i&&"web"in t,!e.t1){e.next=21;break}if("function"!=typeof t.web){e.next=19;break}return e.next=16,t.web();case 16:e.t2=e.sent,e.next=20;break;case 19:e.t2=t.web;case 20:i=i=e.t2;case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)}),v=function(t){var n,i=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var c=p().then(function(i){var a=function(t,n){var i,r;if(!u){if(t)return null===(r=t[n])||void 0===r?void 0:r.bind(t);throw new at('"'.concat(e,'" plugin is not implemented on ').concat(o),ot.Unimplemented)}var a=null==u?void 0:u.methods.find(function(e){return n===e.name});return a?"promise"===a.rtype?function(t){return s.nativePromise(e,n.toString(),t)}:function(t,i){return s.nativeCallback(e,n.toString(),t,i)}:t?null===(i=t[n])||void 0===i?void 0:i.bind(t):void 0}(i,t);if(a){var c=a.apply(void 0,r);return n=null==c?void 0:c.remove,c}throw new at('"'.concat(e,".").concat(t,'()" is not implemented on ').concat(o),ot.Unimplemented)});return"addListener"===t&&(c.remove=(0,rt.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n());case 1:case"end":return e.stop()}},e)}))),c};return i.toString=function(){return"".concat(t.toString(),"() { [capacitor code] }")},Object.defineProperty(i,"name",{value:t,writable:!1,configurable:!1}),i},g=v("addListener"),m=v("removeListener"),x=function(e,t){var n,i=g({eventName:e},t),r=(n=(0,rt.Z)(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i;case 2:r=n.sent,m({eventName:e,callbackId:r},t);case 4:case"end":return n.stop()}},n)})),function(){return n.apply(this,arguments)}),o=new Promise(function(e){return i.then(function(){return e({remove:r})})});return o.remove=(0,rt.Z)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("Using addListener() without 'await' is deprecated."),e.next=3,r();case 3:case"end":return e.stop()}},e)})),o},k=new Proxy({},{get:function(e,t){switch(t){case"$$typeof":return;case"toJSON":return function(){return{}};case"addListener":return u?x:g;case"removeListener":return m;default:return v(t)}}});return l[e]=k,h.set(e,{name:e,proxy:k,platforms:new Set([].concat(c(Object.keys(t)),c(u?[o]:[])))}),k};return s.convertFileSrc||(s.convertFileSrc=function(e){return e}),s.getPlatform=d,s.handleError=function(t){return e.console.error(t)},s.isNativePlatform=p,s.isPluginAvailable=v,s.pluginMethodNoop=function(e,t,n){return Promise.reject("".concat(n,' does not have an implementation of "').concat(t,'".'))},s.registerPlugin=g,s.Exception=at,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s}(e)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).registerPlugin)("Filesystem",{electron:function(){return window.CapacitorCustomPlatform.plugins.Filesystem}}),st=it.fy,lt=function(){var e=function(){function e(t,n){p(this,e),this.platform=t,this.domSanitizer=n,this.baseDirectory=it.tP.Data,this.folder="ShellyHome",this.platform.is("electron")&&(st=ct)}return d(e,[{key:"initFolder",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.platform.is("electron")&&(this.baseDirectory=it.tP.Documents),this.folder=e,t.next=4,st.mkdir({path:this.folder,directory:this.baseDirectory,recursive:!1}).catch(function(e){return console.error(e),null});case 4:return t.next=6,st.getUri({path:this.folder,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 6:return this.directory=t.sent,t.abrupt("return",this.directory);case 8:case"end":return t.stop()}},t,this)}))}},{key:"fetchFileNames",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.folder;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,st.readdir({path:e,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 2:if(n=t.sent,!((i=n?n.files:[]).length>0)){t.next=10;break}return t.next=7,Promise.all(i.map(function(t){return r.fetchFileNames(e+"/"+t)}));case 7:t.t0=t.sent.reduce(function(e,t){return[].concat(c(e),c(t))},[]),t.next=11;break;case 10:t.t0=[e];case 11:return t.abrupt("return",t.t0);case 12:case"end":return t.stop()}},t,this)}))}},{key:"writeFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3/64;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){i.next=5;break}return i.next=3,this.convertToBase64Chunks(t,n,function(t,n){return(0,L.mG)(r,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=5;break}return i.next=3,st.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,recursive:!0});case 3:i.next=7;break;case 5:return i.next=7,st.appendFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t});case 7:case"end":return i.stop()}},i,this)}))});case 3:i.next=7;break;case 5:return i.next=7,st.writeFile({path:this.folder+"/"+e,directory:this.baseDirectory,data:t,encoding:it.ez.UTF8,recursive:!0});case 7:case"end":return i.stop()}},i,this)}))}},{key:"readFile",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){t.next=3;break}return n=nt.dV.convertFileSrc(this.directory.uri+"/"+e),t.abrupt("return",{success:this.domSanitizer.bypassSecurityTrustResourceUrl(n),revoke:function(){}});case 3:return t.next=5,this.readFileAsBlob(e);case 5:return i=t.sent,r=URL.createObjectURL(i),t.abrupt("return",{success:this.domSanitizer.bypassSecurityTrustResourceUrl(r),revoke:function(){URL.revokeObjectURL(r)}});case 8:case"end":return t.stop()}},t,this)}))}},{key:"readFileAsBlob",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.platform.is("capacitor")&&!this.platform.is("electron")){t.next=5;break}return n=nt.dV.convertFileSrc(this.directory.uri+"/"+e),t.next=4,fetch(n).then(function(e){return e.blob()});case 4:return t.abrupt("return",t.sent);case 5:return t.next=7,st.readFile({path:this.folder+"/"+e,directory:this.baseDirectory});case 7:return t.abrupt("return",t.sent.data);case 8:case"end":return t.stop()}},t,this)}))}},{key:"deleteFile",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,st.deleteFile({path:this.folder+"/"+e,directory:this.baseDirectory}).catch(function(e){return console.error(e),null});case 2:case"end":return t.stop()}},t,this)}))}},{key:"start",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.directory.uri,e.next=3,tt.D.start({path:t,port:8080}).then(function(e){return"http://"+e.ip+":8080"}).catch(function(e){return null});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}))}},{key:"stop",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt.D.stop().catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)}))}},{key:"convertToBase64Chunks",value:function(e,t,n){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,o,a,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!((r=1048576*t)%6)){i.next=3;break}throw{error:"Chunksize must be a multiple of 6!"};case 3:o=e.size;case 4:if(!(e.size>r)){i.next=13;break}return i.next=7,this.convertToBase64(e.slice(0,r));case 7:return a=i.sent,i.next=10,n(o===e.size?a:a.split(",")[1],o===e.size);case 10:e=e.slice(r);case 11:i.next=4;break;case 13:return i.next=15,this.convertToBase64(e.slice(0,e.size));case 15:return c=i.sent,i.next=18,n(c.split(",")[1],o===e.size);case 18:e=e.slice(e.size);case 19:case"end":return i.stop()}},i,this)}))}},{key:"convertToBase64",value:function(e){return new Promise(function(t,n){var i=new FileReader,r=i._realReader;r&&(i=r),i.onerror=function(e){console.log(e),n()},i.onload=function(){t(i.result)},i.readAsDataURL(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.t4),k.LFG(_.H7))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ut=function(){var t=function(){function t(e,n,i,r,o,a){p(this,t),this.httpClient=e,this.fileService=n,this.deviceService=i,this.translateService=r,this.loadingController=o,this.notificationsService=a}return d(t,[{key:"checkDevices",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"update",i=arguments.length>3?arguments[3]:void 0,r={};return{deviceInfos:t.filter(function(t){var o,a,c,s,l=t.deviceInfos[0],u=null===(a=null===(o=l.deviceStatus)||void 0===o?void 0:o.update)||void 0===a?void 0:a.old_version;if(l.deviceStatus&&u){var d=!1;return"update"===n?((d=!!e[l.device.type]&&(null===(c=e[l.device.type].version)||void 0===c?void 0:c.split("/")[0])>(null==u?void 0:u.split("/")[0]))&&(r[l.device.type]={version:e[l.device.type].version,url:e[l.device.type].url}),d):"beta"===n?((d=e[l.device.type]&&(null===(s=e[l.device.type].beta_ver)||void 0===s?void 0:s.split("/")[0])>(null==u?void 0:u.split("/")[0]))&&(r[l.device.type]={beta_ver:e[l.device.type].beta_ver,beta_url:e[l.device.type].beta_url}),d):("revert"===n?(d=e[l.device.type]&&e[l.device.type].version&&(null==u?void 0:u.indexOf("-rc"))>-1)&&(r[l.device.type]={version:e[l.device.type].version,url:e[l.device.type].url}):"select"===n&&i&&((d=i.startsWith(l.device.type)&&l.device.type+"_"+(null==u?void 0:u.split("/")[0])!==(null==i?void 0:i.split(".")[0]))&&(r[l.device.type]={version:i,url:i})),d)}return!1}),firmwareList:r}}},{key:"checkFirmwares",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,o,a,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fileService.initFolder("ShellyHome");case 2:return t.next=4,this.deviceService.getFirmwareList();case 4:if(n=t.sent){t.next=12;break}return n={},t.next=9,this.getFirmareEntries();case 9:i=t.sent,r=e(i);try{for(r.s();!(o=r.n()).done;)a=o.value,c=a.split("/").slice(0,-1).join("/"),n[a.split("_")[0]]={url:null,version:c}}catch(s){r.e(s)}finally{r.f()}case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}},t,this)}))}},{key:"startDeviceUpdateServer",value:function(){return this.fileService.start()}},{key:"downloadFiles",value:function(t){var n=this;return new Promise(function(i){return(0,L.mG)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=4;break}return n.delegateYield(regeneratorRuntime.mark(function n(){var o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.getFirmareEntries();case 2:if(o=n.sent,!((a=Object.keys(t).filter(function(e){return-1===o.indexOf(r.getFilename(e,t[e].version||t[e].beta_ver,t[e].url||t[e].beta_url))})).length>0)){n.next=8;break}return n.delegateYield(regeneratorRuntime.mark(function n(){var o,c,s,l,u,d,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.loadingController.create({message:r.translateService.instant("app.component.update.download.label")+" (0/"+a.length+")",showBackdrop:!1});case 2:return o=n.sent,n.next=5,o.present();case 5:c={},s={},l=[],u=e(a);try{for(p=function(){var e=d.value,n=t[e].url||t[e].beta_url,u=r.getFilename(e,t[e].version||t[e].beta_ver,n);r.httpClient.get(n,{responseType:"blob",reportProgress:!0,observe:"events"}).subscribe(function(e){return(0,L.mG)(r,void 0,void 0,regeneratorRuntime.mark(function t(){var r,d,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.type!==M.dt.DownloadProgress){t.next=6;break}c[n]=e.total,s[n]=e.loaded,d=Object.keys(s).map(function(e){return s[e]}).reduce(function(e,t){return e+t},0),p=Object.keys(c).map(function(e){return c[e]}).reduce(function(e,t){return e+t},0),o.message=(d/1e3).toFixed()+" / "+(p/1e3).toFixed()+" KB ("+(d/p*100).toFixed()+"%)",t.next=13;break;case 6:if(t.t0=e.type===M.dt.Response,!t.t0){t.next=13;break}return t.next=10,this.fileService.writeFile(u,e.body);case 10:l.push(!0),(null===(r=o.message)||void 0===r?void 0:r.toString().startsWith(this.translateService.instant("app.component.update.download.label")))&&(o.message=this.translateService.instant("app.component.update.download.label")+" ("+l.length+"/"+a.length+")"),l.length===a.length&&(o.dismiss(),i());case 13:case"end":return t.stop()}},t,this)}))},function(){l.push(!1),l.length===a.length&&(o.dismiss(),i())})},u.s();!(d=u.n()).done;)p()}catch(v){u.e(v)}finally{u.f()}case 8:case"end":return n.stop()}},n)})(),"t0",6);case 6:n.next=9;break;case 8:r.notificationsService.presentCustomToast("app.component.update.download-done.label"),i();case 9:case"end":return n.stop()}},n)})(),"t0",2);case 2:n.next=5;break;case 4:i();case 5:case"end":return n.stop()}},n)}))})}},{key:"getFirmareEntries",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fileService.fetchFileNames();case 2:return e.abrupt("return",e.sent.map(function(e){return e.replace("ShellyHome/","")}));case 3:case"end":return e.stop()}},e,this)}))}},{key:"getFilename",value:function(e,t,n){return e+"/"+t+"/"+n.split("/").pop()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.LFG(M.eN),k.LFG(lt),k.LFG(E.U),k.LFG(m.sK),k.LFG(g.HT),k.LFG(ne.T))},t.\u0275prov=k.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),dt=function(){var e=function(){function e(){p(this,e)}return d(e,[{key:"transform",value:function(e,t,n){return(e||[]).filter(function(e){return e[t]===n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=k.Yjl({name:"filter",type:e,pure:!0}),e}();function pt(e,t){1&e&&k._UZ(0,"ion-progress-bar",17)}function vt(e,t){if(1&e&&(k.TgZ(0,"ion-row"),k._UZ(1,"app-device",26,27),k.ALo(3,"async"),k.qZA()),2&e){var n=t.$implicit,i=k.MAs(2);k.xp6(1),k.Q6J("inView","#updateContainer")("ping",k.lcZ(3,5,i.isInView))("deviceInfo",n)("showDetails",!1)("reorder",!1)}}function ft(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-card",18),k.TgZ(2,"ion-item",19),k.NdJ("click",function(){var e=k.CHM(n).$implicit;return k.oxw(3).selectDevice(e)}),k.TgZ(3,"ion-grid",20),k.TgZ(4,"ion-list",21),k.YNc(5,vt,4,7,"ion-row",13),k.qZA(),k.qZA(),k._UZ(6,"ion-checkbox",22,23),k.TgZ(8,"ion-button",24),k.NdJ("click",function(e){var t=k.CHM(n).$implicit,i=k.oxw().ngIf,r=k.oxw(2);return e.stopPropagation(),r.showInfo(t.deviceInfos[0],i.firmwareList)}),k._UZ(9,"ion-icon",25),k.qZA(),k.qZA(),k.qZA(),k.BQk()}if(2&e){var i=t.$implicit,r=k.oxw(2).ngIf,o=k.oxw();k.xp6(2),k.Q6J("disabled",r.searching),k.xp6(3),k.Q6J("ngForOf",i.deviceInfos)("ngForTrackBy",o.identifyInfo),k.xp6(1),k.s9C("color",r.selectedDevices[i.id]&&"local"!==i.deviceInfos[0].deviceConStatus?"danger":null),k.Q6J("mode","initial")("ngModel",r.selectedDevices[i.id]&&"local"===i.deviceInfos[0].deviceConStatus)("indeterminate",r.selectedDevices[i.id]&&"local"!==i.deviceInfos[0].deviceConStatus)}}function ht(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-header"),k.TgZ(2,"ion-toolbar"),k.TgZ(3,"ion-buttons",1),k.TgZ(4,"ion-button",2),k.NdJ("click",function(){return k.CHM(n),k.oxw(2).closeModal()}),k._UZ(5,"ion-icon",3),k.qZA(),k.qZA(),k.TgZ(6,"ion-title",4),k._uU(7),k.ALo(8,"translate"),k.qZA(),k.TgZ(9,"ion-buttons",5),k.TgZ(10,"ion-button",6),k.NdJ("click",function(){var e=k.CHM(n).ngIf;return k.oxw(2).downloadFirmwares(e.firmwareList)}),k._UZ(11,"ion-icon",7),k.qZA(),k.TgZ(12,"ion-button",2),k.NdJ("click",function(e){return k.CHM(n),k.oxw(2).presentPopover(e)}),k._UZ(13,"ion-icon",8),k.qZA(),k.qZA(),k.YNc(14,pt,1,0,"ion-progress-bar",9),k.qZA(),k.qZA(),k.TgZ(15,"ion-content",10),k.TgZ(16,"ion-refresher",11),k.NdJ("ionRefresh",function(e){return k.CHM(n),k.oxw(2).checkFirmware(e)}),k._UZ(17,"ion-refresher-content"),k.qZA(),k.TgZ(18,"ion-list",12),k.YNc(19,ft,10,7,"ng-container",13),k.qZA(),k.qZA(),k.TgZ(20,"ion-footer"),k.TgZ(21,"ion-toolbar"),k.TgZ(22,"div",14),k.NdJ("click",function(){var e=k.CHM(n).ngIf;return k.oxw(2).selectAllDevices(e.deviceInfos)}),k._UZ(23,"ion-checkbox",15),k.ALo(24,"filter"),k.ALo(25,"keyvalue"),k.ALo(26,"filter"),k.ALo(27,"keyvalue"),k.ALo(28,"filter"),k.ALo(29,"keyvalue"),k.qZA(),k.TgZ(30,"ion-button",16),k.NdJ("click",function(){var e=k.CHM(n).ngIf;return k.oxw(2).updateDevices(e.deviceInfos,e.firmwareList)}),k._uU(31),k.ALo(32,"translate"),k.qZA(),k.qZA(),k.qZA(),k.BQk()}if(2&e){var i=t.ngIf,r=k.oxw().ngIf,o=k.oxw();k.xp6(7),k.hij(" ",k.lcZ(8,10,"app.component.more.update-devices.label")," "),k.xp6(3),k.Q6J("disabled",!i.firmwareList),k.xp6(4),k.Q6J("ngIf",r.searching),k.xp6(2),k.Q6J("disabled",r.searching),k.xp6(3),k.Q6J("ngForOf",i.deviceInfos)("ngForTrackBy",o.identify),k.xp6(4),k.Q6J("indeterminate",k.Dn7(24,12,k.lcZ(25,16,r.selectedDevices),"value",!0).length<(null==i.deviceInfos?null:i.deviceInfos.length)&&k.Dn7(26,18,k.lcZ(27,22,r.selectedDevices),"value",!0).length>0)("checked",k.Dn7(28,24,k.lcZ(29,28,r.selectedDevices),"value",!0).length===(null==i.deviceInfos?null:i.deviceInfos.length)),k.xp6(7),k.Q6J("disabled",r.searching||!i.firmwareList),k.xp6(1),k.hij(" ",k.lcZ(32,30,"app.component.update.confirm.label")," ")}}var gt=function(){return{}};function mt(e,t){if(1&e&&(k.ynx(0),k.YNc(1,ht,33,32,"ng-container",0),k.ALo(2,"async"),k.BQk()),2&e){var n=k.oxw();k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,n.updateDevices$)||k.DdM(3,gt))}}var xt=function(){var t=function(){function t(e,n,i,r,o,a,c,s){p(this,t),this.localService=e,this.lookupService=n,this.modalController=i,this.alertController=r,this.popoverController=o,this.deviceInfoService=a,this.deviceUpdateService=c,this.notificationsService=s,this.state$=new ge.X({selectedDevices:{}}),this.firmwares$=new ge.X({}),this.type="update"}return d(t,[{key:"ngOnInit",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.devices$=this.lookupService.subDeviceList().pipe((0,Ie.j)(function(e,t){return(0,Ce.F)(0===t?100:0)}),(0,I.U)(function(e){return c(Object.keys(e))}),(0,F.x)(this.compareKeys),(0,U.w)(function(e){return n.mapToDeviceInfo(e)}),(0,I.U)(function(e){return n.mapSameDevices(e)})),this.checkFirmware(),this.updateDevices$=(0,We.aj)([this.devices$,this.firmwares$]).pipe((0,I.U)(function(e){return n.deviceUpdateService.checkDevices(e[1],e[0],n.type,n.selectedFirmware)}),(0,S.b)(function(t){var i,r=e(t.deviceInfos);try{for(r.s();!(i=r.n()).done;){var o=i.value;void 0===n.state$.value.selectedDevices[o.id]&&(n.state$.value.selectedDevices[o.id]=!0)}}catch(l){r.e(l)}finally{r.f()}for(var a=function(){var e=s[c];t.deviceInfos.some(function(t){return t.id===e})||delete n.state$.value.selectedDevices[e]},c=0,s=Object.keys(n.state$.value.selectedDevices);c<s.length;c++)a();n.state$.value.selectedDevices=Object.assign({},n.state$.value.selectedDevices),n.state$.next(n.state$.value)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"checkFirmware",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.state$.value.searching=!0,this.state$.next(this.state$.value),t.next=3,this.deviceUpdateService.checkFirmwares();case 3:n=t.sent,this.firmwares$.next(n),e&&e.target.complete(),this.state$.value.searching=!1,this.state$.next(this.state$.value);case 5:case"end":return t.stop()}},t,this)}))}},{key:"showInfo",value:function(e,t){this.notificationsService.presentCustomToast(e.deviceStatus.update.old_version+"<br/> - <br/>"+(t[e.device.type].version||t[e.device.type].beta_ver),5e3)}},{key:"selectDevice",value:function(e){this.state$.value.selectedDevices[e.id]=!this.state$.value.selectedDevices[e.id],this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}},{key:"selectAllDevices",value:function(t){var n=this;if(t.length===Object.keys(this.state$.value.selectedDevices).filter(function(e){return n.state$.value.selectedDevices[e]}).length){var i,r=e(t);try{for(r.s();!(i=r.n()).done;){var o=i.value;this.state$.value.selectedDevices[o.id]=!1}}catch(l){r.e(l)}finally{r.f()}}else{var a,c=e(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;this.state$.value.selectedDevices[s.id]=!0}}catch(l){c.e(l)}finally{c.f()}}this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value)}},{key:"downloadFirmwares",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deviceUpdateService.downloadFiles(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"closeModal",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}},e,this)}))}},{key:"identify",value:function(e,t){return t.id}},{key:"identifyInfo",value:function(e,t){return t.device.id}},{key:"updateDevices",value:function(e,t){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,o,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!((i=e.filter(function(e){var t;return(null===(t=e.deviceInfos[0])||void 0===t?void 0:t.deviceConStatus)===B.L.local&&a.state$.value.selectedDevices[e.id]})).length>0)){n.next=21;break}if(n.t0="select"!==this.type,!n.t0){n.next=6;break}return n.next=6,this.downloadFirmwares(t);case 6:return this.state$.value.searching=!0,this.state$.next(this.state$.value),n.next=10,this.deviceUpdateService.startDeviceUpdateServer();case 10:return r=n.sent,o=i.map(function(e){var n,i=e.deviceInfos[0],o=i.device.type;return n="select"===a.type?a.selectedFirmware:a.deviceUpdateService.getFilename(o,t[o].version||t[o].beta_ver,t[o].url||t[o].beta_url),a.localService.ota(i.device,r+"/"+n,i.ip).pipe((0,Xe.V)(1e4)).toPromise().catch(function(e){return console.log(e),null})}),n.next=14,Promise.all(o);case 14:return n.next=16,(0,C.of)().pipe((0,Ke.g)(5e3)).toPromise();case 16:this.notificationsService.presentCustomToast("app.component.update.done.label",3e3),this.state$.value.searching=!1,this.state$.next(this.state$.value),n.next=22;break;case 21:this.notificationsService.presentCustomToast("app.component.update.no-devices.label",3e3);case 22:case"end":return n.stop()}},n,this)}))}},{key:"presentPopover",value:function(e){var t;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.popoverController.create({component:et,event:e,cssClass:"update-settings-popover",translucent:!1,showBackdrop:!0,componentProps:{type:this.type}});case 2:return i=n.sent,n.next=5,i.present();case 5:return n.next=7,i.onWillDismiss();case 7:if(r=n.sent,this.type=(null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.type)||this.type,n.t0="select"===this.type,!n.t0){n.next=18;break}return n.next=13,this.selectFirmware(this.selectedFirmware);case 13:if(n.t1=n.sent,n.t1){n.next=16;break}n.t1=this.selectedFirmware;case 16:this.selectedFirmware=n.t1,this.selectedFirmware||(this.type="update");case 18:this.state$.value.selectedDevices={},this.state$.value.selectedDevices=Object.assign({},this.state$.value.selectedDevices),this.state$.next(this.state$.value),this.firmwares$.next(this.firmwares$.value);case 22:case"end":return n.stop()}},n,this)}))}},{key:"selectFirmware",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deviceUpdateService.getFirmareEntries();case 2:return r=t.sent.map(function(t){return{name:t,type:"radio",label:t,value:t,checked:e===t,handler:function(){n=t,i.dismiss()}}}),t.next=5,this.alertController.create({header:"Select firmware",inputs:r,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){}}]});case 5:return i=t.sent,t.next=8,i.present();case 8:return t.next=10,i.onWillDismiss();case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}},t,this)}))}},{key:"compareKeys",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"mapToDeviceInfo",value:function(e){var t=this,n=e.map(function(e){return t.deviceInfoService.subDeviceInfoChange(e)});return(0,We.aj)(n)}},{key:"mapSameDevices",value:function(t){var n,i,r,o={},a=e(t);try{for(a.s();!(r=a.n()).done;){var c=r.value,s=null===(i=null===(n=null==c?void 0:c.device)||void 0===n?void 0:n.id)||void 0===i?void 0:i.split("_")[0];o[s]||(o[s]=[]),o[s].push(c)}}catch(l){a.e(l)}finally{a.f()}return Object.keys(o).map(function(e){return{id:e,deviceInfos:o[e]}})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.Y36(Y.C),k.Y36(Ae.W),k.Y36(g.IN),k.Y36(g.Br),k.Y36(g.Dh),k.Y36(Le.H),k.Y36(ut),k.Y36(ne.T))},t.\u0275cmp=k.Xpm({type:t,selectors:[["app-update"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["color","primary",3,"click"],["slot","icon-only","name","close"],["color","primary"],["slot","end"],["color","primary",3,"disabled","click"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","settings-outline"],["type","indeterminate",4,"ngIf"],["fullscreen","true","scroll-events",""],["slot","fixed",3,"disabled","ionRefresh"],["id","updateContainer"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"left","5px","top","8px","position","absolute","width","42px","height","42px","padding","12px","z-index","2",3,"click"],["slot","start",3,"indeterminate","checked"],["expand","block","fill","outline",2,"height","48px","margin","5px",3,"disabled","click"],["type","indeterminate"],[1,"dummyCard"],["mode","md","lines","inset","button","",3,"disabled","click"],[2,"z-index","-1"],[2,"padding","0"],["slot","start",2,"margin-left","5px","margin-right","15px","pointer-events","none",3,"mode","color","ngModel","indeterminate"],["checkbox",""],["color","primary","slot","end","shape","round",1,"infoButton",3,"click"],["slot","icon-only","name","information-outline"],[3,"inView","ping","deviceInfo","showDetails","reorder"],["inView","inView"]],template:function(e,t){1&e&&(k.YNc(0,mt,3,4,"ng-container",0),k.ALo(1,"async")),2&e&&k.Q6J("ngIf",k.lcZ(1,1,t.state$))},directives:[f.O5,g.Gu,g.sr,g.Sm,g.YG,g.gu,g.wd,g.W2,g.nJ,g.Wo,g.q_,f.sg,g.fr,g.nz,g.w,g.X7,g.PM,g.Ie,j.e,g.jY,h.JJ,h.On,g.Nd,te.v,$e.z],pipes:[f.Ov,m.X$,dt,f.Nd],styles:[".header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.searchText[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%)}.searchText[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding-bottom:10px}ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%}[_nghost-%COMP%]     app-device{width:100%}[_nghost-%COMP%]     app-device>div{margin-bottom:-1px}[_nghost-%COMP%]     app-device>div>ion-item{--border-color: transparent;pointer-events:none;opacity:1}[_nghost-%COMP%]     app-device>div>ion-item *:not(.infoButton), [_nghost-%COMP%]     app-device>div>ion-item ion-range::part(bar), [_nghost-%COMP%]     app-device>div>ion-item ion-range::part(knob), [_nghost-%COMP%]     app-device>div>ion-item ion-range::part(bar-active){pointer-events:none!important}[_nghost-%COMP%]     app-device>div>ion-item.item-disabled>ion-grid{opacity:.7}[_nghost-%COMP%]     app-device>div>ion-item:not(.item-disabled)>ion-grid{opacity:.7}.infoButton[_ngcontent-%COMP%]{height:25px;width:25px;margin-left:5px;margin-right:12px}ion-item[_ngcontent-%COMP%]{--padding-start: 12px;--inner-padding-end: 0px}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:0}ion-item[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding:0}ion-checkbox[_ngcontent-%COMP%]{pointer-events:none}.dummyCard[_ngcontent-%COMP%]{box-shadow:none!important;padding:0;margin:0;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden;border-radius:0!important}"],changeDetection:0}),t}(),kt=l(56448),bt=function(){var t=function(){function t(e,n,i,r,o){p(this,t),this.fileService=e,this.authService=n,this.lookupService=i,this.translateService=r,this.notificationsService=o}return d(t,[{key:"shareBackup",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we.A.getInfo();case 2:return t=e.sent,n=it.tP.Data,("mac"===t.operatingSystem||"windows"===t.operatingSystem)&&(n=it.tP.Documents),this.fileService.initFolder("backup"),e.next=8,this.createBackup("ShellyHome/shelly-home-backup.txt",n);case 8:return e.next=10,this.fileService.start();case 10:case"end":return e.stop()}},e,this)}))}},{key:"createBackup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shelly-home-backup.txt",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it.tP.Documents;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r={},i.next=3,fe.K.keys().then(function(i){return(0,L.mG)(o,void 0,void 0,regeneratorRuntime.mark(function o(){var a,c,s,l,u=this;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:a=e(i.keys),o.prev=1,a.s();case 3:if((c=a.n()).done){o.next=16;break}return s=c.value,o.prev=5,o.next=8,fe.K.get({key:s}).then(function(e){var t;try{t=JSON.parse(e.value)}catch(n){t=e.value}return t});case 8:r[s]=o.sent,o.next=14;break;case 11:o.prev=11,o.t0=o.catch(5),console.error(o.t0);case 14:o.next=3;break;case 16:o.next=21;break;case 18:o.prev=18,o.t1=o.catch(1),a.e(o.t1);case 21:return o.prev=21,a.f(),o.finish(21);case 24:return l={path:t,data:JSON.stringify(r),directory:n,encoding:it.ez.UTF8},o.next=27,it.fy.writeFile(l).then(function(){u.notificationsService.presentCustomToast("app.component.more.backup-download-success.label")}).catch(function(){return u.notificationsService.presentCustomToast("app.component.more.backup-download-error.label")});case 27:case"end":return o.stop()}},o,null,[[1,18,21,24],[5,11]])}))});case 3:case"end":return i.stop()}},i)}))}},{key:"loadBackup",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we.A.getInfo();case 2:(t=window.document.createElement("input")).type="file",t.accept=".txt",t.style.height="0px",t.style.width="0px",t.style.border="0px",t.style.position="fixed",t.style.top="50%",t.style.left="50%",document.body.appendChild(t),t.click(),t.addEventListener("change",function(){var e=t.files[0];if(e.type.match(/text.*/)){var i=new FileReader,r=i._realReader;r&&(i=r),i.onload=function(){return(0,L.mG)(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=JSON.parse(i.result),e.t0=regeneratorRuntime.keys(n);case 3:if((e.t1=e.t0()).done){e.next=14;break}if(r=e.t1.value,"string"!=typeof n[r]){e.next=10;break}return e.next=8,fe.K.set({key:r,value:n[r]});case 8:e.next=12;break;case 10:return e.next=12,fe.K.set({key:r,value:JSON.stringify(n[r])});case 12:e.next=3;break;case 14:return e.next=16,this.lookupService.init();case 16:this.authService.login(),this.lookupService.setDarkMode(),this.notificationsService.presentCustomToast("app.component.more.backup-load-success.label"),e.next=24;break;case 21:e.prev=21,e.t2=e.catch(0),console.error(e.t2),this.notificationsService.presentCustomToast("app.component.more.backup-load-error.label");case 24:document.body.removeChild(t);case 25:case"end":return e.stop()}},e,this,[[0,21]])}))},i.readAsText(e)}else document.body.removeChild(t),n.notificationsService.presentCustomToast("app.component.more.backup-load-error.label")});case 4:case"end":return e.stop()}},e)}))}},{key:"writeErrorLog",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=localStorage.getItem("errorLog"),n={path:"shelly-home-error-log.txt",data:JSON.stringify(t),directory:it.tP.Documents,encoding:it.ez.UTF8},it.fy.writeFile(n).then(function(){return(0,L.mG)(i,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we.A.getInfo();case 2:return t=e.sent,this.notificationsService.presentCustomToast("app.component.more.report-error-prompt.label"),e.next=6,(0,be.Vs)(2e3);case 6:n=this.translateService.instant("app.component.more.report-error.label"),i=("ios"===t.platform?"iOS":"android"===t.platform?"Android":"Electron")+" Version: "+t.osVersion+"\r\n\r\n"+this.translateService.instant("app.component.more.report-error-body.label")+"\r\n\r\n\r\n\r\n\r\n\r\n",r="mailto:di.gausma@googlemail.com?subject=",r+=encodeURIComponent(n),r+="&body=",r+=encodeURIComponent(i),window.open(r,"_system");case 9:case"end":return e.stop()}},e,this)}))}).catch(function(){});case 2:case"end":return e.stop()}},e)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.LFG(lt),k.LFG(kt.e),k.LFG(Ae.W),k.LFG(m.sK),k.LFG(ne.T))},t.\u0275prov=k.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),wt=l(37443);function yt(e,t){if(1&e&&(k.TgZ(0,"ion-select-option",15),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e){var n=t.$implicit;k.s9C("value",n),k.xp6(1),k.hij(" ",k.lcZ(2,2,"app.commons.languages["+n+"].label")," ")}}function Zt(e,t){1&e&&(k.TgZ(0,"ion-label"),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e&&(k.xp6(1),k.hij(" ",k.lcZ(2,1,"app.component.more.dark-theme.label")," "))}function Ct(e,t){1&e&&(k.TgZ(0,"ion-label"),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e&&(k.xp6(1),k.hij(" ",k.lcZ(2,1,"app.component.more.light-theme.label")," "))}function St(e,t){1&e&&(k.TgZ(0,"ion-label"),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e&&(k.xp6(1),k.hij(" ",k.lcZ(2,1,"app.component.more.system-theme.label")," "))}var It=function(){var e=function(){function e(t,n,i,r,o,a){p(this,e),this.backupService=t,this.lookupService=n,this.popoverService=i,this.translateService=r,this.popoverController=o,this.actionSheetController=a,this.unsubscribe=new q.xQ}return d(e,[{key:"ngOnInit",value:function(){this.languages=this.translateService.getLangs(),this.settings=this.lookupService.settings}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"onClickAddDevices",value:function(){this.popoverService.presentModal(ye.D,!0),this.dismiss()}},{key:"onClickSearch",value:function(){this.popoverService.presentModal(Ve,!0),this.dismiss()}},{key:"onClickUpdateDevices",value:function(){this.popoverService.presentModal(xt,!0),this.dismiss()}},{key:"onClickToggleTheme",value:function(){!0===this.settings.darkTheme?this.settings.darkTheme=!1:!1===this.settings.darkTheme?this.settings.darkTheme=void 0:null==this.settings.darkTheme&&(this.settings.darkTheme=!0),this.lookupService.setSettings(this.settings),this.lookupService.setDarkMode()}},{key:"onLangChange",value:function(e){this.translateService.use(e),this.settings.language=e,this.lookupService.setSettings(this.settings)}},{key:"onClickDonate",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,we.A.getInfo();case 2:if(t.t0=t.sent.platform,"android"!==t.t0){t.next=7;break}e.open(),t.next=8;break;case 7:window.open("https://github.com/digaus/shellyhome-i18n/blob/master/README.md","_system","location=yes");case 8:case"end":return t.stop()}},t)}))}},{key:"onClickReportError",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.writeErrorLog();case 2:case"end":return e.stop()}},e,this)}))}},{key:"onDonate",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.product=null;case 1:case"end":return e.stop()}},e,this)}))}},{key:"onClickBackup",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:this.translateService.instant("app.component.more.backup.header.label"),buttons:[{text:this.translateService.instant("Share"),icon:"arrow-redo",handler:function(){return(0,L.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.shareBackup();case 2:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("Scan"),icon:"arrow-undo",handler:function(){return(0,L.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.loadBackup();case 2:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.more.backup-do.label"),icon:"arrow-redo",handler:function(){return(0,L.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.createBackup();case 2:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.more.backup-load.label"),icon:"arrow-undo",handler:function(){return(0,L.mG)(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backupService.loadBackup();case 2:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.more.cancel.label"),role:"cancel",icon:"close",handler:function(){console.log("Cancel clicked")}}]});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"dismiss",value:function(){this.popoverController.dismiss()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(bt),k.Y36(Ae.W),k.Y36(wt.X),k.Y36(m.sK),k.Y36(g.Dh),k.Y36(g.BX))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-more"]],decls:58,vars:45,consts:[["mode","md",2,"display","none"],["slot","end",3,"okText","cancelText","ngModel","ngModelChange"],["langSelect",""],[3,"value",4,"ngFor","ngForOf"],["donateSelect",""],["mode","md","lines","none","button","","detail","false",3,"click"],["color","primary","name","wifi","slot","start"],["color","primary","name","search","slot","start"],["color","primary","name","sync","slot","start"],["color","primary","name","mail","slot","start",2,"height","20px"],["color","primary","name","repeat","slot","start"],["color","primary","name","contrast","slot","start"],[4,"ngIf"],["color","primary","name","heart","slot","start"],["color","primary","name","globe","slot","start"],[3,"value"]],template:function(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-item",0),k.TgZ(1,"ion-label"),k._uU(2),k.ALo(3,"translate"),k.qZA(),k.TgZ(4,"ion-select",1,2),k.NdJ("ngModelChange",function(e){return t.settings.language=e})("ngModelChange",function(e){return t.onLangChange(e)}),k.ALo(6,"translate"),k.ALo(7,"translate"),k.YNc(8,yt,3,4,"ion-select-option",3),k.qZA(),k.qZA(),k.TgZ(9,"ion-item",0),k.TgZ(10,"ion-label"),k._uU(11),k.ALo(12,"translate"),k.qZA(),k.TgZ(13,"ion-select",1,4),k.NdJ("ngModelChange",function(e){return t.product=e})("ngModelChange",function(e){return t.onDonate(e)}),k.ALo(15,"translate"),k.ALo(16,"translate"),k.qZA(),k.qZA(),k.TgZ(17,"ion-list"),k.TgZ(18,"ion-item",5),k.NdJ("click",function(){return t.onClickAddDevices()}),k._UZ(19,"ion-icon",6),k.TgZ(20,"ion-label"),k._uU(21),k.ALo(22,"translate"),k.qZA(),k.qZA(),k.TgZ(23,"ion-item",5),k.NdJ("click",function(){return t.onClickSearch()}),k._UZ(24,"ion-icon",7),k.TgZ(25,"ion-label"),k._uU(26),k.ALo(27,"translate"),k.qZA(),k.qZA(),k.TgZ(28,"ion-item",5),k.NdJ("click",function(){return t.onClickUpdateDevices()}),k._UZ(29,"ion-icon",8),k.TgZ(30,"ion-label"),k._uU(31),k.ALo(32,"translate"),k.qZA(),k.qZA(),k.TgZ(33,"ion-item",5),k.NdJ("click",function(){return t.onClickReportError()}),k._UZ(34,"ion-icon",9),k.TgZ(35,"ion-label"),k._uU(36),k.ALo(37,"translate"),k.qZA(),k.qZA(),k.TgZ(38,"ion-item",5),k.NdJ("click",function(){return t.onClickBackup()}),k._UZ(39,"ion-icon",10),k.TgZ(40,"ion-label"),k._uU(41),k.ALo(42,"translate"),k.qZA(),k.qZA(),k.TgZ(43,"ion-item",5),k.NdJ("click",function(){return t.onClickToggleTheme()}),k._UZ(44,"ion-icon",11),k.YNc(45,Zt,3,3,"ion-label",12),k.YNc(46,Ct,3,3,"ion-label",12),k.YNc(47,St,3,3,"ion-label",12),k.qZA(),k.TgZ(48,"ion-item",5),k.NdJ("click",function(){k.CHM(n);var e=k.MAs(14);return t.onClickDonate(e)}),k._UZ(49,"ion-icon",13),k.TgZ(50,"ion-label"),k._uU(51),k.ALo(52,"translate"),k.qZA(),k.qZA(),k.TgZ(53,"ion-item",5),k.NdJ("click",function(){return k.CHM(n),k.MAs(5).open()}),k._UZ(54,"ion-icon",14),k.TgZ(55,"ion-label"),k._uU(56),k.ALo(57,"translate"),k.qZA(),k.qZA(),k.qZA()}2&e&&(k.xp6(2),k.Oqu(k.lcZ(3,19,"app.component.more.language.label")),k.xp6(2),k.Q6J("okText",k.lcZ(6,21,"app.commons.confirm.label"))("cancelText",k.lcZ(7,23,"app.commons.cancel.label"))("ngModel",t.settings.language),k.xp6(4),k.Q6J("ngForOf",t.languages),k.xp6(3),k.Oqu(k.lcZ(12,25,"app.component.more.donate.label")),k.xp6(2),k.Q6J("okText",k.lcZ(15,27,"app.commons.confirm.label"))("cancelText",k.lcZ(16,29,"app.commons.cancel.label"))("ngModel",t.product),k.xp6(8),k.hij(" ",k.lcZ(22,31,"app.component.more.add-devices.label")," "),k.xp6(5),k.hij(" ",k.lcZ(27,33,"app.component.more.search-devices.label")," "),k.xp6(5),k.hij(" ",k.lcZ(32,35,"app.component.more.update-devices.label")," "),k.xp6(5),k.hij(" ",k.lcZ(37,37,"app.component.more.report-error.label")," "),k.xp6(5),k.hij(" ",k.lcZ(42,39,"app.component.more.backup.label")," "),k.xp6(4),k.Q6J("ngIf",!0===(null==t.settings?null:t.settings.darkTheme)),k.xp6(1),k.Q6J("ngIf",!1===(null==t.settings?null:t.settings.darkTheme)),k.xp6(1),k.Q6J("ngIf",null==(null==t.settings?null:t.settings.darkTheme)),k.xp6(4),k.Oqu(k.lcZ(52,41,"app.component.more.donate.label")),k.xp6(5),k.hij("",k.lcZ(57,43,"app.commons.languages["+(null==t.settings?null:t.settings.language)+"].label")," "))},directives:[g.Ie,j.e,g.Q$,g.t9,g.QI,h.JJ,h.On,f.sg,g.q_,g.gu,f.O5,g.n0],pipes:[m.X$],styles:["ion-item[_ngcontent-%COMP%]{height:38px}ion-item[_ngcontent-%COMP%]   ion-icon.md[_ngcontent-%COMP%]{margin-right:15px;margin-top:2px}ion-item[_ngcontent-%COMP%]   ion-icon.ios[_ngcontent-%COMP%]{margin-right:15px;margin-top:0}ion-item[_ngcontent-%COMP%]   ion-label.ios[_ngcontent-%COMP%]{margin-top:4px}ion-item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:-2px}ion-item[_ngcontent-%COMP%] > ion-badge[_ngcontent-%COMP%]{margin-top:-12px;border-radius:10px;padding-top:4px}ion-list.list-ios[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}  .md.more-popover .popover-content{margin-top:-42px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios.more-popover .popover-content{width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}  .ios .action-sheet-icon{position:absolute!important;left:10px}"],changeDetection:0}),e}(),At=l(65754),Mt=l(52141),_t=l(62411),Tt=l(46662),Ot=l(3001),Pt=function(){var e=function(){function e(t){p(this,e),this.lookupService=t}return d(e,[{key:"transform",value:function(e){return this.lookupService.subRoomList().pipe((0,I.U)(function(t){return t[e]}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(Ae.W,16))},e.\u0275pipe=k.Yjl({name:"room",type:e,pure:!0}),e}(),Jt=function(){var e=function(){function e(t){p(this,e),this.lookupService=t}return d(e,[{key:"transform",value:function(e){return this.lookupService.subGroupList().pipe((0,I.U)(function(t){return t[e]}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(Ae.W,16))},e.\u0275pipe=k.Yjl({name:"group",type:e,pure:!0}),e}(),Rt=["slides"];function Dt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-fab-button",19),k.NdJ("click",function(){return k.CHM(n),k.oxw(2).removeDashboard()}),k._UZ(1,"ion-icon",20),k.qZA()}}function Lt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-slide",21),k.NdJ("click",function(){return k.CHM(n),k.oxw(2).addDashboard()}),k.TgZ(1,"ion-title",22),k._uU(2),k.ALo(3,"translate"),k.qZA(),k.qZA()}2&e&&(k.xp6(2),k.hij(" ",k.lcZ(3,1,"app.component.dashboard.empty-list.label")," "))}function $t(e,t){1&e&&(k.TgZ(0,"ion-title",22),k._uU(1),k.ALo(2,"translate"),k.qZA()),2&e&&(k.xp6(1),k.hij(" ",k.lcZ(2,1,"app.component.dashboard.empty.label")," "))}function qt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-fab-button",32),k.NdJ("click",function(){k.CHM(n);var e=k.oxw().index,t=k.oxw().index,i=k.oxw(2).index;return k.oxw(2).removeElement(i,t,e)}),k._UZ(1,"ion-icon",33),k.qZA()}}function Nt(e,t){1&e&&(k.TgZ(0,"div",39),k._UZ(1,"ion-icon",40),k._UZ(2,"div"),k.qZA())}function Ft(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"app-device",36,37),k.NdJ("dashboardSettingsChange",function(e){var t=k.CHM(n).ngIf;return k.oxw(2).$implicit.devices[null==t||null==t.device?null:t.device.id]=e})("dashboardSettingsChange",function(){return k.CHM(n),k.oxw(7).saveSettings()}),k.ALo(2,"async"),k.YNc(3,Nt,3,0,"div",38),k.qZA()}if(2&e){var i=t.ngIf,r=k.MAs(1),o=k.oxw(2).$implicit,a=k.oxw(5);k.Q6J("ping",k.lcZ(2,6,r.isInView))("deviceInfo",i)("dashboardSettings",o.devices[null==i||null==i.device?null:i.device.id])("showDetails",!1)("reorder",a.reorder),k.xp6(3),k.Q6J("ngIf",a.reorder)}}function Ut(e,t){if(1&e&&(k.TgZ(0,"ion-card",34),k.YNc(1,Ft,4,8,"app-device",35),k.ALo(2,"async"),k.ALo(3,"deviceInfo"),k.qZA()),2&e){var n=k.oxw().$implicit;k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,k.lcZ(3,3,n.key)))}}function Qt(e,t){1&e&&(k.TgZ(0,"div",39),k._UZ(1,"ion-icon",40),k._UZ(2,"div"),k.qZA())}var Gt=function(){return[]};function Bt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"app-room",43,37),k.NdJ("dashboardSettingsChange",function(e){return k.CHM(n),k.oxw(2).$implicit.devices=e})("dashboardSettingsChange",function(){return k.CHM(n),k.oxw(7).saveSettings()})("select",function(){k.CHM(n);var e=k.oxw(2).index,t=k.oxw().index,i=k.oxw(2).index;return k.oxw(2).collapsedChanged(i,t,e)})("controlButtonsChange",function(){k.CHM(n);var e=k.oxw(2).index,t=k.oxw().index,i=k.oxw(2).index;return k.oxw(2).controlButtonsChanged(i,t,e)}),k.ALo(2,"async"),k.YNc(3,Qt,3,0,"div",38),k.qZA()}if(2&e){var i=t.ngIf,r=k.MAs(1),o=k.oxw(2).$implicit,a=k.oxw(5);k.ekj("collapsed",o.collapsed)("not-collapsed",!o.collapsed),k.Q6J("ping",k.lcZ(2,11,r.isInView))("room",i)("allow",k.DdM(13,Gt))("reorder",a.reorder)("dashboardSettings",o.devices)("controlButtons",o.controlButtons),k.xp6(3),k.Q6J("ngIf",a.reorder)}}function Yt(e,t){if(1&e&&(k.TgZ(0,"div",41),k.YNc(1,Bt,4,14,"app-room",42),k.ALo(2,"async"),k.ALo(3,"room"),k.qZA()),2&e){var n=k.oxw().$implicit;k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,k.lcZ(3,3,n.key)))}}function Et(e,t){1&e&&(k.TgZ(0,"div",39),k._UZ(1,"ion-icon",40),k._UZ(2,"div"),k.qZA())}function jt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"app-group",45,37),k.NdJ("dashboardSettingsChange",function(e){return k.CHM(n),k.oxw(2).$implicit.devices=e})("dashboardSettingsChange",function(){return k.CHM(n),k.oxw(7).saveSettings()})("select",function(){k.CHM(n);var e=k.oxw(2).index,t=k.oxw().index,i=k.oxw(2).index;return k.oxw(2).collapsedChanged(i,t,e)})("controlButtonsChange",function(){k.CHM(n);var e=k.oxw(2).index,t=k.oxw().index,i=k.oxw(2).index;return k.oxw(2).controlButtonsChanged(i,t,e)}),k.ALo(2,"async"),k.YNc(3,Et,3,0,"div",38),k.qZA()}if(2&e){var i=t.ngIf,r=k.MAs(1),o=k.oxw(2).$implicit,a=k.oxw(5);k.ekj("collapsed",o.collapsed)("not-collapsed",!o.collapsed),k.Q6J("ping",k.lcZ(2,11,r.isInView))("group",i)("allow",k.DdM(13,Gt))("reorder",a.reorder)("dashboardSettings",o.devices)("controlButtons",o.controlButtons),k.xp6(3),k.Q6J("ngIf",a.reorder)}}function Ht(e,t){if(1&e&&(k.TgZ(0,"div",41),k.YNc(1,jt,4,14,"app-group",44),k.ALo(2,"async"),k.ALo(3,"group"),k.qZA()),2&e){var n=k.oxw().$implicit;k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,k.lcZ(3,3,n.key)))}}function zt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"div",28),k.NdJ("cdkDragStarted",function(){return k.CHM(n),k.oxw(5).onDragStart()}),k.YNc(1,qt,2,0,"ion-fab-button",29),k.YNc(2,Ut,4,5,"ion-card",30),k.YNc(3,Yt,4,5,"div",31),k.YNc(4,Ht,4,5,"div",31),k.qZA()}if(2&e){var i=t.$implicit,r=k.oxw(5);k.Q6J("cdkDragData",i)("cdkDragDisabled",!r.reorder),k.xp6(1),k.Q6J("ngIf",r.reorder),k.xp6(1),k.Q6J("ngIf","device"===i.type),k.xp6(1),k.Q6J("ngIf","room"===i.type),k.xp6(1),k.Q6J("ngIf","group"===i.type)}}function Vt(e,t){if(1&e){var n=k.EpF();k.TgZ(0,"ion-col",25),k.NdJ("cdkDropListDropped",function(e){return k.CHM(n),k.oxw(4).drop(e)})("click",function(){var e=k.CHM(n).$implicit,t=k.oxw(4);return null!=e&&e.length?null:t.onClickAdd()}),k.ALo(1,"dropListConnected"),k.ALo(2,"async"),k.ALo(3,"async"),k.YNc(4,$t,3,3,"ion-title",26),k.YNc(5,zt,5,6,"div",27),k.qZA()}if(2&e){var i=t.$implicit,r=t.index,o=k.oxw(2).$implicit,a=k.oxw(2);k.Udp("width",100/o.cols.length+"%"),k.Q6J("cdkDropListData",i)("cdkDropListConnectedTo",k.xi3(1,8,o.cols,k.lcZ(2,11,a.currentSlide$)))("id","dashboard"+k.lcZ(3,13,a.currentSlide$)+"Col"+r),k.xp6(4),k.Q6J("ngIf",!(null!=i&&i.length)),k.xp6(1),k.Q6J("ngForOf",i)("ngForTrackBy",a.identify)}}function Wt(e,t){if(1&e&&(k.TgZ(0,"ion-row"),k.YNc(1,Vt,6,15,"ion-col",24),k.qZA()),2&e){var n=k.oxw().$implicit,i=k.oxw(2);k.xp6(1),k.Q6J("ngForOf",n.cols)("ngForTrackBy",i.identifyIndex)}}function Xt(e,t){if(1&e&&(k.TgZ(0,"ion-slide"),k.TgZ(1,"ion-grid",23),k.TgZ(2,"ion-list"),k.YNc(3,Wt,2,2,"ion-row",0),k.ALo(4,"async"),k.qZA(),k.qZA(),k.qZA()),2&e){var n=t.index,i=k.oxw(2);k.xp6(3),k.Q6J("ngIf",k.lcZ(4,1,i.currentSlide$)===n)}}function Kt(e,t){if(1&e){var n=k.EpF();k.ynx(0),k.TgZ(1,"ion-header",1),k.TgZ(2,"ion-toolbar"),k.TgZ(3,"ion-buttons",2),k.TgZ(4,"ion-menu-button",3),k._UZ(5,"ion-icon",4),k.qZA(),k.qZA(),k.TgZ(6,"ion-title",5),k._uU(7,"Dashboard"),k.qZA(),k.TgZ(8,"ion-buttons",6),k.TgZ(9,"ion-button",7),k.NdJ("click",function(){k.CHM(n);var e=k.MAs(19),t=k.oxw();return t.reorder=!t.reorder,null==e?null:e.lockSwipes(t.reorder)}),k._UZ(10,"ion-icon",8),k.qZA(),k.TgZ(11,"ion-button",9),k.NdJ("click",function(){return k.CHM(n),k.oxw().onClickAdd()}),k._UZ(12,"ion-icon",10),k.qZA(),k.TgZ(13,"ion-button",9),k.NdJ("click",function(e){return k.CHM(n),k.oxw().presentPopover(e)}),k._UZ(14,"ion-icon",11),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.TgZ(15,"ion-content",12),k.TgZ(16,"ion-fab",13),k.YNc(17,Dt,2,0,"ion-fab-button",14),k.qZA(),k.TgZ(18,"ion-slides",15,16),k.NdJ("ionSlideDidChange",function(){return k.CHM(n),k.oxw().slidesDidChange()}),k.YNc(20,Lt,4,3,"ion-slide",17),k.YNc(21,Xt,5,3,"ion-slide",18),k.qZA(),k.qZA(),k.BQk()}if(2&e){var i=t.ngIf,r=k.oxw();k.xp6(4),k.Q6J("menu","first"),k.xp6(6),k.Q6J("name",r.reorder?"checkmark-done-sharp":"create-outline"),k.xp6(1),k.Q6J("disabled",r.reorder),k.xp6(2),k.Q6J("disabled",r.reorder),k.xp6(4),k.Q6J("ngIf",r.reorder),k.xp6(1),k.Q6J("options",r.slideConfig),k.xp6(2),k.Q6J("ngIf",!(null!=i&&i.length)),k.xp6(1),k.Q6J("ngForOf",i)}}var en=[{path:"",component:function(){var e=function(){function e(t,n,i,r,o,a,c,s){p(this,e),this.renderer2=t,this.alertService=n,this.lookupService=i,this.modalController=r,this.translateService=o,this.deviceInfoService=a,this.popoverController=c,this.actionSheetController=s,this.slideConfig={slidesPerView:1,centeredSlides:!0},this.currentSlide$=new ge.X(0)}return d(e,[{key:"ngOnInit",value:function(){var e=this;he.g.addListener("appStateChange",function(t){t.isActive&&e.slides.update()}),ve.c.hide(),fe.K.set({key:At.Q.welcome,value:"done"}),this.deviceInfoService.init(),this.dashboardList$=this.lookupService.subSettings().pipe((0,I.U)(function(e){return e.dashboardList.forEach(function(e){return e.cols.forEach(function(e){return e.forEach(function(e){return e.devices=e.devices||{}})})}),e.dashboardList}),(0,S.b)(function(t){var n;t[e.currentSlide$.value]||null===(n=e.slides)||void 0===n||n.slideTo(0)}))}},{key:"removeElement",value:function(e,t,n){this.lookupService.settings.dashboardList[e].cols[t].splice(n,1),this.lookupService.setSettings(this.lookupService.settings)}},{key:"editElement",value:function(e,t,n){this.lookupService.setSettings(this.lookupService.settings)}},{key:"collapsedChanged",value:function(e,t,n){this.lookupService.settings.dashboardList[e].cols[t][n].collapsed=!this.lookupService.settings.dashboardList[e].cols[t][n].collapsed,this.lookupService.setSettings(this.lookupService.settings)}},{key:"controlButtonsChanged",value:function(e,t,n){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,be.Vs)(1);case 2:this.lookupService.settings.dashboardList[e].cols[t][n].controlButtons=!this.lookupService.settings.dashboardList[e].cols[t][n].controlButtons,this.lookupService.setSettings(this.lookupService.settings);case 4:case"end":return i.stop()}},i,this)}))}},{key:"saveSettings",value:function(){this.lookupService.setSettings(this.lookupService.settings)}},{key:"presentPopover",value:function(e){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:It,event:e,cssClass:"more-popover",translucent:!1,showBackdrop:!0});case 2:return t.next=4,t.sent.present();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"addDashboard",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertService.addDashboard();case 2:if(!(t=e.sent).cols){e.next=10;break}return n=Array.from({length:t.cols}).map(function(){return[]}),this.lookupService.settings.dashboardList.push({cols:n}),this.lookupService.setSettings(this.lookupService.settings),e.next=9,(0,be.Vs)(200);case 9:this.slides.slideTo(this.lookupService.settings.dashboardList.length+1);case 10:case"end":return e.stop()}},e,this)}))}},{key:"drop",value:function(e){e.previousContainer===e.container?(0,u.bA)(e.container.data,e.previousIndex,e.currentIndex):(0,u.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.lookupService.setSettings(this.lookupService.settings)}},{key:"identifyIndex",value:function(e,t){return e}},{key:"identify",value:function(e,t){return t.key+t.type}},{key:"onDragStart",value:function(){this.renderer2.setStyle(document.getElementsByClassName("cdk-drag-placeholder")[0],"height",document.getElementsByClassName("cdk-drag-preview")[0].clientHeight+"px")}},{key:"slidesDidChange",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.slides.getActiveIndex();case 2:return t=e.sent,e.next=5,(0,be.Vs)(100);case 5:this.currentSlide$.next(t);case 6:case"end":return e.stop()}},e,this)}))}},{key:"removeDashboard",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.reorder=!1,e.next=3,this.slides.lockSwipes(!1);case 3:if(this.lookupService.settings.dashboardList.splice(this.currentSlide$.value,1),this.lookupService.settings.dashboardList=c(this.lookupService.settings.dashboardList),this.lookupService.setSettings(this.lookupService.settings),!(this.currentSlide$.value>=1)){e.next=11;break}return e.next=9,this.slides.slideTo(this.currentSlide$.value-1);case 9:e.next=15;break;case 11:if(e.t0=this.lookupService.settings.dashboardList.length>1,!e.t0){e.next=15;break}return e.next=15,this.slides.slideTo(0);case 15:case"end":return e.stop()}},e,this)}))}},{key:"onClickAdd",value:function(){var e,t,n,i,r,o;return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function a(){var c=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.actionSheetController.create({mode:"ios",header:this.translateService.instant("app.component.dashboard.edit.header.label"),buttons:[{cssClass:(null===(t=null===(e=this.lookupService.settings)||void 0===e?void 0:e.dashboardList)||void 0===t?void 0:t.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-device.header.label"),icon:"cog-outline",handler:function(){return(0,L.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openDevices();case 1:case"end":return e.stop()}},e,this)}))}},{cssClass:(null===(i=null===(n=this.lookupService.settings)||void 0===n?void 0:n.dashboardList)||void 0===i?void 0:i.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-room.header.label"),icon:"home-outline",handler:function(){return(0,L.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openRooms();case 1:case"end":return e.stop()}},e,this)}))}},{cssClass:(null===(o=null===(r=this.lookupService.settings)||void 0===r?void 0:r.dashboardList)||void 0===o?void 0:o.length)?"":"disabledAction",text:this.translateService.instant("app.component.dashboard.add-group.header.label"),icon:"copy-outline",handler:function(){return(0,L.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openGroups();case 1:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.dashboard.add-dashboard.header.label"),icon:"duplicate-outline",handler:function(){return(0,L.mG)(c,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.addDashboard();case 1:case"end":return e.stop()}},e,this)}))}},{text:this.translateService.instant("app.component.dashboard.cancel.header.label"),role:"cancel",icon:"close",handler:function(){}}]});case 2:return a.next=4,a.sent.present();case 4:case"end":return a.stop()}},a,this)}))}},{key:"openRooms",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:ke.g,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.settings.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"openGroups",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:xe.B,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.settings.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}},{key:"openDevices",value:function(){return(0,L.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:me.Z,cssClass:"dashboardModal",componentProps:{dashboard:this.lookupService.settings.dashboardList[this.currentSlide$.value],currentSlide:this.currentSlide$.value}});case 2:return e.next=4,e.sent.present();case 4:case"end":return e.stop()}},e,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.Y36(k.Qsj),k.Y36(Mt.c),k.Y36(Ae.W),k.Y36(g.IN),k.Y36(m.sK),k.Y36(Le.H),k.Y36(g.Dh),k.Y36(g.BX))},e.\u0275cmp=k.Xpm({type:e,selectors:[["app-dashboard"]],viewQuery:function(e,t){var n;(1&e&&(k.Gf(Rt,5),k.Gf(g.W2,5)),2&e)&&(k.iGM(n=k.CRH())&&(t.slides=n.first),k.iGM(n=k.CRH())&&(t.ionContents=n))},decls:2,vars:3,consts:[[4,"ngIf"],["translucent","true",1,"ion-no-border"],["slot","start"],["color","primary",3,"menu"],["slot","icon-only","name","menu-outline"],["color","primary"],["slot","end"],["color","primary",3,"click"],["slot","icon-only",3,"name"],["color","primary",3,"disabled","click"],["slot","icon-only","name","add"],["slot","icon-only","md","ellipsis-vertical-outline","ios","ellipsis-horizontal-outline"],[2,"--overflow","hidden"],["mode","md","vertical","bottom","horizontal","end","slot","fixed"],["size","small","color","danger",3,"click",4,"ngIf"],["pager","true",3,"options","ionSlideDidChange"],["slides",""],["style","height: calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top));",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["size","small","color","danger",3,"click"],["name","trash-outline"],[2,"height","calc(100vh - 67px - var(--ion-safe-area-bottom) - var(--ion-safe-area-top))",3,"click"],["mode","ios",1,"empty"],["cdkScrollable","","scroll-events","",1,"scrollContent"],["class","dashboardCol","cdkDropList","",3,"width","cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDropList","",1,"dashboardCol",3,"cdkDropListData","cdkDropListConnectedTo","id","cdkDropListDropped","click"],["mode","ios","class","empty",4,"ngIf"],["class","dragElement","cdkDrag","",3,"cdkDragData","cdkDragDisabled","cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dragElement",3,"cdkDragData","cdkDragDisabled","cdkDragStarted"],["class","remove","color","danger",3,"click",4,"ngIf"],["class","card",4,"ngIf"],["class","wrapper",4,"ngIf"],["color","danger",1,"remove",3,"click"],["name","close",1,"remove-icon"],[1,"card"],["inView","",3,"ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange",4,"ngIf"],["inView","",3,"ping","deviceInfo","dashboardSettings","showDetails","reorder","dashboardSettingsChange"],["inView","inView"],["cdkDragHandle","",4,"ngIf"],["cdkDragHandle",""],["name","move-outline"],[1,"wrapper"],["inView","",3,"ping","room","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","room","allow","reorder","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"],["inView","",3,"ping","group","allow","reorder","collapsed","not-collapsed","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange",4,"ngIf"],["inView","",3,"ping","group","allow","reorder","dashboardSettings","controlButtons","dashboardSettingsChange","select","controlButtonsChange"]],template:function(e,t){1&e&&(k.YNc(0,Kt,22,8,"ng-container",0),k.ALo(1,"async")),2&e&&k.Q6J("ngIf",k.lcZ(1,1,t.dashboardList$))},directives:[f.O5,g.Gu,g.sr,g.Sm,g.fG,g.gu,g.wd,g.YG,g.W2,g.IJ,j.e,g.Hr,f.sg,g.W4,g.A$,g.jY,v.PQ,g.q_,g.Nd,g.wI,u.Wj,u.Zt,g.PM,te.v,$e.z,u.Bh,_t.Y,Tt.m],pipes:[f.Ov,m.X$,Ot.j,ue.B,Pt,Jt],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: transparent}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]{background:#fff;background:var(--ion-background-color, #fff)}  .header-background{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.add[_ngcontent-%COMP%]{height:3px;width:calc(50% - 75px);top:50%;position:absolute;max-width:200px}.add.right[_ngcontent-%COMP%]{left:calc(50% + 50px);background:linear-gradient(to left,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.add.left[_ngcontent-%COMP%]{right:calc(50% + 50px);background:linear-gradient(to right,transparent 0%,var(--ion-color-primary) 60%,var(--ion-color-primary) 100%)}.addText[_ngcontent-%COMP%]{width:100%;color:var(--ion-color-primary);top:calc(50% - 75px);position:absolute;left:0;text-align:center}  .swiper-pagination{position:fixed!important;pointer-events:none}.scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 57px - var(--ion-safe-area-bottom));overflow-y:auto;width:100%}.ios[_ngcontent-%COMP%]   .scrollContent[_ngcontent-%COMP%]{height:calc(100vh - 44px - var(--ion-safe-area-bottom))}.card[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item{border-radius:4px}.card[_ngcontent-%COMP%]   app-device[_ngcontent-%COMP%]    >div>ion-item::part(native){box-shadow:#0003 0 3px 1px -2px,#00000024 0 2px 2px,#0000001f 0 1px 5px;-webkit-font-smoothing:antialiased;display:block;position:relative;font-family:inherit;font-family:var(--ion-font-family, inherit);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragElement[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-handle[_ngcontent-%COMP%]{font-size:31px;position:absolute;right:11px;top:11px;z-index:1;background:var(--ion-color-base)}.cdk-drag-handle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;top:0;left:0}.dragElement[_ngcontent-%COMP%]{position:relative;margin:15px 5px}.dragElement[_ngcontent-%COMP%]:last-child{margin-bottom:calc(50px + var(--ion-safe-area-bottom))}  .ios .action-sheet-icon{position:absolute!important;left:10px}ion-fab-button.remove[_ngcontent-%COMP%]{position:absolute;transform:scale(.6);z-index:2;opacity:.8;bottom:-16px;left:calc(50% - 16px);width:35px;height:35px}  .disabledAction{pointer-events:none;opacity:.5}.ios[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 64px - var(--ion-safe-area-bottom))}.md[_ngcontent-%COMP%]   .dashboardCol[_ngcontent-%COMP%]{min-height:calc(100vh - 70px - var(--ion-safe-area-bottom))}ion-slide[_ngcontent-%COMP%], ion-grid[_ngcontent-%COMP%], ion-list[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%]{padding-top:0}"],changeDetection:0}),e}()}],tn=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[pe.Bz.forChild(en)],pe.Bz]}),e}(),nn=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[f.ez,h.u5,g.Pc,D,de,u._t,v.Cl,m.aw,tn]]}),e}()}}])}();